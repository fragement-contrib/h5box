var $t=Object.defineProperty;var zt=(J,g,V)=>g in J?$t(J,g,{enumerable:!0,configurable:!0,writable:!0,value:V}):J[g]=V;var Ut=(J,g,V)=>(zt(J,typeof g!="symbol"?g+"":g,V),V),Gt=(J,g,V)=>{if(!g.has(J))throw TypeError("Cannot "+V)};var ut=(J,g,V)=>(Gt(J,g,"read from private field"),V?V.call(J):g.get(J)),xt=(J,g,V)=>{if(g.has(J))throw TypeError("Cannot add the same private member more than once");g instanceof WeakSet?g.add(J):g.set(J,V)},Pt=(J,g,V,c)=>(Gt(J,g,"write to private field"),c?c.call(J,V):g.set(J,V),V),Xt=(J,g,V,c)=>({set _(Q){Pt(J,g,Q,V)},get _(){return ut(J,g,c)}}),Lt=(J,g,V)=>(Gt(J,g,"access private method"),V);import{u as uiSelectFile}from"./select-file-f83d8c6d.js";import{d as defineComponent,f as useDialogStore,r as ref,c as createElementBlock,g as createVNode,u as unref,a as createBaseVNode,t as toDisplayString,n as normalizeStyle,h as createCommentVNode,o as openBlock,p as pushScopeId,e as popScopeId,_ as _export_sfc}from"./index-a33eeedb.js";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(J){var g=J.default;if(typeof g=="function"){var V=function(){return g.apply(this,arguments)};V.prototype=g.prototype}else V={};return Object.defineProperty(V,"__esModule",{value:!0}),Object.keys(J).forEach(function(c){var Q=Object.getOwnPropertyDescriptor(J,c);Object.defineProperty(V,c,Q.get?Q:{enumerable:!0,get:function(){return J[c]}})}),V}function commonjsRequire(J){throw new Error('Could not dynamically require "'+J+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(g,V){module.exports=V()})(commonjsGlobal,()=>(()=>{var __webpack_modules__=[,(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.VerbosityLevel=g.Util=g.UnknownErrorException=g.UnexpectedResponseException=g.UNSUPPORTED_FEATURES=g.TextRenderingMode=g.StreamType=g.RenderingIntentFlag=g.PermissionFlag=g.PasswordResponses=g.PasswordException=g.PageActionEventType=g.OPS=g.MissingPDFException=g.InvalidPDFException=g.ImageKind=g.IDENTITY_MATRIX=g.FormatError=g.FontType=g.FeatureTest=g.FONT_IDENTITY_MATRIX=g.DocumentActionEventType=g.CMapCompressionType=g.BaseException=g.AnnotationType=g.AnnotationStateModelType=g.AnnotationReviewState=g.AnnotationReplyType=g.AnnotationMode=g.AnnotationMarkedState=g.AnnotationFlag=g.AnnotationFieldFlag=g.AnnotationBorderStyleType=g.AnnotationActionEventType=g.AbortException=void 0,g.arrayByteLength=N,g.arraysToBytes=O,g.assert=Y,g.bytesToString=y,g.createPromiseCapability=mt,g.createValidAbsoluteUrl=ot,g.escapeString=bt,g.getModificationDate=kt,g.getVerbosityLevel=B,g.info=z,g.isArrayBuffer=Tt,g.isArrayEqual=yt,g.isAscii=_t,g.objectFromMap=X,g.objectSize=L,g.setVerbosityLevel=$,g.shadow=S,g.string32=W,g.stringToBytes=w,g.stringToPDFString=nt,g.stringToUTF16BEString=dt,g.stringToUTF8String=gt,g.unreachable=Z,g.utf8StringToString=St,g.warn=K,V(2);const c=[1,0,0,1,0,0];g.IDENTITY_MATRIX=c;const Q=[.001,0,0,.001,0,0];g.FONT_IDENTITY_MATRIX=Q;const q={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};g.RenderingIntentFlag=q;const G={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};g.AnnotationMode=G;const U={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};g.PermissionFlag=U;const M={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};g.TextRenderingMode=M;const m={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};g.ImageKind=m;const T={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};g.AnnotationType=T;const F={MARKED:"Marked",REVIEW:"Review"};g.AnnotationStateModelType=F;const R={MARKED:"Marked",UNMARKED:"Unmarked"};g.AnnotationMarkedState=R;const A={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};g.AnnotationReviewState=A;const l={GROUP:"Group",REPLY:"R"};g.AnnotationReplyType=l;const d={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};g.AnnotationFlag=d;const i={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};g.AnnotationFieldFlag=i;const p={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};g.AnnotationBorderStyleType=p;const v={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};g.AnnotationActionEventType=v;const b={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};g.DocumentActionEventType=b;const C={O:"PageOpen",C:"PageClose"};g.PageActionEventType=C;const e={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};g.StreamType=e;const o={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};g.FontType=o;const _={ERRORS:0,WARNINGS:1,INFOS:5};g.VerbosityLevel=_;const P={NONE:0,BINARY:1,STREAM:2};g.CMapCompressionType=P;const x={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};g.OPS=x;const E={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};g.UNSUPPORTED_FEATURES=E;const k={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};g.PasswordResponses=k;let D=_.WARNINGS;function $(H){Number.isInteger(H)&&(D=H)}function B(){return D}function z(H){D>=_.INFOS&&console.log(`Info: ${H}`)}function K(H){D>=_.WARNINGS&&console.log(`Warning: ${H}`)}function Z(H){throw new Error(H)}function Y(H,I){H||Z(I)}function et(H){if(!H)return!1;switch(H.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ot(H,I=null,j=null){if(!H)return null;try{if(j&&typeof H=="string"){if(j.addDefaultProtocol&&H.startsWith("www.")){const ht=H.match(/\./g);ht&&ht.length>=2&&(H=`http://${H}`)}if(j.tryConvertEncoding)try{H=gt(H)}catch{}}const at=I?new URL(H,I):new URL(H);if(et(at))return at}catch{}return null}function S(H,I,j){return Object.defineProperty(H,I,{value:j,enumerable:!0,configurable:!0,writable:!1}),j}const a=function(){function I(j,at){this.constructor===I&&Z("Cannot initialize BaseException."),this.message=j,this.name=at}return I.prototype=new Error,I.constructor=I,I}();g.BaseException=a;class s extends a{constructor(I,j){super(I,"PasswordException"),this.code=j}}g.PasswordException=s;class f extends a{constructor(I,j){super(I,"UnknownErrorException"),this.details=j}}g.UnknownErrorException=f;class t extends a{constructor(I){super(I,"InvalidPDFException")}}g.InvalidPDFException=t;class n extends a{constructor(I){super(I,"MissingPDFException")}}g.MissingPDFException=n;class r extends a{constructor(I,j){super(I,"UnexpectedResponseException"),this.status=j}}g.UnexpectedResponseException=r;class u extends a{constructor(I){super(I,"FormatError")}}g.FormatError=u;class h extends a{constructor(I){super(I,"AbortException")}}g.AbortException=h;function y(H){(typeof H!="object"||H===null||H.length===void 0)&&Z("Invalid argument for bytesToString");const I=H.length,j=8192;if(I<j)return String.fromCharCode.apply(null,H);const at=[];for(let ht=0;ht<I;ht+=j){const pt=Math.min(ht+j,I),ft=H.subarray(ht,pt);at.push(String.fromCharCode.apply(null,ft))}return at.join("")}function w(H){typeof H!="string"&&Z("Invalid argument for stringToBytes");const I=H.length,j=new Uint8Array(I);for(let at=0;at<I;++at)j[at]=H.charCodeAt(at)&255;return j}function N(H){if(H.length!==void 0)return H.length;if(H.byteLength!==void 0)return H.byteLength;Z("Invalid argument for arrayByteLength")}function O(H){const I=H.length;if(I===1&&H[0]instanceof Uint8Array)return H[0];let j=0;for(let pt=0;pt<I;pt++)j+=N(H[pt]);let at=0;const ht=new Uint8Array(j);for(let pt=0;pt<I;pt++){let ft=H[pt];ft instanceof Uint8Array||(typeof ft=="string"?ft=w(ft):ft=new Uint8Array(ft));const wt=ft.byteLength;ht.set(ft,at),at+=wt}return ht}function W(H){return String.fromCharCode(H>>24&255,H>>16&255,H>>8&255,H&255)}function L(H){return Object.keys(H).length}function X(H){const I=Object.create(null);for(const[j,at]of H)I[j]=at;return I}function st(){const H=new Uint8Array(4);return H[0]=1,new Uint32Array(H.buffer,0,1)[0]===1}function rt(){try{return new Function(""),!0}catch{return!1}}class it{static get isLittleEndian(){return S(this,"isLittleEndian",st())}static get isEvalSupported(){return S(this,"isEvalSupported",rt())}static get isOffscreenCanvasSupported(){return S(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}g.FeatureTest=it;const tt=[...Array(256).keys()].map(H=>H.toString(16).padStart(2,"0"));class lt{static makeHexColor(I,j,at){return`#${tt[I]}${tt[j]}${tt[at]}`}static scaleMinMax(I,j){let at;I[0]?(I[0]<0&&(at=j[0],j[0]=j[1],j[1]=at),j[0]*=I[0],j[1]*=I[0],I[3]<0&&(at=j[2],j[2]=j[3],j[3]=at),j[2]*=I[3],j[3]*=I[3]):(at=j[0],j[0]=j[2],j[2]=at,at=j[1],j[1]=j[3],j[3]=at,I[1]<0&&(at=j[2],j[2]=j[3],j[3]=at),j[2]*=I[1],j[3]*=I[1],I[2]<0&&(at=j[0],j[0]=j[1],j[1]=at),j[0]*=I[2],j[1]*=I[2]),j[0]+=I[4],j[1]+=I[4],j[2]+=I[5],j[3]+=I[5]}static transform(I,j){return[I[0]*j[0]+I[2]*j[1],I[1]*j[0]+I[3]*j[1],I[0]*j[2]+I[2]*j[3],I[1]*j[2]+I[3]*j[3],I[0]*j[4]+I[2]*j[5]+I[4],I[1]*j[4]+I[3]*j[5]+I[5]]}static applyTransform(I,j){const at=I[0]*j[0]+I[1]*j[2]+j[4],ht=I[0]*j[1]+I[1]*j[3]+j[5];return[at,ht]}static applyInverseTransform(I,j){const at=j[0]*j[3]-j[1]*j[2],ht=(I[0]*j[3]-I[1]*j[2]+j[2]*j[5]-j[4]*j[3])/at,pt=(-I[0]*j[1]+I[1]*j[0]+j[4]*j[1]-j[5]*j[0])/at;return[ht,pt]}static getAxialAlignedBoundingBox(I,j){const at=lt.applyTransform(I,j),ht=lt.applyTransform(I.slice(2,4),j),pt=lt.applyTransform([I[0],I[3]],j),ft=lt.applyTransform([I[2],I[1]],j);return[Math.min(at[0],ht[0],pt[0],ft[0]),Math.min(at[1],ht[1],pt[1],ft[1]),Math.max(at[0],ht[0],pt[0],ft[0]),Math.max(at[1],ht[1],pt[1],ft[1])]}static inverseTransform(I){const j=I[0]*I[3]-I[1]*I[2];return[I[3]/j,-I[1]/j,-I[2]/j,I[0]/j,(I[2]*I[5]-I[4]*I[3])/j,(I[4]*I[1]-I[5]*I[0])/j]}static apply3dTransform(I,j){return[I[0]*j[0]+I[1]*j[1]+I[2]*j[2],I[3]*j[0]+I[4]*j[1]+I[5]*j[2],I[6]*j[0]+I[7]*j[1]+I[8]*j[2]]}static singularValueDecompose2dScale(I){const j=[I[0],I[2],I[1],I[3]],at=I[0]*j[0]+I[1]*j[2],ht=I[0]*j[1]+I[1]*j[3],pt=I[2]*j[0]+I[3]*j[2],ft=I[2]*j[1]+I[3]*j[3],wt=(at+ft)/2,Rt=Math.sqrt((at+ft)**2-4*(at*ft-pt*ht))/2,Ft=wt+Rt||1,Ct=wt-Rt||1;return[Math.sqrt(Ft),Math.sqrt(Ct)]}static normalizeRect(I){const j=I.slice(0);return I[0]>I[2]&&(j[0]=I[2],j[2]=I[0]),I[1]>I[3]&&(j[1]=I[3],j[3]=I[1]),j}static intersect(I,j){const at=Math.max(Math.min(I[0],I[2]),Math.min(j[0],j[2])),ht=Math.min(Math.max(I[0],I[2]),Math.max(j[0],j[2]));if(at>ht)return null;const pt=Math.max(Math.min(I[1],I[3]),Math.min(j[1],j[3])),ft=Math.min(Math.max(I[1],I[3]),Math.max(j[1],j[3]));return pt>ft?null:[at,pt,ht,ft]}static bezierBoundingBox(I,j,at,ht,pt,ft,wt,Rt){const Ft=[],Ct=[[],[]];let Mt,Et,It,At,Nt,jt,Bt,Wt;for(let qt=0;qt<2;++qt){if(qt===0?(Et=6*I-12*at+6*pt,Mt=-3*I+9*at-9*pt+3*wt,It=3*at-3*I):(Et=6*j-12*ht+6*ft,Mt=-3*j+9*ht-9*ft+3*Rt,It=3*ht-3*j),Math.abs(Mt)<1e-12){if(Math.abs(Et)<1e-12)continue;At=-It/Et,0<At&&At<1&&Ft.push(At);continue}Bt=Et*Et-4*It*Mt,Wt=Math.sqrt(Bt),!(Bt<0)&&(Nt=(-Et+Wt)/(2*Mt),0<Nt&&Nt<1&&Ft.push(Nt),jt=(-Et-Wt)/(2*Mt),0<jt&&jt<1&&Ft.push(jt))}let Ot=Ft.length,vt;const Dt=Ot;for(;Ot--;)At=Ft[Ot],vt=1-At,Ct[0][Ot]=vt*vt*vt*I+3*vt*vt*At*at+3*vt*At*At*pt+At*At*At*wt,Ct[1][Ot]=vt*vt*vt*j+3*vt*vt*At*ht+3*vt*At*At*ft+At*At*At*Rt;return Ct[0][Dt]=I,Ct[1][Dt]=j,Ct[0][Dt+1]=wt,Ct[1][Dt+1]=Rt,Ct[0].length=Ct[1].length=Dt+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}g.Util=lt;const ct=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function nt(H){if(H[0]>="\xEF"){let j;if(H[0]==="\xFE"&&H[1]==="\xFF"?j="utf-16be":H[0]==="\xFF"&&H[1]==="\xFE"?j="utf-16le":H[0]==="\xEF"&&H[1]==="\xBB"&&H[2]==="\xBF"&&(j="utf-8"),j)try{const at=new TextDecoder(j,{fatal:!0}),ht=w(H);return at.decode(ht)}catch(at){K(`stringToPDFString: "${at}".`)}}const I=[];for(let j=0,at=H.length;j<at;j++){const ht=ct[H.charCodeAt(j)];I.push(ht?String.fromCharCode(ht):H.charAt(j))}return I.join("")}function bt(H){return H.replace(/([()\\\n\r])/g,I=>I===`
`?"\\n":I==="\r"?"\\r":`\\${I}`)}function _t(H){return/^[\x00-\x7F]*$/.test(H)}function dt(H){const I=["\xFE\xFF"];for(let j=0,at=H.length;j<at;j++){const ht=H.charCodeAt(j);I.push(String.fromCharCode(ht>>8&255),String.fromCharCode(ht&255))}return I.join("")}function gt(H){return decodeURIComponent(escape(H))}function St(H){return unescape(encodeURIComponent(H))}function Tt(H){return typeof H=="object"&&H!==null&&H.byteLength!==void 0}function yt(H,I){if(H.length!==I.length)return!1;for(let j=0,at=H.length;j<at;j++)if(H[j]!==I[j])return!1;return!0}function kt(H=new Date){return[H.getUTCFullYear().toString(),(H.getUTCMonth()+1).toString().padStart(2,"0"),H.getUTCDate().toString().padStart(2,"0"),H.getUTCHours().toString().padStart(2,"0"),H.getUTCMinutes().toString().padStart(2,"0"),H.getUTCSeconds().toString().padStart(2,"0")].join("")}function mt(){const H=Object.create(null);let I=!1;return Object.defineProperty(H,"settled",{get(){return I}}),H.promise=new Promise(function(j,at){H.resolve=function(ht){I=!0,j(ht)},H.reject=function(ht){I=!0,at(ht)}}),H}},(J,g,V)=>{V(3)},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.isNodeJS=void 0;const V=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");g.isNodeJS=V},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var J,V,c,Q,q,G,U,M,m,Ht,F;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(5),_font_loader=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(13),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(14),_metadata=__w_pdfjs_require__(15),_optional_content_config=__w_pdfjs_require__(16),_transport_stream=__w_pdfjs_require__(17),_xfa_text=__w_pdfjs_require__(18);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:A,NodeCMapReaderFactory:l,NodeStandardFontDataFactory:d}=__w_pdfjs_require__(19);exports.DefaultCanvasFactory=DefaultCanvasFactory=A,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=l,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=d}let createPDFNetworkStream;function setPDFNetworkStreamFactory(A){createPDFNetworkStream=A}function getDocument(A){const l=new PDFDocumentLoadingTask;let d;if(typeof A=="string"||A instanceof URL)d={url:A};else if((0,_util.isArrayBuffer)(A))d={data:A};else if(A instanceof PDFDataRangeTransport)d={range:A};else{if(typeof A!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!A.url&&!A.data&&!A.range)throw new Error("Invalid parameter object: need either .data, .range or .url");d=A}const i=Object.create(null);let p=null,v=null;for(const C in d){const e=d[C];switch(C){case"url":if(typeof window<"u")try{i[C]=new URL(e,window.location).href;continue}catch(o){(0,_util.warn)(`Cannot create valid URL: "${o}".`)}else if(typeof e=="string"||e instanceof URL){i[C]=e.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":p=e;continue;case"worker":v=e;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&e instanceof Buffer)i[C]=new Uint8Array(e);else{if(e instanceof Uint8Array)break;if(typeof e=="string")i[C]=(0,_util.stringToBytes)(e);else if(typeof e=="object"&&e!==null&&!isNaN(e.length))i[C]=new Uint8Array(e);else if((0,_util.isArrayBuffer)(e))i[C]=new Uint8Array(e);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}i[C]=e}if(i.CMapReaderFactory=i.CMapReaderFactory||DefaultCMapReaderFactory,i.StandardFontDataFactory=i.StandardFontDataFactory||DefaultStandardFontDataFactory,i.ignoreErrors=i.stopAtErrors!==!0,i.fontExtraProperties=i.fontExtraProperties===!0,i.pdfBug=i.pdfBug===!0,i.enableXfa=i.enableXfa===!0,(!Number.isInteger(i.rangeChunkSize)||i.rangeChunkSize<1)&&(i.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof i.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(i.docBaseUrl))&&(i.docBaseUrl=null),(!Number.isInteger(i.maxImageSize)||i.maxImageSize<-1)&&(i.maxImageSize=-1),typeof i.cMapUrl!="string"&&(i.cMapUrl=null),typeof i.standardFontDataUrl!="string"&&(i.standardFontDataUrl=null),typeof i.useWorkerFetch!="boolean"&&(i.useWorkerFetch=i.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&i.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof i.isEvalSupported!="boolean"&&(i.isEvalSupported=!0),typeof i.disableFontFace!="boolean"&&(i.disableFontFace=_is_node.isNodeJS),typeof i.useSystemFonts!="boolean"&&(i.useSystemFonts=!_is_node.isNodeJS&&!i.disableFontFace),(typeof i.ownerDocument!="object"||i.ownerDocument===null)&&(i.ownerDocument=globalThis.document),typeof i.disableRange!="boolean"&&(i.disableRange=!1),typeof i.disableStream!="boolean"&&(i.disableStream=!1),typeof i.disableAutoFetch!="boolean"&&(i.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(i.verbosity),!v){const C={verbosity:i.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};v=C.port?PDFWorker.fromPort(C):new PDFWorker(C),l._worker=v}const b=l.docId;return v.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const C=_fetchDocument(v,i,p,b),e=new Promise(function(o){let _;p?_=new _transport_stream.PDFDataTransportStream({length:i.length,initialData:i.initialData,progressiveDone:i.progressiveDone,contentDispositionFilename:i.contentDispositionFilename,disableRange:i.disableRange,disableStream:i.disableStream},p):i.data||(_=createPDFNetworkStream({url:i.url,length:i.length,httpHeaders:i.httpHeaders,withCredentials:i.withCredentials,rangeChunkSize:i.rangeChunkSize,disableRange:i.disableRange,disableStream:i.disableStream})),o(_)});return Promise.all([C,e]).then(function([o,_]){if(l.destroyed)throw new Error("Loading aborted");const P=new _message_handler.MessageHandler(b,o,v.port),x=new WorkerTransport(P,l,_,i);l._transport=x,P.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(A,l,d,i){if(A.destroyed)throw new Error("Worker was destroyed");d&&(l.length=d.length,l.initialData=d.initialData,l.progressiveDone=d.progressiveDone,l.contentDispositionFilename=d.contentDispositionFilename);const p=await A.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:"2.14.305",source:{data:l.data,url:l.url,password:l.password,disableAutoFetch:l.disableAutoFetch,rangeChunkSize:l.rangeChunkSize,length:l.length},maxImageSize:l.maxImageSize,disableFontFace:l.disableFontFace,docBaseUrl:l.docBaseUrl,ignoreErrors:l.ignoreErrors,isEvalSupported:l.isEvalSupported,fontExtraProperties:l.fontExtraProperties,enableXfa:l.enableXfa,useSystemFonts:l.useSystemFonts,cMapUrl:l.useWorkerFetch?l.cMapUrl:null,standardFontDataUrl:l.useWorkerFetch?l.standardFontDataUrl:null});if(A.destroyed)throw new Error("Worker was destroyed");return p}const g=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${Xt(g,J)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var l;this.destroyed=!0,await((l=this._transport)==null?void 0:l.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=g;J=new WeakMap,xt(PDFDocumentLoadingTask,J,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,d,i=!1,p=null){this.length=l,this.initialData=d,this.progressiveDone=i,this.contentDispositionFilename=p,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,d){for(const i of this._rangeListeners)i(l,d)}onDataProgress(l,d){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(l,d)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const d of this._progressiveReadListeners)d(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,d){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,d){this._pdfInfo=l,this._transport=d,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,d,i,p,v=!1){this._pageIndex=l,this._pageInfo=d,this._ownerDocument=p,this._transport=i,this._stats=v?new _display_utils.StatTimer:null,this._pdfBug=v,this.commonObjs=i.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:d=this.rotate,offsetX:i=0,offsetY:p=0,dontFlip:v=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:d,offsetX:i,offsetY:p,dontFlip:v})}getAnnotations({intent:l="display"}={}){const d=this._transport.getRenderingIntent(l);let i=this._annotationPromises.get(d.cacheKey);return i||(i=this._transport.getAnnotations(this._pageIndex,d.renderingIntent),this._annotationPromises.set(d.cacheKey,i),i=i.then(p=>{for(const v of p)v.titleObj!==void 0&&Object.defineProperty(v,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),v.titleObj.str}}),v.contentsObj!==void 0&&Object.defineProperty(v,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),v.contentsObj.str}});return p})),i}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:d,intent:i="display",annotationMode:p=_util.AnnotationMode.ENABLE,transform:v=null,imageLayer:b=null,canvasFactory:C=null,background:e=null,optionalContentConfigPromise:o=null,annotationCanvasMap:_=null,pageColors:P=null}){var K,Z;((K=arguments[0])==null?void 0:K.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&p===_util.AnnotationMode.ENABLE&&(p=_util.AnnotationMode.ENABLE_FORMS)),((Z=arguments[0])==null?void 0:Z.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&p===_util.AnnotationMode.ENABLE&&(p=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const x=this._transport.getRenderingIntent(i,p);this.pendingCleanup=!1,o||(o=this._transport.getOptionalContentConfig());let E=this._intentStates.get(x.cacheKey);E||(E=Object.create(null),this._intentStates.set(x.cacheKey,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const k=C||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),D=!!(x.renderingIntent&_util.RenderingIntentFlag.PRINT);E.displayReadyCapability||(E.displayReadyCapability=(0,_util.createPromiseCapability)(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(x));const $=Y=>{E.renderTasks.delete(B),(this.cleanupAfterRender||D)&&(this.pendingCleanup=!0),this._tryCleanup(),Y?(B.capability.reject(Y),this._abortOperatorList({intentState:E,reason:Y instanceof Error?Y:new Error(Y)})):B.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},B=new InternalRenderTask({callback:$,params:{canvasContext:l,viewport:d,transform:v,imageLayer:b,background:e},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:_,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:k,useRequestAnimationFrame:!D,pdfBug:this._pdfBug,pageColors:P});(E.renderTasks||(E.renderTasks=new Set)).add(B);const z=B.task;return Promise.all([E.displayReadyCapability.promise,o]).then(([Y,et])=>{if(this.pendingCleanup){$();return}this._stats&&this._stats.time("Rendering"),B.initializeGraphics({transparency:Y,optionalContentConfig:et}),B.operatorListChanged()}).catch($),z}getOperatorList({intent:l="display",annotationMode:d=_util.AnnotationMode.ENABLE}={}){function i(){v.operatorList.lastChunk&&(v.opListReadCapability.resolve(v.operatorList),v.renderTasks.delete(b))}const p=this._transport.getRenderingIntent(l,d,!0);let v=this._intentStates.get(p.cacheKey);v||(v=Object.create(null),this._intentStates.set(p.cacheKey,v));let b;return v.opListReadCapability||(b=Object.create(null),b.operatorListChanged=i,v.opListReadCapability=(0,_util.createPromiseCapability)(),(v.renderTasks||(v.renderTasks=new Set)).add(b),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(p)),v.opListReadCapability.promise}streamTextContent({disableCombineTextItems:l=!1,includeMarkedContent:d=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:l!==!0,includeMarkedContent:d===!0},{highWaterMark:100,size(p){return p.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>_xfa_text.XfaText.textContent(i));const d=this.streamTextContent(l);return new Promise(function(i,p){function v(){b.read().then(function({value:e,done:o}){if(o){i(C);return}Object.assign(C.styles,e.styles),C.items.push(...e.items),v()},p)}const b=d.getReader(),C={items:[],styles:Object.create(null)};v()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const l=[];for(const d of this._intentStates.values())if(this._abortOperatorList({intentState:d,reason:new Error("Page was destroyed."),force:!0}),!d.opListReadCapability)for(const i of d.renderTasks)l.push(i.completed),i.cancel();this.objs.clear();for(const d of this._bitmaps)d.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(l)}cleanup(l=!1){return this.pendingCleanup=!0,this._tryCleanup(l)}_tryCleanup(l=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:d,operatorList:i}of this._intentStates.values())if(d.size>0||!i.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,l&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const d of this._bitmaps)d.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(l,d){const i=this._intentStates.get(d);!i||(this._stats&&this._stats.timeEnd("Page Request"),i.displayReadyCapability&&i.displayReadyCapability.resolve(l))}_renderPageChunk(l,d){for(let i=0,p=l.length;i<p;i++)d.operatorList.fnArray.push(l.fnArray[i]),d.operatorList.argsArray.push(l.argsArray[i]);d.operatorList.lastChunk=l.lastChunk;for(const i of d.renderTasks)i.operatorListChanged();l.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:l,cacheKey:d}){const p=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:d,annotationStorage:l&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),v=this._intentStates.get(d);v.streamReader=p;const b=()=>{p.read().then(({value:C,done:e})=>{if(e){v.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(C,v),b())},C=>{if(v.streamReader=null,!this._transport.destroyed){if(v.operatorList){v.operatorList.lastChunk=!0;for(const e of v.renderTasks)e.operatorListChanged();this._tryCleanup()}if(v.displayReadyCapability)v.displayReadyCapability.reject(C);else if(v.opListReadCapability)v.opListReadCapability.reject(C);else throw C}})};b()}_abortOperatorList({intentState:l,reason:d,force:i=!1}){if(!!l.streamReader){if(!i){if(l.renderTasks.size>0)return;if(d instanceof _display_utils.RenderingCancelledException){l.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:l,reason:d,force:!0}),l.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(l.streamReader.cancel(new _util.AbortException(d.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[p,v]of this._intentStates)if(v===l){this._intentStates.delete(p);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(l,d){const i={data:structuredClone(l,d)};this._deferred.then(()=>{for(const p of this._listeners)p.call(this,i)})}addEventListener(l,d){this._listeners.push(d)}removeEventListener(l,d){const i=this._listeners.indexOf(d);this._listeners.splice(i,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const A=(V=document==null?void 0:document.currentScript)==null?void 0:V.src;A&&(PDFWorkerUtil.fallbackWorkerSrc=A.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,l){let d;try{if(d=new URL(A),!d.origin||d.origin==="null")return!1}catch{return!1}const i=new URL(l,d);return d.origin===i.origin},PDFWorkerUtil.createCDNWrapper=function(A){const l=`importScripts("${A}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class{constructor({name:A=null,port:l=null,verbosity:d=(0,_util.getVerbosityLevel)()}={}){if(l&&ut(_PDFWorker,c).has(l))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=A,this.destroyed=!1,this.verbosity=d,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,l){ut(_PDFWorker,c).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let A=_PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));const l=new Worker(A),d=new _message_handler.MessageHandler("main","worker",l),i=()=>{l.removeEventListener("error",p),d.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},p=()=>{this._webWorker||i()};l.addEventListener("error",p),d.on("test",b=>{if(l.removeEventListener("error",p),this.destroyed){i();return}b?(this._messageHandler=d,this._port=l,this._webWorker=l,this._readyCapability.resolve(),d.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),d.destroy(),l.terminate())}),d.on("ready",b=>{if(l.removeEventListener("error",p),this.destroyed){i();return}try{v()}catch{this._setupFakeWorker()}});const v=()=>{const b=new Uint8Array;d.send("test",b,[b.buffer])};v();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const d=`fake${PDFWorkerUtil.fakeWorkerId++}`,i=new _message_handler.MessageHandler(d+"_worker",d,l);A.setup(i,l);const p=new _message_handler.MessageHandler(d,d+"_worker",l);this._messageHandler=p,this._readyCapability.resolve(),p.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),ut(_PDFWorker,c).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){if(!(A!=null&&A.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return ut(this,c).has(A.port)?ut(this,c).get(A.port):new _PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var A;try{return((A=globalThis.pdfjsWorker)==null?void 0:A.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;c=new WeakMap,xt(PDFWorker,c,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(l,d,i,p){xt(this,Q,null);xt(this,q,new Map);xt(this,G,new Map);xt(this,U,null);this.messageHandler=l,this.loadingTask=d,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:d.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:p.ownerDocument,styleElement:p.styleElement}),this._params=p,p.useWorkerFetch||(this.CMapReaderFactory=new p.CMapReaderFactory({baseUrl:p.cMapUrl,isCompressed:p.cMapPacked}),this.StandardFontDataFactory=new p.StandardFontDataFactory({baseUrl:p.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return ut(this,Q)}getRenderingIntent(l,d=_util.AnnotationMode.ENABLE,i=!1){let p=_util.RenderingIntentFlag.DISPLAY,v="";switch(l){case"any":p=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":p=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(d){case _util.AnnotationMode.DISABLE:p+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:p+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:p+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,v=this.annotationStorage.hash;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${d}`)}return i&&(p+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:p,cacheKey:`${p}_${v}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const i of ut(this,q).values())l.push(i._destroy());ut(this,q).clear(),ut(this,G).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const d=this.messageHandler.sendWithPromise("Terminate",null);return l.push(d),Promise.all(l).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),Pt(this,U,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:d}=this;l.on("GetReader",(i,p)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=v=>{this._lastProgress={loaded:v.loaded,total:v.total}},p.onPull=()=>{this._fullReader.read().then(function({value:v,done:b}){if(b){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(v),"GetReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(v),1,[v])}).catch(v=>{p.error(v)})},p.onCancel=v=>{this._fullReader.cancel(v),p.ready.catch(b=>{if(!this.destroyed)throw b})}}),l.on("ReaderHeadersReady",i=>{const p=(0,_util.createPromiseCapability)(),v=this._fullReader;return v.headersReady.then(()=>{var b;(!v.isStreamingSupported||!v.isRangeSupported)&&(this._lastProgress&&((b=d.onProgress)==null||b.call(d,this._lastProgress)),v.onProgress=C=>{var e;(e=d.onProgress)==null||e.call(d,{loaded:C.loaded,total:C.total})}),p.resolve({isStreamingSupported:v.isStreamingSupported,isRangeSupported:v.isRangeSupported,contentLength:v.contentLength})},p.reject),p.promise}),l.on("GetRangeReader",(i,p)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const v=this._networkStream.getRangeReader(i.begin,i.end);if(!v){p.close();return}p.onPull=()=>{v.read().then(function({value:b,done:C}){if(C){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(b),"GetRangeReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(b),1,[b])}).catch(b=>{p.error(b)})},p.onCancel=b=>{v.cancel(b),p.ready.catch(C=>{if(!this.destroyed)throw C})}}),l.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,d._capability.resolve(new PDFDocumentProxy(i,this))}),l.on("DocException",function(i){let p;switch(i.name){case"PasswordException":p=new _util.PasswordException(i.message,i.code);break;case"InvalidPDFException":p=new _util.InvalidPDFException(i.message);break;case"MissingPDFException":p=new _util.MissingPDFException(i.message);break;case"UnexpectedResponseException":p=new _util.UnexpectedResponseException(i.message,i.status);break;case"UnknownErrorException":p=new _util.UnknownErrorException(i.message,i.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}d._capability.reject(p)}),l.on("PasswordRequest",i=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),d.onPassword){const p=v=>{v instanceof Error?this._passwordCapability.reject(v):this._passwordCapability.resolve({password:v})};try{d.onPassword(p,i.code)}catch(v){this._passwordCapability.reject(v)}}else this._passwordCapability.reject(new _util.PasswordException(i.message,i.code));return this._passwordCapability.promise}),l.on("DataLoaded",i=>{var p;(p=d.onProgress)==null||p.call(d,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),l.on("StartRenderPage",i=>{if(this.destroyed)return;ut(this,q).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),l.on("commonobj",([i,p,v])=>{var b;if(!this.destroyed&&!this.commonObjs.has(i))switch(p){case"Font":const C=this._params;if("error"in v){const _=v.error;(0,_util.warn)(`Error during font loading: ${_}`),this.commonObjs.resolve(i,_);break}let e=null;C.pdfBug&&((b=globalThis.FontInspector)==null?void 0:b.enabled)&&(e={registerFont(_,P){globalThis.FontInspector.fontAdded(_,P)}});const o=new _font_loader.FontFaceObject(v,{isEvalSupported:C.isEvalSupported,disableFontFace:C.disableFontFace,ignoreErrors:C.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:e});this.fontLoader.bind(o).catch(_=>l.sendWithPromise("FontFallback",{id:i})).finally(()=>{!C.fontExtraProperties&&o.data&&(o.data=null),this.commonObjs.resolve(i,o)});break;case"FontPath":case"Image":this.commonObjs.resolve(i,v);break;default:throw new Error(`Got unknown common object type ${p}`)}}),l.on("obj",([i,p,v,b])=>{var e;if(this.destroyed)return;const C=ut(this,q).get(p);if(!C.objs.has(i))switch(v){case"Image":C.objs.resolve(i,b);const o=8e6;if(b){let _;if(b.bitmap){const{bitmap:P,width:x,height:E}=b;_=x*E*4,C._bitmaps.add(P)}else _=((e=b.data)==null?void 0:e.length)||0;_>o&&(C.cleanupAfterRender=!0)}break;case"Pattern":C.objs.resolve(i,b);break;default:throw new Error(`Got unknown object type ${v}`)}}),l.on("DocProgress",i=>{var p;this.destroyed||(p=d.onProgress)==null||p.call(d,{loaded:i.loaded,total:i.total})}),l.on("DocStats",i=>{this.destroyed||Pt(this,Q,Object.freeze({streamTypes:Object.freeze(i.streamTypes),fontTypes:Object.freeze(i.fontTypes)}))}),l.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),l.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:l}){var d,i;this.destroyed||(i=(d=this.loadingTask).onUnsupportedFeature)==null||i.call(d,l)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const d=l-1,i=ut(this,G).get(d);if(i)return i;const p=this.messageHandler.sendWithPromise("GetPage",{pageIndex:d}).then(v=>{if(this.destroyed)throw new Error("Transport destroyed");const b=new PDFPageProxy(d,v,this,this._params.ownerDocument,this._params.pdfBug);return ut(this,q).set(d,b),b});return ut(this,G).set(d,p),p}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,d){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:d})}saveDocument(){var l,d;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(d=(l=this._fullReader)==null?void 0:l.filename)!=null?d:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return ut(this,U)||Pt(this,U,this.messageHandler.sendWithPromise("GetMetadata",null).then(l=>{var d,i,p,v;return{info:l[0],metadata:l[1]?new _metadata.Metadata(l[1]):null,contentDispositionFilename:(i=(d=this._fullReader)==null?void 0:d.filename)!=null?i:null,contentLength:(v=(p=this._fullReader)==null?void 0:p.contentLength)!=null?v:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const d of ut(this,q).values())if(!d.cleanup())throw new Error(`startCleanup: Page ${d.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),Pt(this,U,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const l=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l.disableAutoFetch,enableXfa:l.enableXfa})}}Q=new WeakMap,q=new WeakMap,G=new WeakMap,U=new WeakMap;class PDFObjects{constructor(){xt(this,m);xt(this,M,Object.create(null))}get(l,d=null){if(d){const p=Lt(this,m,Ht).call(this,l);return p.capability.promise.then(()=>d(p.data)),null}const i=ut(this,M)[l];if(!(i!=null&&i.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return i.data}has(l){const d=ut(this,M)[l];return(d==null?void 0:d.capability.settled)||!1}resolve(l,d=null){const i=Lt(this,m,Ht).call(this,l);i.data=d,i.capability.resolve()}clear(){Pt(this,M,Object.create(null))}}M=new WeakMap,m=new WeakSet,Ht=function(l){const d=ut(this,M)[l];return d||(ut(this,M)[l]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(l){this._internalRenderTask=l,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;const R=class{constructor({callback:l,params:d,objs:i,commonObjs:p,annotationCanvasMap:v,operatorList:b,pageIndex:C,canvasFactory:e,useRequestAnimationFrame:o=!1,pdfBug:_=!1,pageColors:P=null}){this.callback=l,this.params=d,this.objs=i,this.commonObjs=p,this.annotationCanvasMap=v,this.operatorListIdx=null,this.operatorList=b,this._pageIndex=C,this.canvasFactory=e,this._pdfBug=_,this.pageColors=P,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=o===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=d.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:d}){var e;if(this.cancelled)return;if(this._canvas){if(ut(R,F).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ut(R,F).add(this._canvas)}this._pdfBug&&((e=globalThis.StepperManager)==null?void 0:e.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:p,transform:v,imageLayer:b,background:C}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,b,d,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:v,viewport:p,transparency:l,background:C}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(l=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&ut(R,F).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&ut(R,F).delete(this._canvas),this.callback())))}};let InternalRenderTask=R;F=new WeakMap,xt(InternalRenderTask,F,new WeakSet);const version="2.14.305";exports.version=version;const build="eaaa8b4ad";exports.build=build},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.StatTimer=g.RenderingCancelledException=g.PixelsPerInch=g.PageViewport=g.PDFDateString=g.DOMStandardFontDataFactory=g.DOMSVGFactory=g.DOMCanvasFactory=g.DOMCMapReaderFactory=void 0,g.deprecated=e,g.getFilenameFromUrl=i,g.getPdfFilenameFromUrl=p,g.getXfaPageViewport=P,g.isDataScheme=l,g.isPdfFile=d,g.isValidFetchUrl=b,g.loadScript=C;var c=V(6),Q=V(1);const q="http://www.w3.org/2000/svg",x=class{};let G=x;Ut(G,"CSS",96),Ut(G,"PDF",72),Ut(G,"PDF_TO_CSS_UNITS",x.CSS/x.PDF),g.PixelsPerInch=G;class U extends c.BaseCanvasFactory{constructor({ownerDocument:k=globalThis.document}={}){super(),this._document=k}_createCanvas(k,D){const $=this._document.createElement("canvas");return $.width=k,$.height=D,$}}g.DOMCanvasFactory=U;async function M(E,k=!1){if(b(E,document.baseURI)){const D=await fetch(E);if(!D.ok)throw new Error(D.statusText);return k?new Uint8Array(await D.arrayBuffer()):(0,Q.stringToBytes)(await D.text())}return new Promise((D,$)=>{const B=new XMLHttpRequest;B.open("GET",E,!0),k&&(B.responseType="arraybuffer"),B.onreadystatechange=()=>{if(B.readyState===XMLHttpRequest.DONE){if(B.status===200||B.status===0){let z;if(k&&B.response?z=new Uint8Array(B.response):!k&&B.responseText&&(z=(0,Q.stringToBytes)(B.responseText)),z){D(z);return}}$(new Error(B.statusText))}},B.send(null)})}class m extends c.BaseCMapReaderFactory{_fetchData(k,D){return M(k,this.isCompressed).then($=>({cMapData:$,compressionType:D}))}}g.DOMCMapReaderFactory=m;class T extends c.BaseStandardFontDataFactory{_fetchData(k){return M(k,!0)}}g.DOMStandardFontDataFactory=T;class F extends c.BaseSVGFactory{_createSVG(k){return document.createElementNS(q,k)}}g.DOMSVGFactory=F;class R{constructor({viewBox:k,scale:D,rotation:$,offsetX:B=0,offsetY:z=0,dontFlip:K=!1}){this.viewBox=k,this.scale=D,this.rotation=$,this.offsetX=B,this.offsetY=z;const Z=(k[2]+k[0])/2,Y=(k[3]+k[1])/2;let et,ot,S,a;switch($%=360,$<0&&($+=360),$){case 180:et=-1,ot=0,S=0,a=1;break;case 90:et=0,ot=1,S=1,a=0;break;case 270:et=0,ot=-1,S=-1,a=0;break;case 0:et=1,ot=0,S=0,a=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}K&&(S=-S,a=-a);let s,f,t,n;et===0?(s=Math.abs(Y-k[1])*D+B,f=Math.abs(Z-k[0])*D+z,t=Math.abs(k[3]-k[1])*D,n=Math.abs(k[2]-k[0])*D):(s=Math.abs(Z-k[0])*D+B,f=Math.abs(Y-k[1])*D+z,t=Math.abs(k[2]-k[0])*D,n=Math.abs(k[3]-k[1])*D),this.transform=[et*D,ot*D,S*D,a*D,s-et*D*Z-S*D*Y,f-ot*D*Z-a*D*Y],this.width=t,this.height=n}clone({scale:k=this.scale,rotation:D=this.rotation,offsetX:$=this.offsetX,offsetY:B=this.offsetY,dontFlip:z=!1}={}){return new R({viewBox:this.viewBox.slice(),scale:k,rotation:D,offsetX:$,offsetY:B,dontFlip:z})}convertToViewportPoint(k,D){return Q.Util.applyTransform([k,D],this.transform)}convertToViewportRectangle(k){const D=Q.Util.applyTransform([k[0],k[1]],this.transform),$=Q.Util.applyTransform([k[2],k[3]],this.transform);return[D[0],D[1],$[0],$[1]]}convertToPdfPoint(k,D){return Q.Util.applyInverseTransform([k,D],this.transform)}}g.PageViewport=R;class A extends Q.BaseException{constructor(k,D){super(k,"RenderingCancelledException"),this.type=D}}g.RenderingCancelledException=A;function l(E){const k=E.length;let D=0;for(;D<k&&E[D].trim()==="";)D++;return E.substring(D,D+5).toLowerCase()==="data:"}function d(E){return typeof E=="string"&&/\.pdf$/i.test(E)}function i(E){const k=E.indexOf("#"),D=E.indexOf("?"),$=Math.min(k>0?k:E.length,D>0?D:E.length);return E.substring(E.lastIndexOf("/",$)+1,$)}function p(E,k="document.pdf"){if(typeof E!="string")return k;if(l(E))return(0,Q.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),k;const D=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,$=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,B=D.exec(E);let z=$.exec(B[1])||$.exec(B[2])||$.exec(B[3]);if(z&&(z=z[0],z.includes("%")))try{z=$.exec(decodeURIComponent(z))[0]}catch{}return z||k}class v{constructor(){this.started=Object.create(null),this.times=[]}time(k){k in this.started&&(0,Q.warn)(`Timer is already running for ${k}`),this.started[k]=Date.now()}timeEnd(k){k in this.started||(0,Q.warn)(`Timer has not been started for ${k}`),this.times.push({name:k,start:this.started[k],end:Date.now()}),delete this.started[k]}toString(){const k=[];let D=0;for(const $ of this.times){const B=$.name;B.length>D&&(D=B.length)}for(const $ of this.times){const B=$.end-$.start;k.push(`${$.name.padEnd(D)} ${B}ms
`)}return k.join("")}}g.StatTimer=v;function b(E,k){try{const{protocol:D}=k?new URL(E,k):new URL(E);return D==="http:"||D==="https:"}catch{return!1}}function C(E,k=!1){return new Promise((D,$)=>{const B=document.createElement("script");B.src=E,B.onload=function(z){k&&B.remove(),D(z)},B.onerror=function(){$(new Error(`Cannot load script at: ${B.src}`))},(document.head||document.documentElement).appendChild(B)})}function e(E){console.log("Deprecated API usage: "+E)}let o;class _{static toDateObject(k){if(!k||typeof k!="string")return null;o||(o=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const D=o.exec(k);if(!D)return null;const $=parseInt(D[1],10);let B=parseInt(D[2],10);B=B>=1&&B<=12?B-1:0;let z=parseInt(D[3],10);z=z>=1&&z<=31?z:1;let K=parseInt(D[4],10);K=K>=0&&K<=23?K:0;let Z=parseInt(D[5],10);Z=Z>=0&&Z<=59?Z:0;let Y=parseInt(D[6],10);Y=Y>=0&&Y<=59?Y:0;const et=D[7]||"Z";let ot=parseInt(D[8],10);ot=ot>=0&&ot<=23?ot:0;let S=parseInt(D[9],10)||0;return S=S>=0&&S<=59?S:0,et==="-"?(K+=ot,Z+=S):et==="+"&&(K-=ot,Z-=S),new Date(Date.UTC($,B,z,K,Z,Y))}}g.PDFDateString=_;function P(E,{scale:k=1,rotation:D=0}){const{width:$,height:B}=E.attributes.style,z=[0,0,parseInt($),parseInt(B)];return new R({viewBox:z,scale:k,rotation:D})}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.BaseStandardFontDataFactory=g.BaseSVGFactory=g.BaseCanvasFactory=g.BaseCMapReaderFactory=void 0;var c=V(1);class Q{constructor(){this.constructor===Q&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,T){if(m<=0||T<=0)throw new Error("Invalid canvas size");const F=this._createCanvas(m,T);return{canvas:F,context:F.getContext("2d")}}reset(m,T,F){if(!m.canvas)throw new Error("Canvas is not specified");if(T<=0||F<=0)throw new Error("Invalid canvas size");m.canvas.width=T,m.canvas.height=F}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,T){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}g.BaseCanvasFactory=Q;class q{constructor({baseUrl:m=null,isCompressed:T=!1}){this.constructor===q&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=T}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const T=this.baseUrl+m+(this.isCompressed?".bcmap":""),F=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData(T,F).catch(R=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${T}`)})}_fetchData(m,T){(0,c.unreachable)("Abstract method `_fetchData` called.")}}g.BaseCMapReaderFactory=q;class G{constructor({baseUrl:m=null}){this.constructor===G&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const T=`${this.baseUrl}${m}`;return this._fetchData(T).catch(F=>{throw new Error(`Unable to load font data at: ${T}`)})}_fetchData(m){(0,c.unreachable)("Abstract method `_fetchData` called.")}}g.BaseStandardFontDataFactory=G;class U{constructor(){this.constructor===U&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,T){if(m<=0||T<=0)throw new Error("Invalid SVG dimensions");const F=this._createSVG("svg:svg");return F.setAttribute("version","1.1"),F.setAttribute("width",`${m}px`),F.setAttribute("height",`${T}px`),F.setAttribute("preserveAspectRatio","none"),F.setAttribute("viewBox",`0 0 ${m} ${T}`),F}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,c.unreachable)("Abstract method `_createSVG` called.")}}g.BaseSVGFactory=U},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.FontLoader=g.FontFaceObject=void 0;var c=V(1);class Q{constructor({docId:M,onUnsupportedFeature:m,ownerDocument:T=globalThis.document,styleElement:F=null}){this.constructor===Q&&(0,c.unreachable)("Cannot initialize BaseFontLoader."),this.docId=M,this._onUnsupportedFeature=m,this._document=T,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(M){this.nativeFontFaces.push(M),this._document.fonts.add(M)}insertRule(M){let m=this.styleElement;m||(m=this.styleElement=this._document.createElement("style"),m.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(m));const T=m.sheet;T.insertRule(M,T.cssRules.length)}clear(){for(const M of this.nativeFontFaces)this._document.fonts.delete(M);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(M){if(M.attached||M.missingFile)return;if(M.attached=!0,this.isFontLoadingAPISupported){const T=M.createNativeFontFace();if(T){this.addNativeFontFace(T);try{await T.loaded}catch(F){throw this._onUnsupportedFeature({featureId:c.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,c.warn)(`Failed to load font '${T.family}': '${F}'.`),M.disableFontFace=!0,F}}return}const m=M.createFontFaceRule();if(m){if(this.insertRule(m),this.isSyncFontLoadingSupported)return;await new Promise(T=>{const F=this._queueLoadingCallback(T);this._prepareFontLoadEvent([m],[M],F)})}}_queueLoadingCallback(M){(0,c.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var m;const M=!!((m=this._document)!=null&&m.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",M)}get isSyncFontLoadingSupported(){(0,c.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,c.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(M,m,T){(0,c.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let q;g.FontLoader=q,g.FontLoader=q=class extends Q{constructor(M){super(M),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let M=!1;if(typeof navigator>"u")M=!0;else{const m=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(m==null?void 0:m[1])>=14&&(M=!0)}return(0,c.shadow)(this,"isSyncFontLoadingSupported",M)}_queueLoadingCallback(M){function m(){for((0,c.assert)(!F.done,"completeRequest() cannot be called twice."),F.done=!0;T.requests.length>0&&T.requests[0].done;){const R=T.requests.shift();setTimeout(R.callback,0)}}const T=this.loadingContext,F={id:`pdfjs-font-loading-${T.nextRequestId++}`,done:!1,complete:m,callback:M};return T.requests.push(F),F}get _loadTestFont(){const M=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,c.shadow)(this,"_loadTestFont",M())}_prepareFontLoadEvent(M,m,T){function F($,B){return $.charCodeAt(B)<<24|$.charCodeAt(B+1)<<16|$.charCodeAt(B+2)<<8|$.charCodeAt(B+3)&255}function R($,B,z,K){const Z=$.substring(0,B),Y=$.substring(B+z);return Z+K+Y}let A,l;const d=this._document.createElement("canvas");d.width=1,d.height=1;const i=d.getContext("2d");let p=0;function v($,B){if(p++,p>30){(0,c.warn)("Load test font never loaded."),B();return}if(i.font="30px "+$,i.fillText(".",0,20),i.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(v.bind(null,$,B))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=R(C,976,b.length,b);const o=16,_=1482184792;let P=F(C,o);for(A=0,l=b.length-3;A<l;A+=4)P=P-_+F(b,A)|0;A<b.length&&(P=P-_+F(b+"XXX",A)|0),C=R(C,o,4,(0,c.string32)(P));const x=`url(data:font/opentype;base64,${btoa(C)});`,E=`@font-face {font-family:"${b}";src:${x}}`;this.insertRule(E);const k=[];for(const $ of m)k.push($.loadedName);k.push(b);const D=this._document.createElement("div");D.style.visibility="hidden",D.style.width=D.style.height="10px",D.style.position="absolute",D.style.top=D.style.left="0px";for(const $ of k){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=$,D.appendChild(B)}this._document.body.appendChild(D),v(b,()=>{D.remove(),T.complete()})}};class G{constructor(M,{isEvalSupported:m=!0,disableFontFace:T=!1,ignoreErrors:F=!1,onUnsupportedFeature:R,fontRegistry:A=null}){this.compiledGlyphs=Object.create(null);for(const l in M)this[l]=M[l];this.isEvalSupported=m!==!1,this.disableFontFace=T===!0,this.ignoreErrors=F===!0,this._onUnsupportedFeature=R,this.fontRegistry=A}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let M;if(!this.cssFontInfo)M=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),M=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return this.fontRegistry&&this.fontRegistry.registerFont(this),M}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const M=(0,c.bytesToString)(this.data),m=`url(data:${this.mimetype};base64,${btoa(M)});`;let T;if(!this.cssFontInfo)T=`@font-face {font-family:"${this.loadedName}";src:${m}}`;else{let F=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(F+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),T=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${F}src:${m}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,m),T}getPathGenerator(M,m){if(this.compiledGlyphs[m]!==void 0)return this.compiledGlyphs[m];let T;try{T=M.get(this.loadedName+"_path_"+m)}catch(F){if(!this.ignoreErrors)throw F;return this._onUnsupportedFeature({featureId:c.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,c.warn)(`getPathGenerator - ignoring character: "${F}".`),this.compiledGlyphs[m]=function(R,A){}}if(this.isEvalSupported&&c.FeatureTest.isEvalSupported){const F=[];for(const R of T){const A=R.args!==void 0?R.args.join(","):"";F.push("c.",R.cmd,"(",A,`);
`)}return this.compiledGlyphs[m]=new Function("c","size",F.join(""))}return this.compiledGlyphs[m]=function(F,R){for(const A of T)A.cmd==="scale"&&(A.args=[R,-R]),F[A.cmd].apply(F,A.args)}}}g.FontFaceObject=G},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.AnnotationStorage=void 0;var c=V(9),Q=V(1);class q{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(U,M){const m=this._storage.get(U);return m===void 0?M:Object.assign(M,m)}getRawValue(U){return this._storage.get(U)}setValue(U,M){const m=this._storage.get(U);let T=!1;if(m!==void 0)for(const[F,R]of Object.entries(M))m[F]!==R&&(T=!0,m[F]=R);else T=!0,this._storage.set(U,M);T&&this._setModified()}getAll(){return this._storage.size>0?(0,Q.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get hash(){const U=new c.MurmurHash3_64;for(const[M,m]of this._storage)U.update(`${M}:${JSON.stringify(m)}`);return U.hexdigest()}}g.AnnotationStorage=q},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.MurmurHash3_64=void 0;var c=V(1);const Q=3285377520,q=4294901760,G=65535;class U{constructor(m){this.h1=m?m&4294967295:Q,this.h2=m?m&4294967295:Q}update(m){let T,F;if(typeof m=="string"){T=new Uint8Array(m.length*2),F=0;for(let _=0,P=m.length;_<P;_++){const x=m.charCodeAt(_);x<=255?T[F++]=x:(T[F++]=x>>>8,T[F++]=x&255)}}else if((0,c.isArrayBuffer)(m))T=m.slice(),F=T.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const R=F>>2,A=F-R*4,l=new Uint32Array(T.buffer,0,R);let d=0,i=0,p=this.h1,v=this.h2;const b=3432918353,C=461845907,e=b&G,o=C&G;for(let _=0;_<R;_++)_&1?(d=l[_],d=d*b&q|d*e&G,d=d<<15|d>>>17,d=d*C&q|d*o&G,p^=d,p=p<<13|p>>>19,p=p*5+3864292196):(i=l[_],i=i*b&q|i*e&G,i=i<<15|i>>>17,i=i*C&q|i*o&G,v^=i,v=v<<13|v>>>19,v=v*5+3864292196);switch(d=0,A){case 3:d^=T[R*4+2]<<16;case 2:d^=T[R*4+1]<<8;case 1:d^=T[R*4],d=d*b&q|d*e&G,d=d<<15|d>>>17,d=d*C&q|d*o&G,R&1?p^=d:v^=d}this.h1=p,this.h2=v}hexdigest(){let m=this.h1,T=this.h2;m^=T>>>1,m=m*3981806797&q|m*36045&G,T=T*4283543511&q|((T<<16|m>>>16)*2950163797&q)>>>16,m^=T>>>1,m=m*444984403&q|m*60499&G,T=T*3301882366&q|((T<<16|m>>>16)*3120437893&q)>>>16,m^=T>>>1;const F=(m>>>0).toString(16),R=(T>>>0).toString(16);return F.padStart(8,"0")+R.padStart(8,"0")}}g.MurmurHash3_64=U},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.CanvasGraphics=void 0;var c=V(1),Q=V(11),q=V(12),G=V(3),U=V(5);const M=16,m=100,T=4096,F=15,R=10,A=1e3,l=16,d=1.000001;function i(S,a){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){a.save(),this.__originalSave()},S.restore=function(){a.restore(),this.__originalRestore()},S.translate=function(f,t){a.translate(f,t),this.__originalTranslate(f,t)},S.scale=function(f,t){a.scale(f,t),this.__originalScale(f,t)},S.transform=function(f,t,n,r,u,h){a.transform(f,t,n,r,u,h),this.__originalTransform(f,t,n,r,u,h)},S.setTransform=function(f,t,n,r,u,h){a.setTransform(f,t,n,r,u,h),this.__originalSetTransform(f,t,n,r,u,h)},S.resetTransform=function(){a.resetTransform(),this.__originalResetTransform()},S.rotate=function(f){a.rotate(f),this.__originalRotate(f)},S.clip=function(f){a.clip(f),this.__originalClip(f)},S.moveTo=function(s,f){a.moveTo(s,f),this.__originalMoveTo(s,f)},S.lineTo=function(s,f){a.lineTo(s,f),this.__originalLineTo(s,f)},S.bezierCurveTo=function(s,f,t,n,r,u){a.bezierCurveTo(s,f,t,n,r,u),this.__originalBezierCurveTo(s,f,t,n,r,u)},S.rect=function(s,f,t,n){a.rect(s,f,t,n),this.__originalRect(s,f,t,n)},S.closePath=function(){a.closePath(),this.__originalClosePath()},S.beginPath=function(){a.beginPath(),this.__originalBeginPath()}}function p(S){if(S._transformStack&&(S._transformStack=[]),!S.mozCurrentTransform){S._originalSave=S.save,S._originalRestore=S.restore,S._originalRotate=S.rotate,S._originalScale=S.scale,S._originalTranslate=S.translate,S._originalTransform=S.transform,S._originalSetTransform=S.setTransform,S._originalResetTransform=S.resetTransform,S._transformMatrix=S._transformMatrix||[1,0,0,1,0,0],S._transformStack=[];try{const a=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(S),"lineWidth");S._setLineWidth=a.set,S._getLineWidth=a.get,Object.defineProperty(S,"lineWidth",{set:function(f){this._setLineWidth(f*d)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(S,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(S,"mozCurrentTransformInverse",{get:function(){const[s,f,t,n,r,u]=this._transformMatrix,h=s*n-f*t,y=f*t-s*n;return[n/h,f/y,t/y,s/h,(n*r-t*u)/y,(f*r-s*u)/h]}}),S.save=function(){const s=this._transformMatrix;this._transformStack.push(s),this._transformMatrix=s.slice(0,6),this._originalSave()},S.restore=function(){this._transformStack.length===0&&(0,c.warn)("Tried to restore a ctx when the stack was already empty.");const s=this._transformStack.pop();s&&(this._transformMatrix=s,this._originalRestore())},S.translate=function(s,f){const t=this._transformMatrix;t[4]=t[0]*s+t[2]*f+t[4],t[5]=t[1]*s+t[3]*f+t[5],this._originalTranslate(s,f)},S.scale=function(s,f){const t=this._transformMatrix;t[0]*=s,t[1]*=s,t[2]*=f,t[3]*=f,this._originalScale(s,f)},S.transform=function(s,f,t,n,r,u){const h=this._transformMatrix;this._transformMatrix=[h[0]*s+h[2]*f,h[1]*s+h[3]*f,h[0]*t+h[2]*n,h[1]*t+h[3]*n,h[0]*r+h[2]*u+h[4],h[1]*r+h[3]*u+h[5]],S._originalTransform(s,f,t,n,r,u)},S.setTransform=function(s,f,t,n,r,u){this._transformMatrix=[s,f,t,n,r,u],S._originalSetTransform(s,f,t,n,r,u)},S.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],S._originalResetTransform()},S.rotate=function(s){const f=Math.cos(s),t=Math.sin(s),n=this._transformMatrix;this._transformMatrix=[n[0]*f+n[2]*t,n[1]*f+n[3]*t,n[0]*-t+n[2]*f,n[1]*-t+n[3]*f,n[4],n[5]],this._originalRotate(s)}}}class v{constructor(a){this.canvasFactory=a,this.cache=Object.create(null)}getCanvas(a,s,f,t){let n;return this.cache[a]!==void 0?(n=this.cache[a],this.canvasFactory.reset(n,s,f),n.context.setTransform(1,0,0,1,0,0)):(n=this.canvasFactory.create(s,f),this.cache[a]=n),t&&p(n.context),n}delete(a){delete this.cache[a]}clear(){for(const a in this.cache){const s=this.cache[a];this.canvasFactory.destroy(s),delete this.cache[a]}}}function b(S,a,s,f,t,n,r,u,h,y){const[w,N,O,W,L,X]=S.mozCurrentTransform;if(N===0&&O===0){const it=r*w+L,tt=Math.round(it),lt=u*W+X,ct=Math.round(lt),nt=(r+h)*w+L,bt=Math.abs(Math.round(nt)-tt)||1,_t=(u+y)*W+X,dt=Math.abs(Math.round(_t)-ct)||1;return S.setTransform(Math.sign(w),0,0,Math.sign(W),tt,ct),S.drawImage(a,s,f,t,n,0,0,bt,dt),S.setTransform(w,N,O,W,L,X),[bt,dt]}if(w===0&&W===0){const it=u*O+L,tt=Math.round(it),lt=r*N+X,ct=Math.round(lt),nt=(u+y)*O+L,bt=Math.abs(Math.round(nt)-tt)||1,_t=(r+h)*N+X,dt=Math.abs(Math.round(_t)-ct)||1;return S.setTransform(0,Math.sign(N),Math.sign(O),0,tt,ct),S.drawImage(a,s,f,t,n,0,0,dt,bt),S.setTransform(w,N,O,W,L,X),[dt,bt]}S.drawImage(a,s,f,t,n,r,u,h,y);const st=Math.hypot(w,N),rt=Math.hypot(O,W);return[st*h,rt*y]}function C(S){const{width:a,height:s}=S;if(a>A||s>A)return null;const f=1e3,t=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=a+1;let r=new Uint8Array(n*(s+1)),u,h,y;const w=a+7&-8;let N=new Uint8Array(w*s),O=0;for(const tt of S.data){let lt=128;for(;lt>0;)N[O++]=tt&lt?0:255,lt>>=1}let W=0;for(O=0,N[O]!==0&&(r[0]=1,++W),h=1;h<a;h++)N[O]!==N[O+1]&&(r[h]=N[O]?2:1,++W),O++;for(N[O]!==0&&(r[h]=2,++W),u=1;u<s;u++){O=u*w,y=u*n,N[O-w]!==N[O]&&(r[y]=N[O]?1:8,++W);let tt=(N[O]?4:0)+(N[O-w]?8:0);for(h=1;h<a;h++)tt=(tt>>2)+(N[O+1]?4:0)+(N[O-w+1]?8:0),t[tt]&&(r[y+h]=t[tt],++W),O++;if(N[O-w]!==N[O]&&(r[y+h]=N[O]?2:4,++W),W>f)return null}for(O=w*(s-1),y=u*n,N[O]!==0&&(r[y]=8,++W),h=1;h<a;h++)N[O]!==N[O+1]&&(r[y+h]=N[O]?4:8,++W),O++;if(N[O]!==0&&(r[y+h]=4,++W),W>f)return null;const L=new Int32Array([0,n,-1,0,-n,0,0,0,1]);let X,st,rt;for(G.isNodeJS?st=[]:X=new Path2D,u=0;W&&u<=s;u++){let tt=u*n;const lt=tt+a;for(;tt<lt&&!r[tt];)tt++;if(tt===lt)continue;X?X.moveTo(tt%n,u):rt=[tt%n,u];const ct=tt;let nt=r[tt];do{const bt=L[nt];do tt+=bt;while(!r[tt]);const _t=r[tt];_t!==5&&_t!==10?(nt=_t,r[tt]=0):(nt=_t&51*nt>>4,r[tt]&=nt>>2|nt<<2),X?X.lineTo(tt%n,tt/n|0):rt.push(tt%n,tt/n|0),r[tt]||--W}while(ct!==tt);X||st.push(rt),--u}return N=null,r=null,function(tt){if(tt.save(),tt.scale(1/a,-1/s),tt.translate(0,-s),X)tt.fill(X);else{tt.beginPath();for(const lt of st){tt.moveTo(lt[0],lt[1]);for(let ct=2,nt=lt.length;ct<nt;ct+=2)tt.lineTo(lt[ct],lt[ct+1])}tt.fill()}tt.beginPath(),tt.restore()}}class e{constructor(a,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,a,s])}clone(){const a=Object.create(this);return a.clipBox=this.clipBox.slice(),a}setCurrentPoint(a,s){this.x=a,this.y=s}updatePathMinMax(a,s,f){[s,f]=c.Util.applyTransform([s,f],a),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,f),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,f)}updateRectMinMax(a,s){const f=c.Util.applyTransform(s,a),t=c.Util.applyTransform(s.slice(2),a);this.minX=Math.min(this.minX,f[0],t[0]),this.minY=Math.min(this.minY,f[1],t[1]),this.maxX=Math.max(this.maxX,f[0],t[0]),this.maxY=Math.max(this.maxY,f[1],t[1])}updateScalingPathMinMax(a,s){c.Util.scaleMinMax(a,s),this.minX=Math.min(this.minX,s[0]),this.maxX=Math.max(this.maxX,s[1]),this.minY=Math.min(this.minY,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(a,s,f,t,n,r,u,h,y,w){const N=c.Util.bezierBoundingBox(s,f,t,n,r,u,h,y);if(w){w[0]=Math.min(w[0],N[0],N[2]),w[1]=Math.max(w[1],N[0],N[2]),w[2]=Math.min(w[2],N[1],N[3]),w[3]=Math.max(w[3],N[1],N[3]);return}this.updateRectMinMax(a,N)}getPathBoundingBox(a=Q.PathType.FILL,s=null){const f=[this.minX,this.minY,this.maxX,this.maxY];if(a===Q.PathType.STROKE){s||(0,c.unreachable)("Stroke bounding box must include transform.");const t=c.Util.singularValueDecompose2dScale(s),n=t[0]*this.lineWidth/2,r=t[1]*this.lineWidth/2;f[0]-=n,f[1]-=r,f[2]+=n,f[3]+=r}return f}updateClipFromPath(){const a=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(a||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(a){this.clipBox=a,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(a=Q.PathType.FILL,s=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(a,s))}}function o(S,a,s=null){if(typeof ImageData<"u"&&a instanceof ImageData){S.putImageData(a,0,0);return}const f=a.height,t=a.width,n=f%l,r=(f-n)/l,u=n===0?r:r+1,h=S.createImageData(t,l);let y=0,w;const N=a.data,O=h.data;let W,L,X,st,rt,it,tt,lt;if(s)switch(s.length){case 1:rt=s[0],it=s[0],tt=s[0],lt=s[0];break;case 4:rt=s[0],it=s[1],tt=s[2],lt=s[3];break}if(a.kind===c.ImageKind.GRAYSCALE_1BPP){const ct=N.byteLength,nt=new Uint32Array(O.buffer,0,O.byteLength>>2),bt=nt.length,_t=t+7>>3;let dt=4294967295,gt=c.FeatureTest.isLittleEndian?4278190080:255;for(lt&&lt[0]===255&&lt[255]===0&&([dt,gt]=[gt,dt]),W=0;W<u;W++){for(X=W<r?l:n,w=0,L=0;L<X;L++){const St=ct-y;let Tt=0;const yt=St>_t?t:St*8-7,kt=yt&-8;let mt=0,H=0;for(;Tt<kt;Tt+=8)H=N[y++],nt[w++]=H&128?dt:gt,nt[w++]=H&64?dt:gt,nt[w++]=H&32?dt:gt,nt[w++]=H&16?dt:gt,nt[w++]=H&8?dt:gt,nt[w++]=H&4?dt:gt,nt[w++]=H&2?dt:gt,nt[w++]=H&1?dt:gt;for(;Tt<yt;Tt++)mt===0&&(H=N[y++],mt=128),nt[w++]=H&mt?dt:gt,mt>>=1}for(;w<bt;)nt[w++]=0;S.putImageData(h,0,W*l)}}else if(a.kind===c.ImageKind.RGBA_32BPP){const ct=!!(rt||it||tt);for(L=0,st=t*l*4,W=0;W<r;W++){if(O.set(N.subarray(y,y+st)),y+=st,ct)for(let nt=0;nt<st;nt+=4)rt&&(O[nt+0]=rt[O[nt+0]]),it&&(O[nt+1]=it[O[nt+1]]),tt&&(O[nt+2]=tt[O[nt+2]]);S.putImageData(h,0,L),L+=l}if(W<u){if(st=t*n*4,O.set(N.subarray(y,y+st)),ct)for(let nt=0;nt<st;nt+=4)rt&&(O[nt+0]=rt[O[nt+0]]),it&&(O[nt+1]=it[O[nt+1]]),tt&&(O[nt+2]=tt[O[nt+2]]);S.putImageData(h,0,L)}}else if(a.kind===c.ImageKind.RGB_24BPP){const ct=!!(rt||it||tt);for(X=l,st=t*X,W=0;W<u;W++){for(W>=r&&(X=n,st=t*X),w=0,L=st;L--;)O[w++]=N[y++],O[w++]=N[y++],O[w++]=N[y++],O[w++]=255;if(ct)for(let nt=0;nt<w;nt+=4)rt&&(O[nt+0]=rt[O[nt+0]]),it&&(O[nt+1]=it[O[nt+1]]),tt&&(O[nt+2]=tt[O[nt+2]]);S.putImageData(h,0,W*l)}}else throw new Error(`bad image kind: ${a.kind}`)}function _(S,a){if(a.bitmap){S.drawImage(a.bitmap,0,0);return}const s=a.height,f=a.width,t=s%l,n=(s-t)/l,r=t===0?n:n+1,u=S.createImageData(f,l);let h=0;const y=a.data,w=u.data;for(let N=0;N<r;N++){const O=N<n?l:t;({srcPos:h}=(0,q.applyMaskImageData)({src:y,srcPos:h,dest:w,width:f,height:O})),S.putImageData(u,0,N*l)}}function P(S,a){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let f=0,t=s.length;f<t;f++){const n=s[f];S[n]!==void 0&&(a[n]=S[n])}S.setLineDash!==void 0&&(a.setLineDash(S.getLineDash()),a.lineDashOffset=S.lineDashOffset)}function x(S,a){S.strokeStyle=S.fillStyle=a||"#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0)}function E(S,a,s,f){const t=S.length;for(let n=3;n<t;n+=4){const r=S[n];if(r===0)S[n-3]=a,S[n-2]=s,S[n-1]=f;else if(r<255){const u=255-r;S[n-3]=S[n-3]*r+a*u>>8,S[n-2]=S[n-2]*r+s*u>>8,S[n-1]=S[n-1]*r+f*u>>8}}}function k(S,a,s){const f=S.length,t=1/255;for(let n=3;n<f;n+=4){const r=s?s[S[n]]:S[n];a[n]=a[n]*r*t|0}}function D(S,a,s){const f=S.length;for(let t=3;t<f;t+=4){const n=S[t-3]*77+S[t-2]*152+S[t-1]*28;a[t]=s?a[t]*s[n>>8]>>8:a[t]*n>>16}}function $(S,a,s,f,t,n,r,u,h,y,w){const N=!!n,O=N?n[0]:0,W=N?n[1]:0,L=N?n[2]:0;let X;t==="Luminosity"?X=D:X=k;const rt=Math.min(f,Math.ceil(1048576/s));for(let it=0;it<f;it+=rt){const tt=Math.min(rt,f-it),lt=S.getImageData(u-y,it+(h-w),s,tt),ct=a.getImageData(u,it+h,s,tt);N&&E(lt.data,O,W,L),X(lt.data,ct.data,r),a.putImageData(ct,u,it+h)}}function B(S,a,s,f){const t=f[0],n=f[1],r=f[2]-t,u=f[3]-n;r===0||u===0||($(a.context,s,r,u,a.subtype,a.backdrop,a.transferMap,t,n,a.offsetX,a.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(s.canvas,0,0),S.restore())}function z(S,a){const s=c.Util.singularValueDecompose2dScale(S);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const f=Math.fround((globalThis.devicePixelRatio||1)*U.PixelsPerInch.PDF_TO_CSS_UNITS);return a!==void 0?a:s[0]<=f||s[1]<=f}const K=["butt","round","square"],Z=["miter","round","bevel"],Y={},et={};class ot{constructor(a,s,f,t,n,r,u,h){this.ctx=a,this.current=new e(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=f,this.canvasFactory=t,this.imageLayer=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=r,this.cachedCanvases=new v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(h==null?void 0:h.background)||null,this.foregroundColor=(h==null?void 0:h.foreground)||null,a&&p(a),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(a,s=null){return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):s}beginDrawing({transform:a,viewport:s,transparency:f=!1,background:t=null}){const n=this.ctx.canvas.width,r=this.ctx.canvas.height,u=t||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const h=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const y=this.backgroundColor=this.ctx.fillStyle;let w=!0,N=u;if(this.ctx.fillStyle=u,N=this.ctx.fillStyle,w=typeof N=="string"&&/^#[0-9A-Fa-f]{6}$/.test(N),h==="#000000"&&y==="#ffffff"||h===y||!w)this.foregroundColor=this.backgroundColor=null;else{const O=parseInt(N.slice(1),16),W=(O&&16711680)>>16,L=(O&&65280)>>8,X=O&&255,st=it=>(it/=255,it<=.03928?it/12.92:((it+.055)/1.055)**2.4),rt=Math.round(.2126*st(W)+.7152*st(L)+.0722*st(X));this.selectColor=(it,tt,lt)=>{const ct=.2126*st(it)+.7152*st(tt)+.0722*st(lt);return Math.round(ct)===rt?y:h}}}if(this.ctx.fillStyle=this.backgroundColor||u,this.ctx.fillRect(0,0,n,r),this.ctx.restore(),f){const h=this.cachedCanvases.getCanvas("transparent",n,r,!0);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),x(this.ctx,this.foregroundColor),a&&(this.ctx.transform.apply(this.ctx,a),this.outputScaleX=a[0],this.outputScaleY=a[0]),this.ctx.transform.apply(this.ctx,s.transform),this.viewportScale=s.scale,this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(a,s,f,t){const n=a.argsArray,r=a.fnArray;let u=s||0;const h=n.length;if(h===u)return u;const y=h-u>R&&typeof f=="function",w=y?Date.now()+F:0;let N=0;const O=this.commonObjs,W=this.objs;let L;for(;;){if(t!==void 0&&u===t.nextBreakPoint)return t.breakIt(u,f),u;if(L=r[u],L!==c.OPS.dependency)this[L].apply(this,n[u]);else for(const X of n[u]){const st=X.startsWith("g_")?O:W;if(!st.has(X))return st.get(X,f),u}if(u++,u===h)return u;if(y&&++N>R){if(Date.now()>w)return f(),u;N=0}}}endDrawing(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const a of this._cachedBitmapsMap.values()){for(const s of a.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);a.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(a,s){const f=a.width,t=a.height;let n=Math.max(Math.hypot(s[0],s[1]),1),r=Math.max(Math.hypot(s[2],s[3]),1),u=f,h=t,y="prescale1",w,N;for(;n>2&&u>1||r>2&&h>1;){let O=u,W=h;n>2&&u>1&&(O=Math.ceil(u/2),n/=u/O),r>2&&h>1&&(W=Math.ceil(h/2),r/=h/W),w=this.cachedCanvases.getCanvas(y,O,W,!1),N=w.context,N.clearRect(0,0,O,W),N.drawImage(a,0,0,u,h,0,0,O,W),a=w.canvas,u=O,h=W,y=y==="prescale1"?"prescale2":"prescale1"}return{img:a,paintWidth:u,paintHeight:h}}_createMaskCanvas(a){const s=this.ctx,{width:f,height:t}=a,n=this.current.fillColor,r=this.current.patternFill,u=s.mozCurrentTransform;let h,y,w,N;if((a.bitmap||a.data)&&a.count>1){const bt=a.bitmap||a.data.buffer,_t=u.slice(0,4);y=JSON.stringify(r?_t:[_t,n]),h=this._cachedBitmapsMap.get(bt),h||(h=new Map,this._cachedBitmapsMap.set(bt,h));const dt=h.get(y);if(dt&&!r){const gt=Math.round(Math.min(u[0],u[2])+u[4]),St=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:dt,offsetX:gt,offsetY:St}}w=dt}w||(N=this.cachedCanvases.getCanvas("maskCanvas",f,t,!1),_(N.context,a));let O=c.Util.transform(u,[1/f,0,0,-1/t,0,0]);O=c.Util.transform(O,[1,0,0,1,0,-t]);const W=c.Util.applyTransform([0,0],O),L=c.Util.applyTransform([f,t],O),X=c.Util.normalizeRect([W[0],W[1],L[0],L[1]]),st=Math.round(X[2]-X[0])||1,rt=Math.round(X[3]-X[1])||1,it=this.cachedCanvases.getCanvas("fillCanvas",st,rt,!0),tt=it.context,lt=Math.min(W[0],L[0]),ct=Math.min(W[1],L[1]);tt.translate(-lt,-ct),tt.transform.apply(tt,O),w||(w=this._scaleImage(N.canvas,tt.mozCurrentTransformInverse),w=w.img,h&&r&&h.set(y,w)),tt.imageSmoothingEnabled=z(tt.mozCurrentTransform,a.interpolate),b(tt,w,0,0,w.width,w.height,0,0,f,t),tt.globalCompositeOperation="source-in";const nt=c.Util.transform(tt.mozCurrentTransformInverse,[1,0,0,1,-lt,-ct]);return tt.fillStyle=r?n.getPattern(s,this,nt,Q.PathType.FILL):n,tt.fillRect(0,0,f,t),h&&!r&&(this.cachedCanvases.delete("fillCanvas"),h.set(y,it.canvas)),{canvas:it.canvas,offsetX:Math.round(lt),offsetY:Math.round(ct)}}setLineWidth(a){a!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=a,this.ctx.lineWidth=a}setLineCap(a){this.ctx.lineCap=K[a]}setLineJoin(a){this.ctx.lineJoin=Z[a]}setMiterLimit(a){this.ctx.miterLimit=a}setDash(a,s){const f=this.ctx;f.setLineDash!==void 0&&(f.setLineDash(a),f.lineDashOffset=s)}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(let s=0,f=a.length;s<f;s++){const t=a[s],n=t[0],r=t[1];switch(n){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=t[1];break;case"ca":this.current.fillAlpha=t[1],this.ctx.globalAlpha=t[1];break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=r}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const a=this.inSMaskMode;this.current.activeSMask&&!a?this.beginSMaskMode():!this.current.activeSMask&&a&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const a=this.ctx.canvas.width,s=this.ctx.canvas.height,f="smaskGroupAt"+this.groupLevel,t=this.cachedCanvases.getCanvas(f,a,s,!0);this.suspendedCtx=this.ctx,this.ctx=t.context;const n=this.ctx;n.setTransform.apply(n,this.suspendedCtx.mozCurrentTransform),P(this.suspendedCtx,n),i(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),P(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(a){if(!this.current.activeSMask)return;a?(a[0]=Math.floor(a[0]),a[1]=Math.floor(a[1]),a[2]=Math.ceil(a[2]),a[3]=Math.ceil(a[3])):a=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,f=this.suspendedCtx;B(f,s,this.ctx,a),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(P(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const a=this.current;this.stateStack.push(a),this.current=a.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),P(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(a,s,f,t,n,r){this.ctx.transform(a,s,f,t,n,r),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(a,s,f){const t=this.ctx,n=this.current;let r=n.x,u=n.y,h,y;const w=t.mozCurrentTransform,N=w[0]===0&&w[3]===0||w[1]===0&&w[2]===0,O=N?f.slice(0):null;for(let W=0,L=0,X=a.length;W<X;W++)switch(a[W]|0){case c.OPS.rectangle:r=s[L++],u=s[L++];const st=s[L++],rt=s[L++],it=r+st,tt=u+rt;t.moveTo(r,u),st===0||rt===0?t.lineTo(it,tt):(t.lineTo(it,u),t.lineTo(it,tt),t.lineTo(r,tt)),N||n.updateRectMinMax(w,[r,u,it,tt]),t.closePath();break;case c.OPS.moveTo:r=s[L++],u=s[L++],t.moveTo(r,u),N||n.updatePathMinMax(w,r,u);break;case c.OPS.lineTo:r=s[L++],u=s[L++],t.lineTo(r,u),N||n.updatePathMinMax(w,r,u);break;case c.OPS.curveTo:h=r,y=u,r=s[L+4],u=s[L+5],t.bezierCurveTo(s[L],s[L+1],s[L+2],s[L+3],r,u),n.updateCurvePathMinMax(w,h,y,s[L],s[L+1],s[L+2],s[L+3],r,u,O),L+=6;break;case c.OPS.curveTo2:h=r,y=u,t.bezierCurveTo(r,u,s[L],s[L+1],s[L+2],s[L+3]),n.updateCurvePathMinMax(w,h,y,r,u,s[L],s[L+1],s[L+2],s[L+3],O),r=s[L+2],u=s[L+3],L+=4;break;case c.OPS.curveTo3:h=r,y=u,r=s[L+2],u=s[L+3],t.bezierCurveTo(s[L],s[L+1],r,u,r,u),n.updateCurvePathMinMax(w,h,y,s[L],s[L+1],r,u,r,u,O),L+=4;break;case c.OPS.closePath:t.closePath();break}N&&n.updateScalingPathMinMax(w,O),n.setCurrentPoint(r,u)}closePath(){this.ctx.closePath()}stroke(a){a=typeof a<"u"?a:!0;const s=this.ctx,f=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof f=="object"&&(f==null?void 0:f.getPattern)?(s.save(),s.strokeStyle=f.getPattern(s,this,s.mozCurrentTransformInverse,Q.PathType.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),a&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(a){a=typeof a<"u"?a:!0;const s=this.ctx,f=this.current.fillColor,t=this.current.patternFill;let n=!1;t&&(s.save(),s.fillStyle=f.getPattern(s,this,s.mozCurrentTransformInverse,Q.PathType.FILL),n=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&r!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),n&&s.restore(),a&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Y}eoClip(){this.pendingClip=et}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const a=this.pendingTextPaths,s=this.ctx;if(a===void 0){s.beginPath();return}s.save(),s.beginPath();for(let f=0;f<a.length;f++){const t=a[f];s.setTransform.apply(s,t.transform),s.translate(t.x,t.y),t.addToPath(s,t.fontSize)}s.restore(),s.clip(),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(a){this.current.charSpacing=a}setWordSpacing(a){this.current.wordSpacing=a}setHScale(a){this.current.textHScale=a/100}setLeading(a){this.current.leading=-a}setFont(a,s){const f=this.commonObjs.get(a),t=this.current;if(!f)throw new Error(`Can't find font for ${a}`);if(t.fontMatrix=f.fontMatrix||c.FONT_IDENTITY_MATRIX,(t.fontMatrix[0]===0||t.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+a),s<0?(s=-s,t.fontDirection=-1):t.fontDirection=1,this.current.font=f,this.current.fontSize=s,f.isType3Font)return;const n=f.loadedName||"sans-serif";let r="normal";f.black?r="900":f.bold&&(r="bold");const u=f.italic?"italic":"normal",h=`"${n}", ${f.fallbackName}`;let y=s;s<M?y=M:s>m&&(y=m),this.current.fontSizeScale=s/y,this.ctx.font=`${u} ${r} ${y}px ${h}`}setTextRenderingMode(a){this.current.textRenderingMode=a}setTextRise(a){this.current.textRise=a}moveText(a,s){this.current.x=this.current.lineX+=a,this.current.y=this.current.lineY+=s}setLeadingMoveText(a,s){this.setLeading(-s),this.moveText(a,s)}setTextMatrix(a,s,f,t,n,r){this.current.textMatrix=[a,s,f,t,n,r],this.current.textMatrixScale=Math.hypot(a,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(a,s,f,t){const n=this.ctx,r=this.current,u=r.font,h=r.textRenderingMode,y=r.fontSize/r.fontSizeScale,w=h&c.TextRenderingMode.FILL_STROKE_MASK,N=!!(h&c.TextRenderingMode.ADD_TO_PATH_FLAG),O=r.patternFill&&!u.missingFile;let W;(u.disableFontFace||N||O)&&(W=u.getPathGenerator(this.commonObjs,a)),u.disableFontFace||O?(n.save(),n.translate(s,f),n.beginPath(),W(n,y),t&&n.setTransform.apply(n,t),(w===c.TextRenderingMode.FILL||w===c.TextRenderingMode.FILL_STROKE)&&n.fill(),(w===c.TextRenderingMode.STROKE||w===c.TextRenderingMode.FILL_STROKE)&&n.stroke(),n.restore()):((w===c.TextRenderingMode.FILL||w===c.TextRenderingMode.FILL_STROKE)&&n.fillText(a,s,f),(w===c.TextRenderingMode.STROKE||w===c.TextRenderingMode.FILL_STROKE)&&n.strokeText(a,s,f)),N&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:n.mozCurrentTransform,x:s,y:f,fontSize:y,addToPath:W})}get isFontSubpixelAAEnabled(){const{context:a}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10,!1);a.scale(1.5,1),a.fillText("I",0,10);const s=a.getImageData(0,0,10,10).data;let f=!1;for(let t=3;t<s.length;t+=4)if(s[t]>0&&s[t]<255){f=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",f)}showText(a){const s=this.current,f=s.font;if(f.isType3Font)return this.showType3Text(a);const t=s.fontSize;if(t===0)return;const n=this.ctx,r=s.fontSizeScale,u=s.charSpacing,h=s.wordSpacing,y=s.fontDirection,w=s.textHScale*y,N=a.length,O=f.vertical,W=O?1:-1,L=f.defaultVMetrics,X=t*s.fontMatrix[0],st=s.textRenderingMode===c.TextRenderingMode.FILL&&!f.disableFontFace&&!s.patternFill;n.save(),n.transform.apply(n,s.textMatrix),n.translate(s.x,s.y+s.textRise),y>0?n.scale(w,-1):n.scale(w,1);let rt;if(s.patternFill){n.save();const nt=s.fillColor.getPattern(n,this,n.mozCurrentTransformInverse,Q.PathType.FILL);rt=n.mozCurrentTransform,n.restore(),n.fillStyle=nt}let it=s.lineWidth;const tt=s.textMatrixScale;if(tt===0||it===0){const nt=s.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(nt===c.TextRenderingMode.STROKE||nt===c.TextRenderingMode.FILL_STROKE)&&(it=this.getSinglePixelWidth())}else it/=tt;r!==1&&(n.scale(r,r),it/=r),n.lineWidth=it;let lt=0,ct;for(ct=0;ct<N;++ct){const nt=a[ct];if(typeof nt=="number"){lt+=W*nt*t/1e3;continue}let bt=!1;const _t=(nt.isSpace?h:0)+u,dt=nt.fontChar,gt=nt.accent;let St,Tt,yt=nt.width;if(O){const mt=nt.vmetric||L,H=-(nt.vmetric?mt[1]:yt*.5)*X,I=mt[2]*X;yt=mt?-mt[0]:yt,St=H/r,Tt=(lt+I)/r}else St=lt/r,Tt=0;if(f.remeasure&&yt>0){const mt=n.measureText(dt).width*1e3/t*r;if(yt<mt&&this.isFontSubpixelAAEnabled){const H=yt/mt;bt=!0,n.save(),n.scale(H,1),St/=H}else yt!==mt&&(St+=(yt-mt)/2e3*t/r)}if(this.contentVisible&&(nt.isInFont||f.missingFile)){if(st&&!gt)n.fillText(dt,St,Tt);else if(this.paintChar(dt,St,Tt,rt),gt){const mt=St+t*gt.offset.x/r,H=Tt-t*gt.offset.y/r;this.paintChar(gt.fontChar,mt,H,rt)}}let kt;O?kt=yt*X-_t*y:kt=yt*X+_t*y,lt+=kt,bt&&n.restore()}O?s.y-=lt:s.x+=lt*w,n.restore(),this.compose()}showType3Text(a){const s=this.ctx,f=this.current,t=f.font,n=f.fontSize,r=f.fontDirection,u=t.vertical?1:-1,h=f.charSpacing,y=f.wordSpacing,w=f.textHScale*r,N=f.fontMatrix||c.FONT_IDENTITY_MATRIX,O=a.length,W=f.textRenderingMode===c.TextRenderingMode.INVISIBLE;let L,X,st,rt;if(!(W||n===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,s.save(),s.transform.apply(s,f.textMatrix),s.translate(f.x,f.y),s.scale(w,r),L=0;L<O;++L){if(X=a[L],typeof X=="number"){rt=u*X*n/1e3,this.ctx.translate(rt,0),f.x+=rt*w;continue}const it=(X.isSpace?y:0)+h,tt=t.charProcOperatorList[X.operatorListId];if(!tt){(0,c.warn)(`Type3 character "${X.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=X,this.save(),s.scale(n,n),s.transform.apply(s,N),this.executeOperatorList(tt),this.restore()),st=c.Util.applyTransform([X.width,0],N)[0]*n+it,s.translate(st,0),f.x+=st*w}s.restore(),this.processingType3=null}}setCharWidth(a,s){}setCharWidthAndBounds(a,s,f,t,n,r){this.ctx.rect(f,t,n-f,r-t),this.ctx.clip(),this.endPath()}getColorN_Pattern(a){let s;if(a[0]==="TilingPattern"){const f=a[1],t=this.baseTransform||this.ctx.mozCurrentTransform.slice(),n={createCanvasGraphics:r=>new ot(r,this.commonObjs,this.objs,this.canvasFactory)};s=new Q.TilingPattern(a,f,this.ctx,n,t)}else s=this._getPattern(a[1],a[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(a,s,f){var n;const t=((n=this.selectColor)==null?void 0:n.call(this,a,s,f))||c.Util.makeHexColor(a,s,f);this.ctx.strokeStyle=t,this.current.strokeColor=t}setFillRGBColor(a,s,f){var n;const t=((n=this.selectColor)==null?void 0:n.call(this,a,s,f))||c.Util.makeHexColor(a,s,f);this.ctx.fillStyle=t,this.current.fillColor=t,this.current.patternFill=!1}_getPattern(a,s=null){let f;return this.cachedPatterns.has(a)?f=this.cachedPatterns.get(a):(f=(0,Q.getShadingPattern)(this.objs.get(a)),this.cachedPatterns.set(a,f)),s&&(f.matrix=s),f}shadingFill(a){if(!this.contentVisible)return;const s=this.ctx;this.save();const f=this._getPattern(a);s.fillStyle=f.getPattern(s,this,s.mozCurrentTransformInverse,Q.PathType.SHADING);const t=s.mozCurrentTransformInverse;if(t){const n=s.canvas,r=n.width,u=n.height,h=c.Util.applyTransform([0,0],t),y=c.Util.applyTransform([0,u],t),w=c.Util.applyTransform([r,0],t),N=c.Util.applyTransform([r,u],t),O=Math.min(h[0],y[0],w[0],N[0]),W=Math.min(h[1],y[1],w[1],N[1]),L=Math.max(h[0],y[0],w[0],N[0]),X=Math.max(h[1],y[1],w[1],N[1]);this.ctx.fillRect(O,W,L-O,X-W)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(a,s){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(a)&&a.length===6&&this.transform.apply(this,a),this.baseTransform=this.ctx.mozCurrentTransform,s)){const f=s[2]-s[0],t=s[3]-s[1];this.ctx.rect(s[0],s[1],f,t),this.current.updateRectMinMax(this.ctx.mozCurrentTransform,s),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(a){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;a.isolated||(0,c.info)("TODO: Support non-isolated groups."),a.knockout&&(0,c.warn)("Knockout groups not supported.");const f=s.mozCurrentTransform;if(a.matrix&&s.transform.apply(s,a.matrix),!a.bbox)throw new Error("Bounding box is required.");let t=c.Util.getAxialAlignedBoundingBox(a.bbox,s.mozCurrentTransform);const n=[0,0,s.canvas.width,s.canvas.height];t=c.Util.intersect(t,n)||[0,0,0,0];const r=Math.floor(t[0]),u=Math.floor(t[1]);let h=Math.max(Math.ceil(t[2])-r,1),y=Math.max(Math.ceil(t[3])-u,1),w=1,N=1;h>T&&(w=h/T,h=T),y>T&&(N=y/T,y=T),this.current.startNewPathAndClipBox([0,0,h,y]);let O="groupAt"+this.groupLevel;a.smask&&(O+="_smask_"+this.smaskCounter++%2);const W=this.cachedCanvases.getCanvas(O,h,y,!0),L=W.context;L.scale(1/w,1/N),L.translate(-r,-u),L.transform.apply(L,f),a.smask?this.smaskStack.push({canvas:W.canvas,context:L,offsetX:r,offsetY:u,scaleX:w,scaleY:N,subtype:a.smask.subtype,backdrop:a.smask.backdrop,transferMap:a.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(r,u),s.scale(w,N),s.save()),P(s,L),this.ctx=L,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(a){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,f=this.groupStack.pop();if(this.ctx=f,this.ctx.imageSmoothingEnabled=!1,a.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=this.ctx.mozCurrentTransform;this.restore(),this.ctx.save(),this.ctx.setTransform.apply(this.ctx,t);const n=c.Util.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],t);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(a,s,f,t,n){if(this.save(),Array.isArray(s)&&s.length===4){const r=s[2]-s[0],u=s[3]-s[1];if(n&&this.annotationCanvasMap){f=f.slice(),f[4]-=s[0],f[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=r,s[3]=u;const[h,y]=c.Util.singularValueDecompose2dScale(this.ctx.mozCurrentTransform),{viewportScale:w}=this,N=Math.ceil(r*this.outputScaleX*w),O=Math.ceil(u*this.outputScaleY*w);this.annotationCanvas=this.canvasFactory.create(N,O);const{canvas:W,context:L}=this.annotationCanvas,X=`var(--zoom-factor) * ${U.PixelsPerInch.PDF_TO_CSS_UNITS}`;W.style.width=`calc(${r}px * ${X})`,W.style.height=`calc(${u}px * ${X})`,this.annotationCanvasMap.set(a,W),this.annotationCanvas.savedCtx=this.ctx,this.ctx=L,this.ctx.setTransform(h,0,0,-y,0,u*y),p(this.ctx),x(this.ctx,this.foregroundColor)}else x(this.ctx,this.foregroundColor),this.ctx.rect(s[0],s[1],r,u),this.ctx.clip(),this.endPath()}this.current=new e(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,f),this.transform.apply(this,t)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas),this.restore()}paintImageMaskXObject(a){if(!this.contentVisible)return;const s=a.count;a=this.getObject(a.data,a),a.count=s;const f=this.ctx,t=this.processingType3;if(t&&(t.compiled===void 0&&(t.compiled=C(a)),t.compiled)){t.compiled(f);return}const n=this._createMaskCanvas(a),r=n.canvas;f.save(),f.setTransform(1,0,0,1,0,0),f.drawImage(r,n.offsetX,n.offsetY),f.restore(),this.compose()}paintImageMaskXObjectRepeat(a,s,f=0,t=0,n,r){if(!this.contentVisible)return;a=this.getObject(a.data,a);const u=this.ctx;u.save();const h=u.mozCurrentTransform;u.transform(s,f,t,n,0,0);const y=this._createMaskCanvas(a);u.setTransform(1,0,0,1,0,0);for(let w=0,N=r.length;w<N;w+=2){const O=c.Util.transform(h,[s,f,t,n,r[w],r[w+1]]),[W,L]=c.Util.applyTransform([0,0],O);u.drawImage(y.canvas,W,L)}u.restore(),this.compose()}paintImageMaskXObjectGroup(a){if(!this.contentVisible)return;const s=this.ctx,f=this.current.fillColor,t=this.current.patternFill;for(let n=0,r=a.length;n<r;n++){const u=a[n],h=u.width,y=u.height,w=this.cachedCanvases.getCanvas("maskCanvas",h,y,!1),N=w.context;N.save(),_(N,u),N.globalCompositeOperation="source-in",N.fillStyle=t?f.getPattern(N,this,s.mozCurrentTransformInverse,Q.PathType.FILL):f,N.fillRect(0,0,h,y),N.restore(),s.save(),s.transform.apply(s,u.transform),s.scale(1,-1),b(s,w.canvas,0,0,h,y,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(a){if(!this.contentVisible)return;const s=this.getObject(a);if(!s){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(a,s,f,t){if(!this.contentVisible)return;const n=this.getObject(a);if(!n){(0,c.warn)("Dependent image isn't ready yet");return}const r=n.width,u=n.height,h=[];for(let y=0,w=t.length;y<w;y+=2)h.push({transform:[s,0,0,f,t[y],t[y+1]],x:0,y:0,w:r,h:u});this.paintInlineImageXObjectGroup(n,h)}paintInlineImageXObject(a){if(!this.contentVisible)return;const s=a.width,f=a.height,t=this.ctx;this.save(),t.scale(1/s,-1/f);let n;if(typeof HTMLElement=="function"&&a instanceof HTMLElement||!a.data)n=a;else{const y=this.cachedCanvases.getCanvas("inlineImage",s,f,!1),w=y.context;o(w,a,this.current.transferMaps),n=y.canvas}const r=this._scaleImage(n,t.mozCurrentTransformInverse);t.imageSmoothingEnabled=z(t.mozCurrentTransform,a.interpolate);const[u,h]=b(t,r.img,0,0,r.paintWidth,r.paintHeight,0,-f,s,f);if(this.imageLayer){const y=this.getCanvasPosition(0,-f);this.imageLayer.appendImage({imgData:a,left:y[0],top:y[1],width:u,height:h})}this.compose(),this.restore()}paintInlineImageXObjectGroup(a,s){if(!this.contentVisible)return;const f=this.ctx,t=a.width,n=a.height,r=this.cachedCanvases.getCanvas("inlineImage",t,n,!1),u=r.context;o(u,a,this.current.transferMaps);for(let h=0,y=s.length;h<y;h++){const w=s[h];if(f.save(),f.transform.apply(f,w.transform),f.scale(1,-1),b(f,r.canvas,w.x,w.y,w.w,w.h,0,-1,1,1),this.imageLayer){const N=this.getCanvasPosition(w.x,w.y);this.imageLayer.appendImage({imgData:a,left:N[0],top:N[1],width:t,height:n})}f.restore()}this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(a){}markPointProps(a,s){}beginMarkedContent(a){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(a,s){a==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(a){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(a);const f=this.ctx;this.pendingClip&&(s||(this.pendingClip===et?f.clip("evenodd"):f.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),f.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const a=this.ctx.mozCurrentTransform;if(a[1]===0&&a[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(a[0]),Math.abs(a[3]));else{const s=Math.abs(a[0]*a[3]-a[2]*a[1]),f=Math.hypot(a[0],a[2]),t=Math.hypot(a[1],a[3]);this._cachedGetSinglePixelWidth=Math.max(f,t)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:a}=this.current,s=this.ctx.mozCurrentTransform;let f,t;if(s[1]===0&&s[2]===0){const n=Math.abs(s[0]),r=Math.abs(s[3]);if(a===0)f=1/n,t=1/r;else{const u=n*a,h=r*a;f=u<1?1/u:1,t=h<1?1/h:1}}else{const n=Math.abs(s[0]*s[3]-s[2]*s[1]),r=Math.hypot(s[0],s[1]),u=Math.hypot(s[2],s[3]);if(a===0)f=u/n,t=r/n;else{const h=a*n;f=u>h?u/h:1,t=r>h?r/h:1}}this._cachedScaleForStroking=[f,t]}return this._cachedScaleForStroking}rescaleAndStroke(a){const{ctx:s}=this,{lineWidth:f}=this.current,[t,n]=this.getScaleForStroking();if(s.lineWidth=f||1,t===1&&n===1){s.stroke();return}let r,u,h;a&&(r=s.mozCurrentTransform.slice(),u=s.getLineDash().slice(),h=s.lineDashOffset),s.scale(t,n);const y=Math.max(t,n);s.setLineDash(s.getLineDash().map(w=>w/y)),s.lineDashOffset/=y,s.stroke(),a&&(s.setTransform(...r),s.setLineDash(u),s.lineDashOffset=h)}getCanvasPosition(a,s){const f=this.ctx.mozCurrentTransform;return[f[0]*a+f[2]*s+f[4],f[1]*a+f[3]*s+f[5]]}isContentVisible(){for(let a=this.markedContentStack.length-1;a>=0;a--)if(!this.markedContentStack[a].visible)return!1;return!0}}g.CanvasGraphics=ot;for(const S in c.OPS)ot.prototype[S]!==void 0&&(ot.prototype[c.OPS[S]]=ot.prototype[S])},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.TilingPattern=g.PathType=void 0,g.getShadingPattern=A;var c=V(1),Q=V(3);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};g.PathType=q;function G(i,p){if(!p||Q.isNodeJS)return;const v=p[2]-p[0],b=p[3]-p[1],C=new Path2D;C.rect(p[0],p[1],v,b),i.clip(C)}class U{constructor(){this.constructor===U&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class M extends U{constructor(p){super(),this._type=p[1],this._bbox=p[2],this._colorStops=p[3],this._p0=p[4],this._p1=p[5],this._r0=p[6],this._r1=p[7],this.matrix=null}_createGradient(p){let v;this._type==="axial"?v=p.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(v=p.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const b of this._colorStops)v.addColorStop(b[0],b[1]);return v}getPattern(p,v,b,C){let e;if(C===q.STROKE||C===q.FILL){const o=v.current.getClippedPathBoundingBox(C,p.mozCurrentTransform)||[0,0,0,0],_=Math.ceil(o[2]-o[0])||1,P=Math.ceil(o[3]-o[1])||1,x=v.cachedCanvases.getCanvas("pattern",_,P,!0),E=x.context;E.clearRect(0,0,E.canvas.width,E.canvas.height),E.beginPath(),E.rect(0,0,E.canvas.width,E.canvas.height),E.translate(-o[0],-o[1]),b=c.Util.transform(b,[1,0,0,1,o[0],o[1]]),E.transform.apply(E,v.baseTransform),this.matrix&&E.transform.apply(E,this.matrix),G(E,this._bbox),E.fillStyle=this._createGradient(E),E.fill(),e=p.createPattern(x.canvas,"no-repeat");const k=new DOMMatrix(b);try{e.setTransform(k)}catch(D){(0,c.warn)(`RadialAxialShadingPattern.getPattern: "${D==null?void 0:D.message}".`)}}else G(p,this._bbox),e=this._createGradient(p);return e}}function m(i,p,v,b,C,e,o,_){const P=p.coords,x=p.colors,E=i.data,k=i.width*4;let D;P[v+1]>P[b+1]&&(D=v,v=b,b=D,D=e,e=o,o=D),P[b+1]>P[C+1]&&(D=b,b=C,C=D,D=o,o=_,_=D),P[v+1]>P[b+1]&&(D=v,v=b,b=D,D=e,e=o,o=D);const $=(P[v]+p.offsetX)*p.scaleX,B=(P[v+1]+p.offsetY)*p.scaleY,z=(P[b]+p.offsetX)*p.scaleX,K=(P[b+1]+p.offsetY)*p.scaleY,Z=(P[C]+p.offsetX)*p.scaleX,Y=(P[C+1]+p.offsetY)*p.scaleY;if(B>=Y)return;const et=x[e],ot=x[e+1],S=x[e+2],a=x[o],s=x[o+1],f=x[o+2],t=x[_],n=x[_+1],r=x[_+2],u=Math.round(B),h=Math.round(Y);let y,w,N,O,W,L,X,st;for(let rt=u;rt<=h;rt++){if(rt<K){let nt;rt<B?nt=0:nt=(B-rt)/(B-K),y=$-($-z)*nt,w=et-(et-a)*nt,N=ot-(ot-s)*nt,O=S-(S-f)*nt}else{let nt;rt>Y?nt=1:K===Y?nt=0:nt=(K-rt)/(K-Y),y=z-(z-Z)*nt,w=a-(a-t)*nt,N=s-(s-n)*nt,O=f-(f-r)*nt}let it;rt<B?it=0:rt>Y?it=1:it=(B-rt)/(B-Y),W=$-($-Z)*it,L=et-(et-t)*it,X=ot-(ot-n)*it,st=S-(S-r)*it;const tt=Math.round(Math.min(y,W)),lt=Math.round(Math.max(y,W));let ct=k*rt+tt*4;for(let nt=tt;nt<=lt;nt++)it=(y-nt)/(y-W),it<0?it=0:it>1&&(it=1),E[ct++]=w-(w-L)*it|0,E[ct++]=N-(N-X)*it|0,E[ct++]=O-(O-st)*it|0,E[ct++]=255}}function T(i,p,v){const b=p.coords,C=p.colors;let e,o;switch(p.type){case"lattice":const _=p.verticesPerRow,P=Math.floor(b.length/_)-1,x=_-1;for(e=0;e<P;e++){let E=e*_;for(let k=0;k<x;k++,E++)m(i,v,b[E],b[E+1],b[E+_],C[E],C[E+1],C[E+_]),m(i,v,b[E+_+1],b[E+1],b[E+_],C[E+_+1],C[E+1],C[E+_])}break;case"triangles":for(e=0,o=b.length;e<o;e+=3)m(i,v,b[e],b[e+1],b[e+2],C[e],C[e+1],C[e+2]);break;default:throw new Error("illegal figure")}}class F extends U{constructor(p){super(),this._coords=p[2],this._colors=p[3],this._figures=p[4],this._bounds=p[5],this._bbox=p[7],this._background=p[8],this.matrix=null}_createMeshCanvas(p,v,b){const _=Math.floor(this._bounds[0]),P=Math.floor(this._bounds[1]),x=Math.ceil(this._bounds[2])-_,E=Math.ceil(this._bounds[3])-P,k=Math.min(Math.ceil(Math.abs(x*p[0]*1.1)),3e3),D=Math.min(Math.ceil(Math.abs(E*p[1]*1.1)),3e3),$=x/k,B=E/D,z={coords:this._coords,colors:this._colors,offsetX:-_,offsetY:-P,scaleX:1/$,scaleY:1/B},K=k+2*2,Z=D+2*2,Y=b.getCanvas("mesh",K,Z,!1),et=Y.context,ot=et.createImageData(k,D);if(v){const a=ot.data;for(let s=0,f=a.length;s<f;s+=4)a[s]=v[0],a[s+1]=v[1],a[s+2]=v[2],a[s+3]=255}for(const a of this._figures)T(ot,a,z);return et.putImageData(ot,2,2),{canvas:Y.canvas,offsetX:_-2*$,offsetY:P-2*B,scaleX:$,scaleY:B}}getPattern(p,v,b,C){G(p,this._bbox);let e;if(C===q.SHADING)e=c.Util.singularValueDecompose2dScale(p.mozCurrentTransform);else if(e=c.Util.singularValueDecompose2dScale(v.baseTransform),this.matrix){const _=c.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*_[0],e[1]*_[1]]}const o=this._createMeshCanvas(e,C===q.SHADING?null:this._background,v.cachedCanvases);return C!==q.SHADING&&(p.setTransform.apply(p,v.baseTransform),this.matrix&&p.transform.apply(p,this.matrix)),p.translate(o.offsetX,o.offsetY),p.scale(o.scaleX,o.scaleY),p.createPattern(o.canvas,"no-repeat")}}class R extends U{getPattern(){return"hotpink"}}function A(i){switch(i[0]){case"RadialAxial":return new M(i);case"Mesh":return new F(i);case"Dummy":return new R}throw new Error(`Unknown IR type: ${i[0]}`)}const l={COLORED:1,UNCOLORED:2};class d{static get MAX_PATTERN_SIZE(){return(0,c.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(p,v,b,C,e){this.operatorList=p[2],this.matrix=p[3]||[1,0,0,1,0,0],this.bbox=p[4],this.xstep=p[5],this.ystep=p[6],this.paintType=p[7],this.tilingType=p[8],this.color=v,this.ctx=b,this.canvasGraphicsFactory=C,this.baseTransform=e}createPatternCanvas(p){const v=this.operatorList,b=this.bbox,C=this.xstep,e=this.ystep,o=this.paintType,_=this.tilingType,P=this.color,x=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+_);const E=b[0],k=b[1],D=b[2],$=b[3],B=c.Util.singularValueDecompose2dScale(this.matrix),z=c.Util.singularValueDecompose2dScale(this.baseTransform),K=[B[0]*z[0],B[1]*z[1]],Z=this.getSizeAndScale(C,this.ctx.canvas.width,K[0]),Y=this.getSizeAndScale(e,this.ctx.canvas.height,K[1]),et=p.cachedCanvases.getCanvas("pattern",Z.size,Y.size,!0),ot=et.context,S=x.createCanvasGraphics(ot);S.groupLevel=p.groupLevel,this.setFillAndStrokeStyleToContext(S,o,P);let a=E,s=k,f=D,t=$;return E<0&&(a=0,f+=Math.abs(E)),k<0&&(s=0,t+=Math.abs(k)),ot.translate(-(Z.scale*a),-(Y.scale*s)),S.transform(Z.scale,0,0,Y.scale,0,0),ot.save(),this.clipBbox(S,a,s,f,t),S.baseTransform=S.ctx.mozCurrentTransform.slice(),S.executeOperatorList(v),S.endDrawing(),{canvas:et.canvas,scaleX:Z.scale,scaleY:Y.scale,offsetX:a,offsetY:s}}getSizeAndScale(p,v,b){p=Math.abs(p);const C=Math.max(d.MAX_PATTERN_SIZE,v);let e=Math.ceil(p*b);return e>=C?e=C:b=e/p,{scale:b,size:e}}clipBbox(p,v,b,C,e){const o=C-v,_=e-b;p.ctx.rect(v,b,o,_),p.current.updateRectMinMax(p.ctx.mozCurrentTransform,[v,b,C,e]),p.clip(),p.endPath()}setFillAndStrokeStyleToContext(p,v,b){const C=p.ctx,e=p.current;switch(v){case l.COLORED:const o=this.ctx;C.fillStyle=o.fillStyle,C.strokeStyle=o.strokeStyle,e.fillColor=o.fillStyle,e.strokeColor=o.strokeStyle;break;case l.UNCOLORED:const _=c.Util.makeHexColor(b[0],b[1],b[2]);C.fillStyle=_,C.strokeStyle=_,e.fillColor=_,e.strokeColor=_;break;default:throw new c.FormatError(`Unsupported paint type: ${v}`)}}getPattern(p,v,b,C){let e=b;C!==q.SHADING&&(e=c.Util.transform(e,v.baseTransform),this.matrix&&(e=c.Util.transform(e,this.matrix)));const o=this.createPatternCanvas(v);let _=new DOMMatrix(e);_=_.translate(o.offsetX,o.offsetY),_=_.scale(1/o.scaleX,1/o.scaleY);const P=p.createPattern(o.canvas,"repeat");try{P.setTransform(_)}catch(x){(0,c.warn)(`TilingPattern.getPattern: "${x==null?void 0:x.message}".`)}return P}}g.TilingPattern=d},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.applyMaskImageData=Q;var c=V(1);function Q({src:q,srcPos:G=0,dest:U,destPos:M=0,width:m,height:T,inverseDecode:F=!1}){const R=c.FeatureTest.isLittleEndian?4278190080:255,[A,l]=F?[0,R]:[R,0],d=m>>3,i=m&7,p=q.length;U=new Uint32Array(U.buffer);for(let v=0;v<T;v++){for(const C=G+d;G<C;G++){const e=G<p?q[G]:255;U[M++]=e&128?l:A,U[M++]=e&64?l:A,U[M++]=e&32?l:A,U[M++]=e&16?l:A,U[M++]=e&8?l:A,U[M++]=e&4?l:A,U[M++]=e&2?l:A,U[M++]=e&1?l:A}if(i===0)continue;const b=G<p?q[G++]:255;for(let C=0;C<i;C++)U[M++]=b&1<<7-C?l:A}return{srcPos:G,destPos:M}}},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.GlobalWorkerOptions=void 0;const V=Object.create(null);g.GlobalWorkerOptions=V,V.workerPort=V.workerPort===void 0?null:V.workerPort,V.workerSrc=V.workerSrc===void 0?"":V.workerSrc},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.MessageHandler=void 0;var c=V(1);const Q={UNKNOWN:0,DATA:1,ERROR:2},q={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function G(M){switch(M instanceof Error||typeof M=="object"&&M!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),M.name){case"AbortException":return new c.AbortException(M.message);case"MissingPDFException":return new c.MissingPDFException(M.message);case"PasswordException":return new c.PasswordException(M.message,M.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(M.message,M.status);case"UnknownErrorException":return new c.UnknownErrorException(M.message,M.details);default:return new c.UnknownErrorException(M.message,M.toString())}}class U{constructor(m,T,F){this.sourceName=m,this.targetName=T,this.comObj=F,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=R=>{const A=R.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const d=A.callbackId,i=this.callbackCapabilities[d];if(!i)throw new Error(`Cannot resolve callback ${d}`);if(delete this.callbackCapabilities[d],A.callback===Q.DATA)i.resolve(A.data);else if(A.callback===Q.ERROR)i.reject(G(A.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[A.action];if(!l)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const d=this.sourceName,i=A.sourceName;new Promise(function(p){p(l(A.data))}).then(function(p){F.postMessage({sourceName:d,targetName:i,callback:Q.DATA,callbackId:A.callbackId,data:p})},function(p){F.postMessage({sourceName:d,targetName:i,callback:Q.ERROR,callbackId:A.callbackId,reason:G(p)})});return}if(A.streamId){this._createStreamSink(A);return}l(A.data)},F.addEventListener("message",this._onComObjOnMessage)}on(m,T){const F=this.actionHandler;if(F[m])throw new Error(`There is already an actionName called "${m}"`);F[m]=T}send(m,T,F){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,data:T},F)}sendWithPromise(m,T,F){const R=this.callbackId++,A=(0,c.createPromiseCapability)();this.callbackCapabilities[R]=A;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,callbackId:R,data:T},F)}catch(l){A.reject(l)}return A.promise}sendWithStream(m,T,F,R){const A=this.streamId++,l=this.sourceName,d=this.targetName,i=this.comObj;return new ReadableStream({start:p=>{const v=(0,c.createPromiseCapability)();return this.streamControllers[A]={controller:p,startCall:v,pullCall:null,cancelCall:null,isClosed:!1},i.postMessage({sourceName:l,targetName:d,action:m,streamId:A,data:T,desiredSize:p.desiredSize},R),v.promise},pull:p=>{const v=(0,c.createPromiseCapability)();return this.streamControllers[A].pullCall=v,i.postMessage({sourceName:l,targetName:d,stream:q.PULL,streamId:A,desiredSize:p.desiredSize}),v.promise},cancel:p=>{(0,c.assert)(p instanceof Error,"cancel must have a valid reason");const v=(0,c.createPromiseCapability)();return this.streamControllers[A].cancelCall=v,this.streamControllers[A].isClosed=!0,i.postMessage({sourceName:l,targetName:d,stream:q.CANCEL,streamId:A,reason:G(p)}),v.promise}},F)}_createStreamSink(m){const T=m.streamId,F=this.sourceName,R=m.sourceName,A=this.comObj,l=this,d=this.actionHandler[m.action],i={enqueue(p,v=1,b){if(this.isCancelled)return;const C=this.desiredSize;this.desiredSize-=v,C>0&&this.desiredSize<=0&&(this.sinkCapability=(0,c.createPromiseCapability)(),this.ready=this.sinkCapability.promise),A.postMessage({sourceName:F,targetName:R,stream:q.ENQUEUE,streamId:T,chunk:p},b)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:F,targetName:R,stream:q.CLOSE,streamId:T}),delete l.streamSinks[T])},error(p){(0,c.assert)(p instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:F,targetName:R,stream:q.ERROR,streamId:T,reason:G(p)}))},sinkCapability:(0,c.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:m.desiredSize,ready:null};i.sinkCapability.resolve(),i.ready=i.sinkCapability.promise,this.streamSinks[T]=i,new Promise(function(p){p(d(m.data,i))}).then(function(){A.postMessage({sourceName:F,targetName:R,stream:q.START_COMPLETE,streamId:T,success:!0})},function(p){A.postMessage({sourceName:F,targetName:R,stream:q.START_COMPLETE,streamId:T,reason:G(p)})})}_processStreamMessage(m){const T=m.streamId,F=this.sourceName,R=m.sourceName,A=this.comObj,l=this.streamControllers[T],d=this.streamSinks[T];switch(m.stream){case q.START_COMPLETE:m.success?l.startCall.resolve():l.startCall.reject(G(m.reason));break;case q.PULL_COMPLETE:m.success?l.pullCall.resolve():l.pullCall.reject(G(m.reason));break;case q.PULL:if(!d){A.postMessage({sourceName:F,targetName:R,stream:q.PULL_COMPLETE,streamId:T,success:!0});break}d.desiredSize<=0&&m.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=m.desiredSize,new Promise(function(i){i(d.onPull&&d.onPull())}).then(function(){A.postMessage({sourceName:F,targetName:R,stream:q.PULL_COMPLETE,streamId:T,success:!0})},function(i){A.postMessage({sourceName:F,targetName:R,stream:q.PULL_COMPLETE,streamId:T,reason:G(i)})});break;case q.ENQUEUE:if((0,c.assert)(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(m.chunk);break;case q.CLOSE:if((0,c.assert)(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this._deleteStreamController(l,T);break;case q.ERROR:(0,c.assert)(l,"error should have stream controller"),l.controller.error(G(m.reason)),this._deleteStreamController(l,T);break;case q.CANCEL_COMPLETE:m.success?l.cancelCall.resolve():l.cancelCall.reject(G(m.reason)),this._deleteStreamController(l,T);break;case q.CANCEL:if(!d)break;new Promise(function(i){i(d.onCancel&&d.onCancel(G(m.reason)))}).then(function(){A.postMessage({sourceName:F,targetName:R,stream:q.CANCEL_COMPLETE,streamId:T,success:!0})},function(i){A.postMessage({sourceName:F,targetName:R,stream:q.CANCEL_COMPLETE,streamId:T,reason:G(i)})}),d.sinkCapability.reject(G(m.reason)),d.isCancelled=!0,delete this.streamSinks[T];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(m,T){await Promise.allSettled([m.startCall&&m.startCall.promise,m.pullCall&&m.pullCall.promise,m.cancelCall&&m.cancelCall.promise]),delete this.streamControllers[T]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}g.MessageHandler=U},(J,g,V)=>{var q,G;Object.defineProperty(g,"__esModule",{value:!0}),g.Metadata=void 0;var c=V(1);class Q{constructor({parsedData:M,rawData:m}){xt(this,q,void 0);xt(this,G,void 0);Pt(this,q,M),Pt(this,G,m)}getRaw(){return ut(this,G)}get(M){var m;return(m=ut(this,q).get(M))!=null?m:null}getAll(){return(0,c.objectFromMap)(ut(this,q))}has(M){return ut(this,q).has(M)}}q=new WeakMap,G=new WeakMap,g.Metadata=Q},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.OptionalContentConfig=void 0;var c=V(1);class Q{constructor(U,M){this.visible=!0,this.name=U,this.intent=M}}class q{constructor(U){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,U!==null){this.name=U.name,this.creator=U.creator,this._order=U.order;for(const M of U.groups)this._groups.set(M.id,new Q(M.name,M.intent));if(U.baseState==="OFF")for(const M of this._groups)M.visible=!1;for(const M of U.on)this._groups.get(M).visible=!0;for(const M of U.off)this._groups.get(M).visible=!1}}_evaluateVisibilityExpression(U){const M=U.length;if(M<2)return!0;const m=U[0];for(let T=1;T<M;T++){const F=U[T];let R;if(Array.isArray(F))R=this._evaluateVisibilityExpression(F);else if(this._groups.has(F))R=this._groups.get(F).visible;else return(0,c.warn)(`Optional content group not found: ${F}`),!0;switch(m){case"And":if(!R)return!1;break;case"Or":if(R)return!0;break;case"Not":return!R;default:return!0}}return m==="And"}isVisible(U){if(this._groups.size===0)return!0;if(!U)return(0,c.warn)("Optional content group not defined."),!0;if(U.type==="OCG")return this._groups.has(U.id)?this._groups.get(U.id).visible:((0,c.warn)(`Optional content group not found: ${U.id}`),!0);if(U.type==="OCMD"){if(U.expression)return this._evaluateVisibilityExpression(U.expression);if(!U.policy||U.policy==="AnyOn"){for(const M of U.ids){if(!this._groups.has(M))return(0,c.warn)(`Optional content group not found: ${M}`),!0;if(this._groups.get(M).visible)return!0}return!1}else if(U.policy==="AllOn"){for(const M of U.ids){if(!this._groups.has(M))return(0,c.warn)(`Optional content group not found: ${M}`),!0;if(!this._groups.get(M).visible)return!1}return!0}else if(U.policy==="AnyOff"){for(const M of U.ids){if(!this._groups.has(M))return(0,c.warn)(`Optional content group not found: ${M}`),!0;if(!this._groups.get(M).visible)return!0}return!1}else if(U.policy==="AllOff"){for(const M of U.ids){if(!this._groups.has(M))return(0,c.warn)(`Optional content group not found: ${M}`),!0;if(this._groups.get(M).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${U.policy}.`),!0}return(0,c.warn)(`Unknown group type ${U.type}.`),!0}setVisibility(U,M=!0){if(!this._groups.has(U)){(0,c.warn)(`Optional content group not found: ${U}`);return}this._groups.get(U).visible=!!M}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,c.objectFromMap)(this._groups):null}getGroup(U){return this._groups.get(U)||null}}g.OptionalContentConfig=q},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFDataTransportStream=void 0;var c=V(1),Q=V(5);class q{constructor(m,T){(0,c.assert)(T,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=m.progressiveDone||!1,this._contentDispositionFilename=m.contentDispositionFilename||null;const F=m.initialData;if((F==null?void 0:F.length)>0){const R=new Uint8Array(F).buffer;this._queuedChunks.push(R)}this._pdfDataRangeTransport=T,this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._contentLength=m.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((R,A)=>{this._onReceiveData({begin:R,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((R,A)=>{this._onProgress({loaded:R,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(R=>{this._onReceiveData({chunk:R})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(m){const T=new Uint8Array(m.chunk).buffer;if(m.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(T):this._queuedChunks.push(T);else{const F=this._rangeReaders.some(function(R){return R._begin!==m.begin?!1:(R._enqueue(T),!0)});(0,c.assert)(F,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var m,T;return(T=(m=this._fullRequestReader)==null?void 0:m._loaded)!=null?T:0}_onProgress(m){if(m.total===void 0){const T=this._rangeReaders[0];T!=null&&T.onProgress&&T.onProgress({loaded:m.loaded})}else{const T=this._fullRequestReader;T!=null&&T.onProgress&&T.onProgress({loaded:m.loaded,total:m.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(m){const T=this._rangeReaders.indexOf(m);T>=0&&this._rangeReaders.splice(T,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const m=this._queuedChunks;return this._queuedChunks=null,new G(this,m,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(m,T){if(T<=this._progressiveDataLength)return null;const F=new U(this,m,T);return this._pdfDataRangeTransport.requestDataRange(m,T),this._rangeReaders.push(F),F}cancelAllRequests(m){this._fullRequestReader&&this._fullRequestReader.cancel(m);for(const T of this._rangeReaders.slice(0))T.cancel(m);this._pdfDataRangeTransport.abort()}}g.PDFDataTransportStream=q;class G{constructor(m,T,F=!1,R=null){this._stream=m,this._done=F||!1,this._filename=(0,Q.isPdfFile)(R)?R:null,this._queuedChunks=T||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),m._fullRequestReader=this,this.onProgress=null}_enqueue(m){this._done||(this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunks.push(m),this._loaded+=m.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=(0,c.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const T of this._requests)T.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class U{constructor(m,T,F){this._stream=m,this._begin=T,this._end=F,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(m){if(!this._done){if(this._requests.length===0)this._queuedChunk=m;else{this._requests.shift().resolve({value:m,done:!1});for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const T=this._queuedChunk;return this._queuedChunk=null,{value:T,done:!1}}if(this._done)return{value:void 0,done:!0};const m=(0,c.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const T of this._requests)T.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.XfaText=void 0;class V{static textContent(Q){const q=[],G={items:q,styles:Object.create(null)};function U(M){var F;if(!M)return;let m=null;const T=M.name;if(T==="#text")m=M.value;else if(V.shouldBuildText(T))(F=M==null?void 0:M.attributes)!=null&&F.textContent?m=M.attributes.textContent:M.value&&(m=M.value);else return;if(m!==null&&q.push({str:m}),!!M.children)for(const R of M.children)U(R)}return U(Q),G}static shouldBuildText(Q){return!(Q==="textarea"||Q==="input"||Q==="option"||Q==="select")}}g.XfaText=V},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.NodeStandardFontDataFactory=g.NodeCanvasFactory=g.NodeCMapReaderFactory=void 0;var c=V(6);const Q=function(M){return new Promise((m,T)=>{require$$5.readFile(M,(R,A)=>{if(R||!A){T(new Error(R));return}m(new Uint8Array(A))})})};class q extends c.BaseCanvasFactory{_createCanvas(m,T){return require$$5.createCanvas(m,T)}}g.NodeCanvasFactory=q;class G extends c.BaseCMapReaderFactory{_fetchData(m,T){return Q(m).then(F=>({cMapData:F,compressionType:T}))}}g.NodeCMapReaderFactory=G;class U extends c.BaseStandardFontDataFactory{_fetchData(m){return Q(m)}}g.NodeStandardFontDataFactory=U},(J,g,V)=>{var a,Vt;Object.defineProperty(g,"__esModule",{value:!0}),g.AnnotationLayer=void 0;var c=V(1),Q=V(5),q=V(8),G=V(21),U=V(22);const M=1e3,m=new WeakSet;function T(f){return{width:f[2]-f[0],height:f[3]-f[1]}}class F{static create(t){switch(t.data.annotationType){case c.AnnotationType.LINK:return new A(t);case c.AnnotationType.TEXT:return new l(t);case c.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new i(t);case"Btn":return t.data.radioButton?new v(t):t.data.checkBox?new p(t):new b(t);case"Ch":return new C(t)}return new d(t);case c.AnnotationType.POPUP:return new e(t);case c.AnnotationType.FREETEXT:return new _(t);case c.AnnotationType.LINE:return new P(t);case c.AnnotationType.SQUARE:return new x(t);case c.AnnotationType.CIRCLE:return new E(t);case c.AnnotationType.POLYLINE:return new k(t);case c.AnnotationType.CARET:return new $(t);case c.AnnotationType.INK:return new B(t);case c.AnnotationType.POLYGON:return new D(t);case c.AnnotationType.HIGHLIGHT:return new z(t);case c.AnnotationType.UNDERLINE:return new K(t);case c.AnnotationType.SQUIGGLY:return new Z(t);case c.AnnotationType.STRIKEOUT:return new Y(t);case c.AnnotationType.STAMP:return new et(t);case c.AnnotationType.FILEATTACHMENT:return new ot(t);default:return new R(t)}}}class R{constructor(t,{isRenderable:n=!1,ignoreBorder:r=!1,createQuadrilaterals:u=!1}={}){this.isRenderable=n,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,n&&(this.container=this._createContainer(r)),u&&(this.quadrilaterals=this._createQuadrilaterals(r))}_createContainer(t=!1){const n=this.data,r=this.page,u=this.viewport,h=document.createElement("section");let{width:y,height:w}=T(n.rect);h.setAttribute("data-annotation-id",n.id);const N=c.Util.normalizeRect([n.rect[0],r.view[3]-n.rect[1]+r.view[1],n.rect[2],r.view[3]-n.rect[3]+r.view[1]]);if(n.hasOwnCanvas){const O=u.transform.slice(),[W,L]=c.Util.singularValueDecompose2dScale(O);y=Math.ceil(y*W),w=Math.ceil(w*L),N[0]*=W,N[1]*=L;for(let X=0;X<4;X++)O[X]=Math.sign(O[X]);h.style.transform=`matrix(${O.join(",")})`}else h.style.transform=`matrix(${u.transform.join(",")})`;if(h.style.transformOrigin=`${-N[0]}px ${-N[1]}px`,!t&&n.borderStyle.width>0){h.style.borderWidth=`${n.borderStyle.width}px`,n.borderStyle.style!==c.AnnotationBorderStyleType.UNDERLINE&&(y-=2*n.borderStyle.width,w-=2*n.borderStyle.width);const O=n.borderStyle.horizontalCornerRadius,W=n.borderStyle.verticalCornerRadius;if(O>0||W>0){const X=`${O}px / ${W}px`;h.style.borderRadius=X}switch(n.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:h.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:h.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:h.style.borderBottomStyle="solid";break}n.borderColor||n.color||null?h.style.borderColor=c.Util.makeHexColor(n.color[0]|0,n.color[1]|0,n.color[2]|0):h.style.borderWidth=0}return h.style.left=`${N[0]}px`,h.style.top=`${N[1]}px`,n.hasOwnCanvas?h.style.width=h.style.height="auto":(h.style.width=`${y}px`,h.style.height=`${w}px`),h}get _commonActions(){const t=(n,r,u)=>{const h=u.detail[n];u.target.style[r]=G.ColorConverters[`${h[0]}_HTML`](h.slice(1))};return(0,c.shadow)(this,"_commonActions",{display:n=>{const r=n.detail.display%2===1;n.target.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:r,print:n.detail.display===0||n.detail.display===3})},print:n=>{this.annotationStorage.setValue(this.data.id,{print:n.detail.print})},hidden:n=>{n.target.style.visibility=n.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:n.detail.hidden})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.detail.readonly?n.target.setAttribute("readonly",""):n.target.removeAttribute("readonly")},required:n=>{n.detail.required?n.target.setAttribute("required",""):n.target.removeAttribute("required")},bgColor:n=>{t("bgColor","backgroundColor",n)},fillColor:n=>{t("fillColor","backgroundColor",n)},fgColor:n=>{t("fgColor","color",n)},textColor:n=>{t("textColor","color",n)},borderColor:n=>{t("borderColor","borderColor",n)},strokeColor:n=>{t("strokeColor","borderColor",n)}})}_dispatchEventFromSandbox(t,n){const r=this._commonActions;for(const u of Object.keys(n.detail)){const h=t[u]||r[u];h&&h(n)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const r=this._commonActions;for(const[u,h]of Object.entries(n)){const y=r[u];y&&(y({detail:h,target:t}),delete n[u])}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const n=[],r=this.data.rect;for(const u of this.data.quadPoints)this.data.rect=[u[2].x,u[2].y,u[1].x,u[1].y],n.push(this._createContainer(t));return this.data.rect=r,n}_createPopup(t,n){let r=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,r=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.style.height=r.style.height,t.style.width=r.style.width,r.appendChild(t));const h=new o({container:r,trigger:t,color:n.color,titleObj:n.titleObj,modificationDate:n.modificationDate,contentsObj:n.contentsObj,richText:n.richText,hideWrapper:!0}).render();h.style.left=r.style.width,r.appendChild(h)}_renderQuadrilaterals(t){for(const n of this.quadrilaterals)n.className=t;return this.quadrilaterals}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,n=null){const r=[];if(this._fieldObjects){const u=this._fieldObjects[t];if(u)for(const{page:h,id:y,exportValues:w}of u){if(h===-1||y===n)continue;const N=typeof w=="string"?w:null,O=document.getElementById(y);if(O&&!m.has(O)){(0,c.warn)(`_getElementsByName - element not allowed: ${y}`);continue}r.push({id:y,exportValue:N,domElement:O})}return r}for(const u of document.getElementsByName(t)){const{id:h,exportValue:y}=u;h!==n&&(!m.has(u)||r.push({id:h,exportValue:y,domElement:u}))}return r}static get platform(){const t=typeof navigator<"u"?navigator.platform:"";return(0,c.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class A extends R{constructor(t,n=null){const r=!!(t.data.url||t.data.dest||t.data.action||t.data.isTooltipOnly||t.data.resetForm||t.data.actions&&(t.data.actions.Action||t.data.actions["Mouse Up"]||t.data.actions["Mouse Down"]));super(t,{isRenderable:r,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0})}render(){const{data:t,linkService:n}=this,r=document.createElement("a");if(t.url)n.addLinkAttributes(r,t.url,t.newWindow);else if(t.action)this._bindNamedAction(r,t.action);else if(t.dest)this._bindLink(r,t.dest);else{let u=!1;t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(u=!0,this._bindJSAction(r,t)),t.resetForm?this._bindResetFormAction(r,t.resetForm):u||this._bindLink(r,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((u,h)=>{const y=h===0?r:r.cloneNode();return u.appendChild(y),u}):(this.container.className="linkAnnotation",this.container.appendChild(r),this.container)}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&(t.className="internalLink")}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),t.className="internalLink"}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const u of Object.keys(n.actions)){const h=r.get(u);!h||(t[h]=()=>{var y;return(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:u}}),!1})}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,n){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var W;r&&r();const{fields:u,refs:h,include:y}=n,w=[];if(u.length!==0||h.length!==0){const L=new Set(h);for(const X of u){const st=this._fieldObjects[X]||[];for(const{id:rt}of st)L.add(rt)}for(const X of Object.values(this._fieldObjects))for(const st of X)L.has(st.id)===y&&w.push(st)}else for(const L of Object.values(this._fieldObjects))w.push(...L);const N=this.annotationStorage,O=[];for(const L of w){const{id:X}=L;switch(O.push(X),L.type){case"text":{const rt=L.defaultValue||"";N.setValue(X,{value:rt});break}case"checkbox":case"radiobutton":{const rt=L.defaultValue===L.exportValues;N.setValue(X,{value:rt});break}case"combobox":case"listbox":{const rt=L.defaultValue||"";N.setValue(X,{value:rt});break}default:continue}const st=document.getElementById(X);!st||!m.has(st)||st.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:O,name:"ResetForm"}})),!1}}}class l extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.appendChild(t),this.container}}class d extends R{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:n,isMac:r}=R.platform;return n&&t.ctrlKey||r&&t.metaKey}_setEventListener(t,n,r,u){n.includes("mouse")?t.addEventListener(n,h=>{var y;(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:u(h),shift:h.shiftKey,modifier:this._getKeyModifier(h)}})}):t.addEventListener(n,h=>{var y;(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:u(h)}})})}_setEventListeners(t,n,r){var u;for(const[h,y]of n)(y==="Action"||((u=this.data.actions)==null?void 0:u[y]))&&this._setEventListener(t,h,y,r)}_setBackgroundColor(t){const n=this.data.backgroundColor||null;t.style.backgroundColor=n===null?"transparent":c.Util.makeHexColor(n[0],n[1],n[2])}}class i extends d{constructor(t){const n=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:n})}setPropertyOnSiblings(t,n,r,u){const h=this.annotationStorage;for(const y of this._getElementsByName(t.name,t.id))y.domElement&&(y.domElement[n]=r),h.setValue(y.id,{[u]:r})}render(){var u;const t=this.annotationStorage,n=this.data.id;this.container.className="textWidgetAnnotation";let r=null;if(this.renderForms){const h=t.getValue(n,{value:this.data.fieldValue}),y=h.formattedValue||h.value||"",w={userValue:null,formattedValue:null,valueOnFocus:""};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=y):(r=document.createElement("input"),r.type="text",r.setAttribute("value",y)),m.add(r),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=M,w.userValue=y,r.setAttribute("id",n),r.addEventListener("input",O=>{t.setValue(n,{value:O.target.value}),this.setPropertyOnSiblings(r,"value",O.target.value,"value")}),r.addEventListener("resetform",O=>{var L;const W=(L=this.data.defaultFieldValue)!=null?L:"";r.value=w.userValue=W,w.formattedValue=null});let N=O=>{const{formattedValue:W}=w;W!=null&&(O.target.value=W),O.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",W=>{w.userValue&&(W.target.value=w.userValue),w.valueOnFocus=W.target.value}),r.addEventListener("updatefromsandbox",W=>{const L={value(X){var st;w.userValue=(st=X.detail.value)!=null?st:"",t.setValue(n,{value:w.userValue.toString()}),X.target.value=w.userValue},formattedValue(X){const{formattedValue:st}=X.detail;w.formattedValue=st,st!=null&&X.target!==document.activeElement&&(X.target.value=st),t.setValue(n,{formattedValue:st})},selRange(X){X.target.setSelectionRange(...X.detail.selRange)}};this._dispatchEventFromSandbox(L,W)}),r.addEventListener("keydown",W=>{var st;let L=-1;if(W.key==="Escape"?L=0:W.key==="Enter"?L=2:W.key==="Tab"&&(L=3),L===-1)return;const{value:X}=W.target;w.valueOnFocus!==X&&(w.userValue=X,(st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:X,willCommit:!0,commitKey:L,selStart:W.target.selectionStart,selEnd:W.target.selectionEnd}}))});const O=N;N=null,r.addEventListener("blur",W=>{var X;const{value:L}=W.target;w.userValue=L,this._mouseState.isDown&&w.valueOnFocus!==L&&((X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:L,willCommit:!0,commitKey:1,selStart:W.target.selectionStart,selEnd:W.target.selectionEnd}})),O(W)}),(u=this.data.actions)!=null&&u.Keystroke&&r.addEventListener("beforeinput",W=>{var ct;const{data:L,target:X}=W,{value:st,selectionStart:rt,selectionEnd:it}=X;let tt=rt,lt=it;switch(W.inputType){case"deleteWordBackward":{const nt=st.substring(0,rt).match(/\w*[^\w]*$/);nt&&(tt-=nt[0].length);break}case"deleteWordForward":{const nt=st.substring(rt).match(/^[^\w]*\w*/);nt&&(lt+=nt[0].length);break}case"deleteContentBackward":rt===it&&(tt-=1);break;case"deleteContentForward":rt===it&&(lt+=1);break}W.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:st,change:L||"",willCommit:!1,selStart:tt,selEnd:lt}})}),this._setEventListeners(r,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],W=>W.target.value)}if(N&&r.addEventListener("blur",N),this.data.maxLen!==null&&(r.maxLength=this.data.maxLen),this.data.comb){const W=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;r.classList.add("comb"),r.style.letterSpacing=`calc(${W}px - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell";return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.appendChild(r),this.container}_setTextStyle(t){const n=["left","center","right"],{fontSize:r,fontColor:u}=this.data.defaultAppearanceData,h=t.style;r&&(h.fontSize=`${r}px`),h.color=c.Util.makeHexColor(u[0],u[1],u[2]),this.data.textAlignment!==null&&(h.textAlign=n[this.data.textAlignment])}}class p extends d{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,n=this.data,r=n.id;let u=t.getValue(r,{value:n.exportValue===n.fieldValue}).value;typeof u=="string"&&(u=u!=="Off",t.setValue(r,{value:u})),this.container.className="buttonWidgetAnnotation checkBox";const h=document.createElement("input");return m.add(h),h.disabled=n.readOnly,h.type="checkbox",h.name=n.fieldName,u&&h.setAttribute("checked",!0),h.setAttribute("id",r),h.setAttribute("exportValue",n.exportValue),h.tabIndex=M,h.addEventListener("change",y=>{const{name:w,checked:N}=y.target;for(const O of this._getElementsByName(w,r)){const W=N&&O.exportValue===n.exportValue;O.domElement&&(O.domElement.checked=W),t.setValue(O.id,{value:W})}t.setValue(r,{value:N})}),h.addEventListener("resetform",y=>{const w=n.defaultFieldValue||"Off";y.target.checked=w===n.exportValue}),this.enableScripting&&this.hasJSActions&&(h.addEventListener("updatefromsandbox",y=>{const w={value(N){N.target.checked=N.detail.value!=="Off",t.setValue(r,{value:N.target.checked})}};this._dispatchEventFromSandbox(w,y)}),this._setEventListeners(h,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.checked)),this._setBackgroundColor(h),this._setDefaultPropertiesFromJS(h),this.container.appendChild(h),this.container}}class v extends d{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,n=this.data,r=n.id;let u=t.getValue(r,{value:n.fieldValue===n.buttonValue}).value;typeof u=="string"&&(u=u!==n.buttonValue,t.setValue(r,{value:u}));const h=document.createElement("input");if(m.add(h),h.disabled=n.readOnly,h.type="radio",h.name=n.fieldName,u&&h.setAttribute("checked",!0),h.setAttribute("id",r),h.tabIndex=M,h.addEventListener("change",y=>{const{name:w,checked:N}=y.target;for(const O of this._getElementsByName(w,r))t.setValue(O.id,{value:!1});t.setValue(r,{value:N})}),h.addEventListener("resetform",y=>{const w=n.defaultFieldValue;y.target.checked=w!=null&&w===n.buttonValue}),this.enableScripting&&this.hasJSActions){const y=n.buttonValue;h.addEventListener("updatefromsandbox",w=>{const N={value:O=>{const W=y===O.detail.value;for(const L of this._getElementsByName(O.target.name)){const X=W&&L.id===r;L.domElement&&(L.domElement.checked=X),t.setValue(L.id,{value:X})}}};this._dispatchEventFromSandbox(N,w)}),this._setEventListeners(h,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.checked)}return this._setBackgroundColor(h),this._setDefaultPropertiesFromJS(h),this.container.appendChild(h),this.container}}class b extends A{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();return t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText),this._setDefaultPropertiesFromJS(t),t}}class C extends d{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,n=this.data.id,r=t.getValue(n,{value:this.data.fieldValue});let{fontSize:u}=this.data.defaultAppearanceData;u||(u=9);const h=`calc(${u}px * var(--zoom-factor))`,y=document.createElement("select");m.add(y),y.disabled=this.data.readOnly,y.name=this.data.fieldName,y.setAttribute("id",n),y.tabIndex=M,y.style.fontSize=`${u}px`,this.data.combo||(y.size=this.data.options.length,this.data.multiSelect&&(y.multiple=!0)),y.addEventListener("resetform",O=>{const W=this.data.defaultFieldValue;for(const L of y.options)L.selected=L.value===W});for(const O of this.data.options){const W=document.createElement("option");W.textContent=O.displayValue,W.value=O.exportValue,this.data.combo&&(W.style.fontSize=h),r.value.includes(O.exportValue)&&W.setAttribute("selected",!0),y.appendChild(W)}const w=(O,W)=>{const L=W?"value":"textContent",X=O.target.options;return O.target.multiple?Array.prototype.filter.call(X,st=>st.selected).map(st=>st[L]):X.selectedIndex===-1?null:X[X.selectedIndex][L]},N=O=>{const W=O.target.options;return Array.prototype.map.call(W,L=>({displayValue:L.textContent,exportValue:L.value}))};return this.enableScripting&&this.hasJSActions?(y.addEventListener("updatefromsandbox",O=>{const W={value(L){const X=L.detail.value,st=new Set(Array.isArray(X)?X:[X]);for(const rt of y.options)rt.selected=st.has(rt.value);t.setValue(n,{value:w(L,!0)})},multipleSelection(L){y.multiple=!0},remove(L){const X=y.options,st=L.detail.remove;X[st].selected=!1,y.remove(st),X.length>0&&Array.prototype.findIndex.call(X,it=>it.selected)===-1&&(X[0].selected=!0),t.setValue(n,{value:w(L,!0),items:N(L)})},clear(L){for(;y.length!==0;)y.remove(0);t.setValue(n,{value:null,items:[]})},insert(L){const{index:X,displayValue:st,exportValue:rt}=L.detail.insert,it=document.createElement("option");it.textContent=st,it.value=rt,y.insertBefore(it,y.children[X]),t.setValue(n,{value:w(L,!0),items:N(L)})},items(L){const{items:X}=L.detail;for(;y.length!==0;)y.remove(0);for(const st of X){const{displayValue:rt,exportValue:it}=st,tt=document.createElement("option");tt.textContent=rt,tt.value=it,y.appendChild(tt)}y.options.length>0&&(y.options[0].selected=!0),t.setValue(n,{value:w(L,!0),items:N(L)})},indices(L){const X=new Set(L.detail.indices);for(const st of L.target.options)st.selected=X.has(st.index);t.setValue(n,{value:w(L,!0)})},editable(L){L.target.disabled=!L.detail.editable}};this._dispatchEventFromSandbox(W,O)}),y.addEventListener("input",O=>{var X;const W=w(O,!0),L=w(O,!1);t.setValue(n,{value:W}),(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:L,changeEx:W,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(y,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],O=>O.target.checked)):y.addEventListener("input",function(O){t.setValue(n,{value:w(O,!0)})}),this._setBackgroundColor(y),this._setDefaultPropertiesFromJS(y),this.container.appendChild(y),this.container}}class e extends R{constructor(t){var r,u,h;const n=!!(((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n})}render(){const t=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",t.includes(this.data.parentType))return this.container;const n=`[data-annotation-id="${this.data.parentId}"]`,r=this.layer.querySelectorAll(n);if(r.length===0)return this.container;const u=new o({container:this.container,trigger:Array.from(r),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),h=this.page,y=c.Util.normalizeRect([this.data.parentRect[0],h.view[3]-this.data.parentRect[1]+h.view[1],this.data.parentRect[2],h.view[3]-this.data.parentRect[3]+h.view[1]]),w=y[0]+this.data.parentRect[2]-this.data.parentRect[0],N=y[1];return this.container.style.transformOrigin=`${-w}px ${-N}px`,this.container.style.left=`${w}px`,this.container.style.top=`${N}px`,this.container.appendChild(u.render()),this.container}}class o{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){var w,N;const n=document.createElement("div");n.className="popupWrapper",this.hideElement=this.hideWrapper?n:this.container,this.hideElement.hidden=!0;const r=document.createElement("div");r.className="popup";const u=this.color;if(u){const O=.7*(255-u[0])+u[0],W=.7*(255-u[1])+u[1],L=.7*(255-u[2])+u[2];r.style.backgroundColor=c.Util.makeHexColor(O|0,W|0,L|0)}const h=document.createElement("h1");h.dir=this.titleObj.dir,h.textContent=this.titleObj.str,r.appendChild(h);const y=Q.PDFDateString.toDateObject(this.modificationDate);if(y){const O=document.createElement("span");O.className="popupDate",O.textContent="{{date}}, {{time}}",O.dataset.l10nId="annotation_date_string",O.dataset.l10nArgs=JSON.stringify({date:y.toLocaleDateString(),time:y.toLocaleTimeString()}),r.appendChild(O)}if(((w=this.richText)==null?void 0:w.str)&&(!((N=this.contentsObj)!=null&&N.str)||this.contentsObj.str===this.richText.str))U.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:r}),r.lastChild.className="richText popupContent";else{const O=this._formatContents(this.contentsObj);r.appendChild(O)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const O of this.trigger)O.addEventListener("click",this._toggle.bind(this)),O.addEventListener("mouseover",this._show.bind(this,!1)),O.addEventListener("mouseout",this._hide.bind(this,!1));return r.addEventListener("click",this._hide.bind(this,!0)),n.appendChild(r),n}_formatContents({str:t,dir:n}){const r=document.createElement("p");r.className="popupContent",r.dir=n;const u=t.split(/(?:\r\n?|\n)/);for(let h=0,y=u.length;h<y;++h){const w=u[h];r.appendChild(document.createTextNode(w)),h<y-1&&r.appendChild(document.createElement("br"))}return r}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class _ extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class P extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:n,height:r}=T(t.rect),u=this.svgFactory.create(n,r),h=this.svgFactory.createElement("svg:line");return h.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),h.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),h.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),h.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),h.setAttribute("stroke-width",t.borderStyle.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),u.appendChild(h),this.container.append(u),this._createPopup(h,t),this.container}}class x extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:n,height:r}=T(t.rect),u=this.svgFactory.create(n,r),h=t.borderStyle.width,y=this.svgFactory.createElement("svg:rect");return y.setAttribute("x",h/2),y.setAttribute("y",h/2),y.setAttribute("width",n-h),y.setAttribute("height",r-h),y.setAttribute("stroke-width",h||1),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),u.appendChild(y),this.container.append(u),this._createPopup(y,t),this.container}}class E extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:n,height:r}=T(t.rect),u=this.svgFactory.create(n,r),h=t.borderStyle.width,y=this.svgFactory.createElement("svg:ellipse");return y.setAttribute("cx",n/2),y.setAttribute("cy",r/2),y.setAttribute("rx",n/2-h/2),y.setAttribute("ry",r/2-h/2),y.setAttribute("stroke-width",h||1),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),u.appendChild(y),this.container.append(u),this._createPopup(y,t),this.container}}class k extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:n,height:r}=T(t.rect),u=this.svgFactory.create(n,r);let h=[];for(const w of t.vertices){const N=w.x-t.rect[0],O=t.rect[3]-w.y;h.push(N+","+O)}h=h.join(" ");const y=this.svgFactory.createElement(this.svgElementName);return y.setAttribute("points",h),y.setAttribute("stroke-width",t.borderStyle.width||1),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),u.appendChild(y),this.container.append(u),this._createPopup(y,t),this.container}}class D extends k{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class B extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:n,height:r}=T(t.rect),u=this.svgFactory.create(n,r);for(const h of t.inkLists){let y=[];for(const N of h){const O=N.x-t.rect[0],W=t.rect[3]-N.y;y.push(`${O},${W}`)}y=y.join(" ");const w=this.svgFactory.createElement(this.svgElementName);w.setAttribute("points",y),w.setAttribute("stroke-width",t.borderStyle.width||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),this._createPopup(w,t),u.appendChild(w)}return this.container.append(u),this.container}}class z extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class K extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Z extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class Y extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class et extends R{constructor(t){var r,u,h;const n=!!(t.data.hasPopup||((r=t.data.titleObj)==null?void 0:r.str)||((u=t.data.contentsObj)==null?void 0:u.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ot extends R{constructor(t){var u;super(t,{isRenderable:!0});const{filename:n,content:r}=this.data.file;this.filename=(0,Q.getFilenameFromUrl)(n),this.content=r,(u=this.linkService.eventBus)==null||u.dispatch("fileattachmentannotation",{source:this,filename:n,content:r})}render(){var n,r;this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((n=this.data.titleObj)==null?void 0:n.str)||((r=this.data.contentsObj)==null?void 0:r.str)||this.data.richText)&&this._createPopup(t,this.data),this.container.appendChild(t),this.container}_download(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.container,this.content,this.filename)}}class S{static render(t){const n=[],r=[];for(const h of t.annotations){if(!h)continue;const{width:y,height:w}=T(h.rect);if(!(y<=0||w<=0)){if(h.annotationType===c.AnnotationType.POPUP){r.push(h);continue}n.push(h)}}r.length&&n.push(...r);const u=t.div;for(const h of n){const y=F.create({data:h,layer:u,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Q.DOMSVGFactory,annotationStorage:t.annotationStorage||new q.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(y.isRenderable){const w=y.render();if(h.hidden&&(w.style.visibility="hidden"),Array.isArray(w))for(const N of w)u.appendChild(N);else y instanceof e?u.prepend(w):u.appendChild(w)}}Lt(this,a,Vt).call(this,u,t.annotationCanvasMap)}static update(t){const{page:n,viewport:r,annotations:u,annotationCanvasMap:h,div:y}=t,w=r.transform,N=`matrix(${w.join(",")})`;let O,W;for(const L of u){const X=y.querySelectorAll(`[data-annotation-id="${L.id}"]`);if(X)for(const st of X)if(L.hasOwnCanvas){const rt=c.Util.normalizeRect([L.rect[0],n.view[3]-L.rect[1]+n.view[1],L.rect[2],n.view[3]-L.rect[3]+n.view[1]]);if(!W){O=Math.abs(w[0]||w[1]);const lt=w.slice();for(let ct=0;ct<4;ct++)lt[ct]=Math.sign(lt[ct]);W=`matrix(${lt.join(",")})`}const it=rt[0]*O,tt=rt[1]*O;st.style.left=`${it}px`,st.style.top=`${tt}px`,st.style.transformOrigin=`${-it}px ${-tt}px`,st.style.transform=W}else st.style.transform=N}Lt(this,a,Vt).call(this,y,h),y.hidden=!1}}a=new WeakSet,Vt=function(t,n){if(!!n){for(const[r,u]of n){const h=t.querySelector(`[data-annotation-id="${r}"]`);if(!h)continue;const{firstChild:y}=h;y.nodeName==="CANVAS"?h.replaceChild(u,y):h.insertBefore(u,y)}n.clear()}},xt(S,a),g.AnnotationLayer=S},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ColorConverters=void 0;function V(Q){return Math.floor(Math.max(0,Math.min(1,Q))*255).toString(16).padStart(2,"0")}class c{static CMYK_G([q,G,U,M]){return["G",1-Math.min(1,.3*q+.59*U+.11*G+M)]}static G_CMYK([q]){return["CMYK",0,0,0,1-q]}static G_RGB([q]){return["RGB",q,q,q]}static G_HTML([q]){const G=V(q);return`#${G}${G}${G}`}static RGB_G([q,G,U]){return["G",.3*q+.59*G+.11*U]}static RGB_HTML([q,G,U]){const M=V(q),m=V(G),T=V(U);return`#${M}${m}${T}`}static T_HTML(){return"#00000000"}static CMYK_RGB([q,G,U,M]){return["RGB",1-Math.min(1,q+M),1-Math.min(1,U+M),1-Math.min(1,G+M)]}static CMYK_HTML(q){return this.RGB_HTML(this.CMYK_RGB(q))}static RGB_CMYK([q,G,U]){const M=1-q,m=1-G,T=1-U,F=Math.min(M,m,T);return["CMYK",M,m,T,F]}}g.ColorConverters=c},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.XfaLayer=void 0;var c=V(18);class Q{static setupStorage(G,U,M,m,T){const F=m.getValue(U,{value:null});switch(M.name){case"textarea":if(F.value!==null&&(G.textContent=F.value),T==="print")break;G.addEventListener("input",R=>{m.setValue(U,{value:R.target.value})});break;case"input":if(M.attributes.type==="radio"||M.attributes.type==="checkbox"){if(F.value===M.attributes.xfaOn?G.setAttribute("checked",!0):F.value===M.attributes.xfaOff&&G.removeAttribute("checked"),T==="print")break;G.addEventListener("change",R=>{m.setValue(U,{value:R.target.checked?R.target.getAttribute("xfaOn"):R.target.getAttribute("xfaOff")})})}else{if(F.value!==null&&G.setAttribute("value",F.value),T==="print")break;G.addEventListener("input",R=>{m.setValue(U,{value:R.target.value})})}break;case"select":if(F.value!==null)for(const R of M.children)R.attributes.value===F.value&&(R.attributes.selected=!0);G.addEventListener("input",R=>{const A=R.target.options,l=A.selectedIndex===-1?"":A[A.selectedIndex].value;m.setValue(U,{value:l})});break}}static setAttributes({html:G,element:U,storage:M=null,intent:m,linkService:T}){const{attributes:F}=U,R=G instanceof HTMLAnchorElement;F.type==="radio"&&(F.name=`${F.name}-${m}`);for(const[A,l]of Object.entries(F))if(!(l==null||A==="dataId"))if(A!=="style")if(A==="textContent")G.textContent=l;else if(A==="class")l.length&&G.setAttribute(A,l.join(" "));else{if(R&&(A==="href"||A==="newWindow"))continue;G.setAttribute(A,l)}else Object.assign(G.style,l);R&&T.addLinkAttributes(G,F.href,F.newWindow),M&&F.dataId&&this.setupStorage(G,F.dataId,U,M)}static render(G){var d;const U=G.annotationStorage,M=G.linkService,m=G.xfaHtml,T=G.intent||"display",F=document.createElement(m.name);m.attributes&&this.setAttributes({html:F,element:m,intent:T,linkService:M});const R=[[m,-1,F]],A=G.div;if(A.appendChild(F),G.viewport){const i=`matrix(${G.viewport.transform.join(",")})`;A.style.transform=i}T!=="richText"&&A.setAttribute("class","xfaLayer xfaFont");const l=[];for(;R.length>0;){const[i,p,v]=R[R.length-1];if(p+1===i.children.length){R.pop();continue}const b=i.children[++R[R.length-1][1]];if(b===null)continue;const{name:C}=b;if(C==="#text"){const o=document.createTextNode(b.value);l.push(o),v.appendChild(o);continue}let e;if((d=b==null?void 0:b.attributes)!=null&&d.xmlns?e=document.createElementNS(b.attributes.xmlns,C):e=document.createElement(C),v.appendChild(e),b.attributes&&this.setAttributes({html:e,element:b,storage:U,intent:T,linkService:M}),b.children&&b.children.length>0)R.push([b,-1,e]);else if(b.value){const o=document.createTextNode(b.value);c.XfaText.shouldBuildText(C)&&l.push(o),e.appendChild(o)}}for(const i of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))i.setAttribute("readOnly",!0);return{textDivs:l}}static update(G){const U=`matrix(${G.viewport.transform.join(",")})`;G.div.style.transform=U,G.div.hidden=!1}}g.XfaLayer=Q},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.renderTextLayer=p;var c=V(1);const Q=1e5,q=30,G=.8,U=new Map,M=/^\s+$/g;function m(v,b){const C=U.get(v);if(C)return C;b.save(),b.font=`${q}px ${v}`;const e=b.measureText("");let o=e.fontBoundingBoxAscent,_=Math.abs(e.fontBoundingBoxDescent);if(o){b.restore();const x=o/(o+_);return U.set(v,x),x}b.strokeStyle="red",b.clearRect(0,0,q,q),b.strokeText("g",0,0);let P=b.getImageData(0,0,q,q).data;_=0;for(let x=P.length-1-3;x>=0;x-=4)if(P[x]>0){_=Math.ceil(x/4/q);break}b.clearRect(0,0,q,q),b.strokeText("A",0,q),P=b.getImageData(0,0,q,q).data,o=0;for(let x=0,E=P.length;x<E;x+=4)if(P[x]>0){o=q-Math.floor(x/4/q);break}if(b.restore(),o){const x=o/(o+_);return U.set(v,x),x}return U.set(v,G),G}function T(v,b,C,e){const o=document.createElement("span"),_=v._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:b.str!=="",hasEOL:b.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:b.str!=="",hasEOL:b.hasEOL};v._textDivs.push(o);const P=c.Util.transform(v._viewport.transform,b.transform);let x=Math.atan2(P[1],P[0]);const E=C[b.fontName];E.vertical&&(x+=Math.PI/2);const k=Math.hypot(P[2],P[3]),D=k*m(E.fontFamily,e);let $,B;x===0?($=P[4],B=P[5]-D):($=P[4]+D*Math.sin(x),B=P[5]-D*Math.cos(x)),o.style.left=`${$}px`,o.style.top=`${B}px`,o.style.fontSize=`${k}px`,o.style.fontFamily=E.fontFamily,o.setAttribute("role","presentation"),o.textContent=b.str,o.dir=b.dir,v._fontInspectorEnabled&&(o.dataset.fontName=b.fontName),x!==0&&(_.angle=x*(180/Math.PI));let z=!1;if(b.str.length>1||v._enhanceTextSelection&&M.test(b.str))z=!0;else if(b.str!==" "&&b.transform[0]!==b.transform[3]){const K=Math.abs(b.transform[0]),Z=Math.abs(b.transform[3]);K!==Z&&Math.max(K,Z)/Math.min(K,Z)>1.5&&(z=!0)}if(z&&(E.vertical?_.canvasWidth=b.height*v._viewport.scale:_.canvasWidth=b.width*v._viewport.scale),v._textDivProperties.set(o,_),v._textContentStream&&v._layoutText(o),v._enhanceTextSelection&&_.hasText){let K=1,Z=0;x!==0&&(K=Math.cos(x),Z=Math.sin(x));const Y=(E.vertical?b.height:b.width)*v._viewport.scale,et=k;let ot,S;x!==0?(ot=[K,Z,-Z,K,$,B],S=c.Util.getAxialAlignedBoundingBox([0,0,Y,et],ot)):S=[$,B,$+Y,B+et],v._bounds.push({left:S[0],top:S[1],right:S[2],bottom:S[3],div:o,size:[Y,et],m:ot})}}function F(v){if(v._canceled)return;const b=v._textDivs,C=v._capability,e=b.length;if(e>Q){v._renderingDone=!0,C.resolve();return}if(!v._textContentStream)for(let o=0;o<e;o++)v._layoutText(b[o]);v._renderingDone=!0,C.resolve()}function R(v,b,C){let e=0;for(let o=0;o<C;o++){const _=v[b++];_>0&&(e=e?Math.min(_,e):_)}return e}function A(v){const b=v._bounds,C=v._viewport,e=l(C.width,C.height,b);for(let o=0;o<e.length;o++){const _=b[o].div,P=v._textDivProperties.get(_);if(P.angle===0){P.paddingLeft=b[o].left-e[o].left,P.paddingTop=b[o].top-e[o].top,P.paddingRight=e[o].right-b[o].right,P.paddingBottom=e[o].bottom-b[o].bottom,v._textDivProperties.set(_,P);continue}const x=e[o],E=b[o],k=E.m,D=k[0],$=k[1],B=[[0,0],[0,E.size[1]],[E.size[0],0],E.size],z=new Float64Array(64);for(let Z=0,Y=B.length;Z<Y;Z++){const et=c.Util.applyTransform(B[Z],k);z[Z+0]=D&&(x.left-et[0])/D,z[Z+4]=$&&(x.top-et[1])/$,z[Z+8]=D&&(x.right-et[0])/D,z[Z+12]=$&&(x.bottom-et[1])/$,z[Z+16]=$&&(x.left-et[0])/-$,z[Z+20]=D&&(x.top-et[1])/D,z[Z+24]=$&&(x.right-et[0])/-$,z[Z+28]=D&&(x.bottom-et[1])/D,z[Z+32]=D&&(x.left-et[0])/-D,z[Z+36]=$&&(x.top-et[1])/-$,z[Z+40]=D&&(x.right-et[0])/-D,z[Z+44]=$&&(x.bottom-et[1])/-$,z[Z+48]=$&&(x.left-et[0])/$,z[Z+52]=D&&(x.top-et[1])/-D,z[Z+56]=$&&(x.right-et[0])/$,z[Z+60]=D&&(x.bottom-et[1])/-D}const K=1+Math.min(Math.abs(D),Math.abs($));P.paddingLeft=R(z,32,16)/K,P.paddingTop=R(z,48,16)/K,P.paddingRight=R(z,0,16)/K,P.paddingBottom=R(z,16,16)/K,v._textDivProperties.set(_,P)}}function l(v,b,C){const e=C.map(function(_,P){return{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom,index:P,x1New:void 0,x2New:void 0}});d(v,e);const o=new Array(C.length);for(const _ of e){const P=_.index;o[P]={left:_.x1New,top:0,right:_.x2New,bottom:0}}C.map(function(_,P){const x=o[P],E=e[P];E.x1=_.top,E.y1=v-x.right,E.x2=_.bottom,E.y2=v-x.left,E.index=P,E.x1New=void 0,E.x2New=void 0}),d(b,e);for(const _ of e){const P=_.index;o[P].top=_.x1New,o[P].bottom=_.x2New}return o}function d(v,b){b.sort(function(o,_){return o.x1-_.x1||o.index-_.index});const e=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const o of b){let _=0;for(;_<e.length&&e[_].end<=o.y1;)_++;let P=e.length-1;for(;P>=0&&e[P].start>=o.y2;)P--;let x,E,k,D,$=-1/0;for(k=_;k<=P;k++){x=e[k],E=x.boundary;let K;E.x2>o.x1?K=E.index>o.index?E.x1New:o.x1:E.x2New===void 0?K=(E.x2+o.x1)/2:K=E.x2New,K>$&&($=K)}for(o.x1New=$,k=_;k<=P;k++)x=e[k],E=x.boundary,E.x2New===void 0?E.x2>o.x1?E.index>o.index&&(E.x2New=E.x2):E.x2New=$:E.x2New>$&&(E.x2New=Math.max($,E.x2));const B=[];let z=null;for(k=_;k<=P;k++){x=e[k],E=x.boundary;const K=E.x2>o.x2?E:o;z===K?B[B.length-1].end=x.end:(B.push({start:x.start,end:x.end,boundary:K}),z=K)}for(e[_].start<o.y1&&(B[0].start=o.y1,B.unshift({start:e[_].start,end:o.y1,boundary:e[_].boundary})),o.y2<e[P].end&&(B[B.length-1].end=o.y2,B.push({start:o.y2,end:e[P].end,boundary:e[P].boundary})),k=_;k<=P;k++){if(x=e[k],E=x.boundary,E.x2New!==void 0)continue;let K=!1;for(D=_-1;!K&&D>=0&&e[D].start>=E.y1;D--)K=e[D].boundary===E;for(D=P+1;!K&&D<e.length&&e[D].end<=E.y2;D++)K=e[D].boundary===E;for(D=0;!K&&D<B.length;D++)K=B[D].boundary===E;K||(E.x2New=$)}Array.prototype.splice.apply(e,[_,P-_+1].concat(B))}for(const o of e){const _=o.boundary;_.x2New===void 0&&(_.x2New=Math.max(v,_.x2))}}class i{constructor({textContent:b,textContentStream:C,container:e,viewport:o,textDivs:_,textContentItemsStr:P,enhanceTextSelection:x}){var E;this._textContent=b,this._textContentStream=C,this._container=e,this._document=e.ownerDocument,this._viewport=o,this._textDivs=_||[],this._textContentItemsStr=P||[],this._enhanceTextSelection=!!x,this._fontInspectorEnabled=!!((E=globalThis.FontInspector)!=null&&E.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,c.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(b,C){for(let e=0,o=b.length;e<o;e++){if(b[e].str===void 0){if(b[e].type==="beginMarkedContentProps"||b[e].type==="beginMarkedContent"){const _=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),b[e].id!==null&&this._container.setAttribute("id",`${b[e].id}`),_.appendChild(this._container)}else b[e].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(b[e].str),T(this,b[e],C,this._layoutTextCtx)}}_layoutText(b){const C=this._textDivProperties.get(b);let e="";if(C.canvasWidth!==0&&C.hasText){const{fontSize:o,fontFamily:_}=b.style;(o!==this._layoutTextLastFontSize||_!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${o} ${_}`,this._layoutTextLastFontSize=o,this._layoutTextLastFontFamily=_);const{width:P}=this._layoutTextCtx.measureText(b.textContent);if(P>0){const x=C.canvasWidth/P;this._enhanceTextSelection&&(C.scale=x),e=`scaleX(${x})`}}if(C.angle!==0&&(e=`rotate(${C.angle}deg) ${e}`),e.length>0&&(this._enhanceTextSelection&&(C.originalTransform=e),b.style.transform=e),C.hasText&&this._container.appendChild(b),C.hasEOL){const o=document.createElement("br");o.setAttribute("role","presentation"),this._container.appendChild(o)}}_render(b=0){const C=(0,c.createPromiseCapability)();let e=Object.create(null);const o=this._document.createElement("canvas");if(o.height=o.width=q,this._layoutTextCtx=o.getContext("2d",{alpha:!1}),this._textContent){const _=this._textContent.items,P=this._textContent.styles;this._processItems(_,P),C.resolve()}else if(this._textContentStream){const _=()=>{this._reader.read().then(({value:P,done:x})=>{if(x){C.resolve();return}Object.assign(e,P.styles),this._processItems(P.items,e),_()},C.reject)};this._reader=this._textContentStream.getReader(),_()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');C.promise.then(()=>{e=null,b?this._renderTimer=setTimeout(()=>{F(this),this._renderTimer=null},b):F(this)},this._capability.reject)}expandTextDivs(b=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(A(this),this._bounds=null);const C=[],e=[];for(let o=0,_=this._textDivs.length;o<_;o++){const P=this._textDivs[o],x=this._textDivProperties.get(P);!x.hasText||(b?(C.length=0,e.length=0,x.originalTransform&&C.push(x.originalTransform),x.paddingTop>0?(e.push(`${x.paddingTop}px`),C.push(`translateY(${-x.paddingTop}px)`)):e.push(0),x.paddingRight>0?e.push(`${x.paddingRight/x.scale}px`):e.push(0),x.paddingBottom>0?e.push(`${x.paddingBottom}px`):e.push(0),x.paddingLeft>0?(e.push(`${x.paddingLeft/x.scale}px`),C.push(`translateX(${-x.paddingLeft/x.scale}px)`)):e.push(0),P.style.padding=e.join(" "),C.length&&(P.style.transform=C.join(" "))):(P.style.padding=null,P.style.transform=x.originalTransform))}}}function p(v){const b=new i({textContent:v.textContent,textContentStream:v.textContentStream,container:v.container,viewport:v.viewport,textDivs:v.textDivs,textContentItemsStr:v.textContentItemsStr,enhanceTextSelection:v.enhanceTextSelection});return b._render(v.timeout),b}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.SVGGraphics=void 0;var c=V(1),Q=V(5),q=V(3);let G=class{constructor(){(0,c.unreachable)("Not implemented: SVGGraphics")}};g.SVGGraphics=G;{let d=function(e){let o=[];const _=[];for(const P of e){if(P.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),_.push(o),o=o[o.length-1].items;continue}P.fn==="restore"?o=_.pop():o.push(P)}return o},i=function(e){if(Number.isInteger(e))return e.toString();const o=e.toFixed(10);let _=o.length-1;if(o[_]!=="0")return o;do _--;while(o[_]==="0");return o.substring(0,o[_]==="."?_:_+1)},p=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${i(e[0])} ${i(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const o=Math.acos(e[0])*180/Math.PI;return`rotate(${i(o)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${i(e[4])} ${i(e[5])})`;return`matrix(${i(e[0])} ${i(e[1])} ${i(e[2])} ${i(e[3])} ${i(e[4])} ${i(e[5])})`};const U={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},M="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/1999/xlink",T=["butt","round","square"],F=["miter","round","bevel"],R=function(e,o="",_=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!_)return URL.createObjectURL(new Blob([e],{type:o}));const P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let x=`data:${o};base64,`;for(let E=0,k=e.length;E<k;E+=3){const D=e[E]&255,$=e[E+1]&255,B=e[E+2]&255,z=D>>2,K=(D&3)<<4|$>>4,Z=E+1<k?($&15)<<2|B>>6:64,Y=E+2<k?B&63:64;x+=P[z]+P[K]+P[Z]+P[Y]}return x},A=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,_=new Int32Array(256);for(let B=0;B<256;B++){let z=B;for(let K=0;K<8;K++)z&1?z=3988292384^z>>1&2147483647:z=z>>1&2147483647;_[B]=z}function P(B,z,K){let Z=-1;for(let Y=z;Y<K;Y++){const et=(Z^B[Y])&255,ot=_[et];Z=Z>>>8^ot}return Z^-1}function x(B,z,K,Z){let Y=Z;const et=z.length;K[Y]=et>>24&255,K[Y+1]=et>>16&255,K[Y+2]=et>>8&255,K[Y+3]=et&255,Y+=4,K[Y]=B.charCodeAt(0)&255,K[Y+1]=B.charCodeAt(1)&255,K[Y+2]=B.charCodeAt(2)&255,K[Y+3]=B.charCodeAt(3)&255,Y+=4,K.set(z,Y),Y+=z.length;const ot=P(K,Z+4,Y);K[Y]=ot>>24&255,K[Y+1]=ot>>16&255,K[Y+2]=ot>>8&255,K[Y+3]=ot&255}function E(B,z,K){let Z=1,Y=0;for(let et=z;et<K;++et)Z=(Z+(B[et]&255))%65521,Y=(Y+Z)%65521;return Y<<16|Z}function k(B){if(!q.isNodeJS)return D(B);try{let z;parseInt(process.versions.node)>=8?z=B:z=Buffer.from(B);const K=require$$5.deflateSync(z,{level:9});return K instanceof Uint8Array?K:new Uint8Array(K)}catch(z){(0,c.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+z)}return D(B)}function D(B){let z=B.length;const K=65535,Z=Math.ceil(z/K),Y=new Uint8Array(2+z+Z*5+4);let et=0;Y[et++]=120,Y[et++]=156;let ot=0;for(;z>K;)Y[et++]=0,Y[et++]=255,Y[et++]=255,Y[et++]=0,Y[et++]=0,Y.set(B.subarray(ot,ot+K),et),et+=K,ot+=K,z-=K;Y[et++]=1,Y[et++]=z&255,Y[et++]=z>>8&255,Y[et++]=~z&65535&255,Y[et++]=(~z&65535)>>8&255,Y.set(B.subarray(ot),et),et+=B.length-ot;const S=E(B,0,B.length);return Y[et++]=S>>24&255,Y[et++]=S>>16&255,Y[et++]=S>>8&255,Y[et++]=S&255,Y}function $(B,z,K,Z){const Y=B.width,et=B.height;let ot,S,a;const s=B.data;switch(z){case c.ImageKind.GRAYSCALE_1BPP:S=0,ot=1,a=Y+7>>3;break;case c.ImageKind.RGB_24BPP:S=2,ot=8,a=Y*3;break;case c.ImageKind.RGBA_32BPP:S=6,ot=8,a=Y*4;break;default:throw new Error("invalid format")}const f=new Uint8Array((1+a)*et);let t=0,n=0;for(let N=0;N<et;++N)f[t++]=0,f.set(s.subarray(n,n+a),t),n+=a,t+=a;if(z===c.ImageKind.GRAYSCALE_1BPP&&Z){t=0;for(let N=0;N<et;N++){t++;for(let O=0;O<a;O++)f[t++]^=255}}const r=new Uint8Array([Y>>24&255,Y>>16&255,Y>>8&255,Y&255,et>>24&255,et>>16&255,et>>8&255,et&255,ot,S,0,0,0]),u=k(f),h=e.length+o*3+r.length+u.length,y=new Uint8Array(h);let w=0;return y.set(e,w),w+=e.length,x("IHDR",r,y,w),w+=o+r.length,x("IDATA",u,y,w),w+=o+u.length,x("IEND",new Uint8Array(0),y,w),R(y,"image/png",K)}return function(z,K,Z){const Y=z.kind===void 0?c.ImageKind.GRAYSCALE_1BPP:z.kind;return $(z,Y,K,Z)}}();class l{constructor(){this.fontSizeScale=1,this.fontWeight=U.fontWeight,this.fontSize=0,this.textMatrix=c.IDENTITY_MATRIX,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=c.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=U.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,_){this.x=o,this.y=_}}let v=0,b=0,C=0;g.SVGGraphics=G=class{constructor(e,o,_=!1){this.svgFactory=new Q.DOMSVGFactory,this.current=new l,this.transformMatrix=c.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!_,this._operatorIdMapping=[];for(const P in c.OPS)this._operatorIdMapping[c.OPS[P]]=P}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const o=e.fnArray,_=e.argsArray;for(let P=0,x=o.length;P<x;P++)if(o[P]===c.OPS.dependency)for(const E of _[P]){const k=E.startsWith("g_")?this.commonObjs:this.objs,D=new Promise($=>{k.get(E,$)});this.current.dependencies.push(D)}return Promise.all(this.current.dependencies)}transform(e,o,_,P,x,E){const k=[e,o,_,P,x,E];this.transformMatrix=c.Util.transform(this.transformMatrix,k),this.tgrp=null}getSVG(e,o){this.viewport=o;const _=this._initialize(o);return this.loadDependencies(e).then(()=>(this.transformMatrix=c.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),_))}convertOpList(e){const o=this._operatorIdMapping,_=e.argsArray,P=e.fnArray,x=[];for(let E=0,k=P.length;E<k;E++){const D=P[E];x.push({fnId:D,fn:o[D],args:_[E]})}return d(x)}executeOpTree(e){for(const o of e){const _=o.fn,P=o.fnId,x=o.args;switch(P|0){case c.OPS.beginText:this.beginText();break;case c.OPS.dependency:break;case c.OPS.setLeading:this.setLeading(x);break;case c.OPS.setLeadingMoveText:this.setLeadingMoveText(x[0],x[1]);break;case c.OPS.setFont:this.setFont(x);break;case c.OPS.showText:this.showText(x[0]);break;case c.OPS.showSpacedText:this.showText(x[0]);break;case c.OPS.endText:this.endText();break;case c.OPS.moveText:this.moveText(x[0],x[1]);break;case c.OPS.setCharSpacing:this.setCharSpacing(x[0]);break;case c.OPS.setWordSpacing:this.setWordSpacing(x[0]);break;case c.OPS.setHScale:this.setHScale(x[0]);break;case c.OPS.setTextMatrix:this.setTextMatrix(x[0],x[1],x[2],x[3],x[4],x[5]);break;case c.OPS.setTextRise:this.setTextRise(x[0]);break;case c.OPS.setTextRenderingMode:this.setTextRenderingMode(x[0]);break;case c.OPS.setLineWidth:this.setLineWidth(x[0]);break;case c.OPS.setLineJoin:this.setLineJoin(x[0]);break;case c.OPS.setLineCap:this.setLineCap(x[0]);break;case c.OPS.setMiterLimit:this.setMiterLimit(x[0]);break;case c.OPS.setFillRGBColor:this.setFillRGBColor(x[0],x[1],x[2]);break;case c.OPS.setStrokeRGBColor:this.setStrokeRGBColor(x[0],x[1],x[2]);break;case c.OPS.setStrokeColorN:this.setStrokeColorN(x);break;case c.OPS.setFillColorN:this.setFillColorN(x);break;case c.OPS.shadingFill:this.shadingFill(x[0]);break;case c.OPS.setDash:this.setDash(x[0],x[1]);break;case c.OPS.setRenderingIntent:this.setRenderingIntent(x[0]);break;case c.OPS.setFlatness:this.setFlatness(x[0]);break;case c.OPS.setGState:this.setGState(x[0]);break;case c.OPS.fill:this.fill();break;case c.OPS.eoFill:this.eoFill();break;case c.OPS.stroke:this.stroke();break;case c.OPS.fillStroke:this.fillStroke();break;case c.OPS.eoFillStroke:this.eoFillStroke();break;case c.OPS.clip:this.clip("nonzero");break;case c.OPS.eoClip:this.clip("evenodd");break;case c.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case c.OPS.paintImageXObject:this.paintImageXObject(x[0]);break;case c.OPS.paintInlineImageXObject:this.paintInlineImageXObject(x[0]);break;case c.OPS.paintImageMaskXObject:this.paintImageMaskXObject(x[0]);break;case c.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(x[0],x[1]);break;case c.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case c.OPS.closePath:this.closePath();break;case c.OPS.closeStroke:this.closeStroke();break;case c.OPS.closeFillStroke:this.closeFillStroke();break;case c.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case c.OPS.nextLine:this.nextLine();break;case c.OPS.transform:this.transform(x[0],x[1],x[2],x[3],x[4],x[5]);break;case c.OPS.constructPath:this.constructPath(x[0],x[1]);break;case c.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,c.warn)(`Unimplemented operator ${_}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,o,_,P,x,E){const k=this.current;k.textMatrix=k.lineMatrix=[e,o,_,P,x,E],k.textMatrixScale=Math.hypot(e,o),k.x=k.lineX=0,k.y=k.lineY=0,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${i(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",i(-k.y)),k.txtElement=this.svgFactory.createElement("svg:text"),k.txtElement.appendChild(k.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=c.IDENTITY_MATRIX,e.lineMatrix=c.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,o){const _=this.current;_.x=_.lineX+=e,_.y=_.lineY+=o,_.xcoords=[],_.ycoords=[],_.tspan=this.svgFactory.createElement("svg:tspan"),_.tspan.setAttributeNS(null,"font-family",_.fontFamily),_.tspan.setAttributeNS(null,"font-size",`${i(_.fontSize)}px`),_.tspan.setAttributeNS(null,"y",i(-_.y))}showText(e){const o=this.current,_=o.font,P=o.fontSize;if(P===0)return;const x=o.fontSizeScale,E=o.charSpacing,k=o.wordSpacing,D=o.fontDirection,$=o.textHScale*D,B=_.vertical,z=B?1:-1,K=_.defaultVMetrics,Z=P*o.fontMatrix[0];let Y=0;for(const S of e){if(S===null){Y+=D*k;continue}else if(typeof S=="number"){Y+=z*S*P/1e3;continue}const a=(S.isSpace?k:0)+E,s=S.fontChar;let f,t,n=S.width;if(B){let u;const h=S.vmetric||K;u=S.vmetric?h[1]:n*.5,u=-u*Z;const y=h[2]*Z;n=h?-h[0]:n,f=u/x,t=(Y+y)/x}else f=Y/x,t=0;(S.isInFont||_.missingFile)&&(o.xcoords.push(o.x+f),B&&o.ycoords.push(-o.y+t),o.tspan.textContent+=s);let r;B?r=n*Z-a*D:r=n*Z+a*D,Y+=r}o.tspan.setAttributeNS(null,"x",o.xcoords.map(i).join(" ")),B?o.tspan.setAttributeNS(null,"y",o.ycoords.map(i).join(" ")):o.tspan.setAttributeNS(null,"y",i(-o.y)),B?o.y-=Y:o.x+=Y*$,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${i(o.fontSize)}px`),o.fontStyle!==U.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==U.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const et=o.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;if(et===c.TextRenderingMode.FILL||et===c.TextRenderingMode.FILL_STROKE?(o.fillColor!==U.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===c.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),et===c.TextRenderingMode.STROKE||et===c.TextRenderingMode.FILL_STROKE){const S=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,S)}let ot=o.textMatrix;o.textRise!==0&&(ot=ot.slice(),ot[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${p(ot)} scale(${i($)}, -1)`),o.txtElement.setAttributeNS(M,"xml:space","preserve"),o.txtElement.appendChild(o.tspan),o.txtgrp.appendChild(o.txtElement),this._ensureTransformGroup().appendChild(o.txtElement)}setLeadingMoveText(e,o){this.setLeading(-o),this.moveText(e,o)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const o=R(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${o}); }
`}setFont(e){const o=this.current,_=this.commonObjs.get(e[0]);let P=e[1];o.font=_,this.embedFonts&&!_.missingFile&&!this.embeddedFonts[_.loadedName]&&(this.addFontStyle(_),this.embeddedFonts[_.loadedName]=_),o.fontMatrix=_.fontMatrix||c.FONT_IDENTITY_MATRIX;let x="normal";_.black?x="900":_.bold&&(x="bold");const E=_.italic?"italic":"normal";P<0?(P=-P,o.fontDirection=-1):o.fontDirection=1,o.fontSize=P,o.fontFamily=_.loadedName,o.fontWeight=x,o.fontStyle=E,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",i(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const e=this.current;e.textRenderingMode&c.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=e.txtElement)==null?void 0:o.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=T[e]}setLineJoin(e){this.current.lineJoin=F[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,o,_){this.current.strokeColor=c.Util.makeHexColor(e,o,_)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,o,_){this.current.fillColor=c.Util.makeHexColor(e,o,_),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const o=this.viewport.width,_=this.viewport.height,P=c.Util.inverseTransform(this.transformMatrix),x=c.Util.applyTransform([0,0],P),E=c.Util.applyTransform([0,_],P),k=c.Util.applyTransform([o,0],P),D=c.Util.applyTransform([o,_],P),$=Math.min(x[0],E[0],k[0],D[0]),B=Math.min(x[1],E[1],k[1],D[1]),z=Math.max(x[0],E[0],k[0],D[0]),K=Math.max(x[1],E[1],k[1],D[1]),Z=this.svgFactory.createElement("svg:rect");Z.setAttributeNS(null,"x",$),Z.setAttributeNS(null,"y",B),Z.setAttributeNS(null,"width",z-$),Z.setAttributeNS(null,"height",K-B),Z.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&Z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(Z)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const o=e[1],_=e[2],P=e[3]||c.IDENTITY_MATRIX,[x,E,k,D]=e[4],$=e[5],B=e[6],z=e[7],K=`shading${C++}`,[Z,Y,et,ot]=c.Util.normalizeRect([...c.Util.applyTransform([x,E],P),...c.Util.applyTransform([k,D],P)]),[S,a]=c.Util.singularValueDecompose2dScale(P),s=$*S,f=B*a,t=this.svgFactory.createElement("svg:pattern");t.setAttributeNS(null,"id",K),t.setAttributeNS(null,"patternUnits","userSpaceOnUse"),t.setAttributeNS(null,"width",s),t.setAttributeNS(null,"height",f),t.setAttributeNS(null,"x",`${Z}`),t.setAttributeNS(null,"y",`${Y}`);const n=this.svg,r=this.transformMatrix,u=this.current.fillColor,h=this.current.strokeColor,y=this.svgFactory.create(et-Z,ot-Y);if(this.svg=y,this.transformMatrix=P,z===2){const w=c.Util.makeHexColor(...o);this.current.fillColor=w,this.current.strokeColor=w}return this.executeOpTree(this.convertOpList(_)),this.svg=n,this.transformMatrix=r,this.current.fillColor=u,this.current.strokeColor=h,t.appendChild(y.childNodes[0]),this.defs.appendChild(t),`url(#${K})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const o=`shading${C++}`,_=e[3];let P;switch(e[1]){case"axial":const x=e[4],E=e[5];P=this.svgFactory.createElement("svg:linearGradient"),P.setAttributeNS(null,"id",o),P.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),P.setAttributeNS(null,"x1",x[0]),P.setAttributeNS(null,"y1",x[1]),P.setAttributeNS(null,"x2",E[0]),P.setAttributeNS(null,"y2",E[1]);break;case"radial":const k=e[4],D=e[5],$=e[6],B=e[7];P=this.svgFactory.createElement("svg:radialGradient"),P.setAttributeNS(null,"id",o),P.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),P.setAttributeNS(null,"cx",D[0]),P.setAttributeNS(null,"cy",D[1]),P.setAttributeNS(null,"r",B),P.setAttributeNS(null,"fx",k[0]),P.setAttributeNS(null,"fy",k[1]),P.setAttributeNS(null,"fr",$);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const x of _){const E=this.svgFactory.createElement("svg:stop");E.setAttributeNS(null,"offset",x[0]),E.setAttributeNS(null,"stop-color",x[1]),P.appendChild(E)}return this.defs.appendChild(P),`url(#${o})`;case"Mesh":return(0,c.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,o){this.current.dashArray=e,this.current.dashPhase=o}constructPath(e,o){const _=this.current;let P=_.x,x=_.y,E=[],k=0;for(const D of e)switch(D|0){case c.OPS.rectangle:P=o[k++],x=o[k++];const $=o[k++],B=o[k++],z=P+$,K=x+B;E.push("M",i(P),i(x),"L",i(z),i(x),"L",i(z),i(K),"L",i(P),i(K),"Z");break;case c.OPS.moveTo:P=o[k++],x=o[k++],E.push("M",i(P),i(x));break;case c.OPS.lineTo:P=o[k++],x=o[k++],E.push("L",i(P),i(x));break;case c.OPS.curveTo:P=o[k+4],x=o[k+5],E.push("C",i(o[k]),i(o[k+1]),i(o[k+2]),i(o[k+3]),i(P),i(x)),k+=6;break;case c.OPS.curveTo2:E.push("C",i(P),i(x),i(o[k]),i(o[k+1]),i(o[k+2]),i(o[k+3])),P=o[k+2],x=o[k+3],k+=4;break;case c.OPS.curveTo3:P=o[k+2],x=o[k+3],E.push("C",i(o[k]),i(o[k+1]),i(P),i(x),i(P),i(x)),k+=4;break;case c.OPS.closePath:E.push("Z");break}E=E.join(" "),_.path&&e.length>0&&e[0]!==c.OPS.rectangle&&e[0]!==c.OPS.moveTo?E=_.path.getAttributeNS(null,"d")+E:(_.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(_.path)),_.path.setAttributeNS(null,"d",E),_.path.setAttributeNS(null,"fill","none"),_.element=_.path,_.setCurrentPoint(P,x)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const o=`clippath${v++}`,_=this.svgFactory.createElement("svg:clipPath");_.setAttributeNS(null,"id",o),_.setAttributeNS(null,"transform",p(this.transformMatrix));const P=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?P.setAttributeNS(null,"clip-rule","evenodd"):P.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,_.appendChild(P),this.defs.appendChild(_),e.activeClipUrl){e.clipGroup=null;for(const x of this.extraStack)x.clipGroup=null;_.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const o=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",o)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[o,_]of e)switch(o){case"LW":this.setLineWidth(_);break;case"LC":this.setLineCap(_);break;case"LJ":this.setLineJoin(_);break;case"ML":this.setMiterLimit(_);break;case"D":this.setDash(_[0],_[1]);break;case"RI":this.setRenderingIntent(_);break;case"FL":this.setFlatness(_);break;case"Font":this.setFont(_);break;case"CA":this.setStrokeAlpha(_);break;case"ca":this.setFillAlpha(_);break;default:(0,c.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,o=1){const _=this.current;let P=_.dashArray;o!==1&&P.length>0&&(P=P.map(function(x){return o*x})),e.setAttributeNS(null,"stroke",_.strokeColor),e.setAttributeNS(null,"stroke-opacity",_.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",i(_.miterLimit)),e.setAttributeNS(null,"stroke-linecap",_.lineCap),e.setAttributeNS(null,"stroke-linejoin",_.lineJoin),e.setAttributeNS(null,"stroke-width",i(o*_.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",P.map(i).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",i(o*_.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(e)}paintImageXObject(e){const o=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(!o){(0,c.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(e,o){const _=e.width,P=e.height,x=A(e,this.forceDataSchema,!!o),E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",i(_)),E.setAttributeNS(null,"height",i(P)),this.current.element=E,this.clip("nonzero");const k=this.svgFactory.createElement("svg:image");k.setAttributeNS(m,"xlink:href",x),k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y",i(-P)),k.setAttributeNS(null,"width",i(_)+"px"),k.setAttributeNS(null,"height",i(P)+"px"),k.setAttributeNS(null,"transform",`scale(${i(1/_)} ${i(-1/P)})`),o?o.appendChild(k):this._ensureTransformGroup().appendChild(k)}paintImageMaskXObject(e){const o=this.current,_=e.width,P=e.height,x=o.fillColor;o.maskId=`mask${b++}`;const E=this.svgFactory.createElement("svg:mask");E.setAttributeNS(null,"id",o.maskId);const k=this.svgFactory.createElement("svg:rect");k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y","0"),k.setAttributeNS(null,"width",i(_)),k.setAttributeNS(null,"height",i(P)),k.setAttributeNS(null,"fill",x),k.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.appendChild(E),this._ensureTransformGroup().appendChild(k),this.paintInlineImageXObject(e,E)}paintFormXObjectBegin(e,o){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),o){const _=o[2]-o[0],P=o[3]-o[1],x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",o[0]),x.setAttributeNS(null,"y",o[1]),x.setAttributeNS(null,"width",i(_)),x.setAttributeNS(null,"height",i(P)),this.current.element=x,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const o=this.svgFactory.create(e.width,e.height),_=this.svgFactory.createElement("svg:defs");o.appendChild(_),this.defs=_;const P=this.svgFactory.createElement("svg:g");return P.setAttributeNS(null,"transform",p(e.transform)),o.appendChild(P),this.svg=P,o}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",p(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFNodeStream=void 0;var c=V(1),Q=V(26);const q=require$$5,G=require$$5,U=require$$5,M=require$$5,m=/^file:\/\/\/[a-zA-Z]:\//;function T(b){const C=M.parse(b);return C.protocol==="file:"||C.host?C:/^[a-z]:[/\\]/i.test(b)?M.parse(`file:///${b}`):(C.host||(C.protocol="file:"),C)}class F{constructor(C){this.source=C,this.url=T(C.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C,e;return(e=(C=this._fullRequestReader)==null?void 0:C._loaded)!=null?e:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new d(this),this._fullRequestReader}getRangeReader(C,e){if(e<=this._progressiveDataLength)return null;const o=this.isFsUrl?new v(this,C,e):new i(this,C,e);return this._rangeRequestReaders.push(o),o}cancelAllRequests(C){this._fullRequestReader&&this._fullRequestReader.cancel(C);for(const e of this._rangeRequestReaders.slice(0))e.cancel(C)}}g.PDFNodeStream=F;class R{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=C.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,c.createPromiseCapability)(),this._headersCapability=(0,c.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=(0,c.createPromiseCapability)(),this.read()):(this._loaded+=C.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new c.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,c.createPromiseCapability)();const e=C.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=(0,c.createPromiseCapability)(),this.read()):(this._loaded+=C.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(C).buffer,done:!1})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(b,C){return{protocol:b.protocol,auth:b.auth,host:b.hostname,port:b.port,path:b.path,method:"GET",headers:C}}class d extends R{constructor(C){super(C);const e=o=>{if(o.statusCode===404){const E=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=E,this._headersCapability.reject(E);return}this._headersCapability.resolve(),this._setReadableStream(o);const _=E=>this._readableStream.headers[E.toLowerCase()],{allowRangeRequests:P,suggestedLength:x}=(0,Q.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:C.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=x||this._contentLength,this._filename=(0,Q.extractFilenameFromHeader)(_)};this._request=null,this._url.protocol==="http:"?this._request=G.request(l(this._url,C.httpHeaders),e):this._request=U.request(l(this._url,C.httpHeaders),e),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class i extends A{constructor(C,e,o){super(C),this._httpHeaders={};for(const P in C.httpHeaders){const x=C.httpHeaders[P];typeof x>"u"||(this._httpHeaders[P]=x)}this._httpHeaders.Range=`bytes=${e}-${o-1}`;const _=P=>{if(P.statusCode===404){const x=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x;return}this._setReadableStream(P)};this._request=null,this._url.protocol==="http:"?this._request=G.request(l(this._url,this._httpHeaders),_):this._request=U.request(l(this._url,this._httpHeaders),_),this._request.on("error",P=>{this._storedError=P}),this._request.end()}}class p extends R{constructor(C){super(C);let e=decodeURIComponent(this._url.path);m.test(this._url.href)&&(e=e.replace(/^\//,"")),q.lstat(e,(o,_)=>{if(o){o.code==="ENOENT"&&(o=new c.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=_.size,this._setReadableStream(q.createReadStream(e)),this._headersCapability.resolve()})}}class v extends A{constructor(C,e,o){super(C);let _=decodeURIComponent(this._url.path);m.test(this._url.href)&&(_=_.replace(/^\//,"")),this._setReadableStream(q.createReadStream(_,{start:e,end:o-1}))}}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.createResponseStatusError=M,g.extractFilenameFromHeader=U,g.validateRangeRequestCapabilities=G,g.validateResponseStatus=m;var c=V(1),Q=V(27),q=V(5);function G({getResponseHeader:T,isHttp:F,rangeChunkSize:R,disableRange:A}){const l={allowRangeRequests:!1,suggestedLength:void 0},d=parseInt(T("Content-Length"),10);return!Number.isInteger(d)||(l.suggestedLength=d,d<=2*R)||A||!F||T("Accept-Ranges")!=="bytes"||(T("Content-Encoding")||"identity")!=="identity"||(l.allowRangeRequests=!0),l}function U(T){const F=T("Content-Disposition");if(F){let R=(0,Q.getFilenameFromContentDispositionHeader)(F);if(R.includes("%"))try{R=decodeURIComponent(R)}catch{}if((0,q.isPdfFile)(R))return R}return null}function M(T,F){return T===404||T===0&&F.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+F+'".'):new c.UnexpectedResponseException(`Unexpected server response (${T}) while retrieving PDF "${F}".`,T)}function m(T){return T===200||T===206}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.getFilenameFromContentDispositionHeader=Q;var c=V(1);function Q(q){let G=!0,U=M("filename\\*","i").exec(q);if(U){U=U[1];let d=R(U);return d=unescape(d),d=A(d),d=l(d),T(d)}if(U=F(q),U){const d=l(U);return T(d)}if(U=M("filename","i").exec(q),U){U=U[1];let d=R(U);return d=l(d),T(d)}function M(d,i){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',i)}function m(d,i){if(d){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const p=new TextDecoder(d,{fatal:!0}),v=(0,c.stringToBytes)(i);i=p.decode(v),G=!1}catch{}}return i}function T(d){return G&&/[\x80-\xff]/.test(d)&&(d=m("utf-8",d),G&&(d=m("iso-8859-1",d))),d}function F(d){const i=[];let p;const v=M("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=v.exec(d))!==null;){let[,C,e,o]=p;if(C=parseInt(C,10),C in i){if(C===0)break;continue}i[C]=[e,o]}const b=[];for(let C=0;C<i.length&&C in i;++C){let[e,o]=i[C];o=R(o),e&&(o=unescape(o),C===0&&(o=A(o))),b.push(o)}return b.join("")}function R(d){if(d.startsWith('"')){const i=d.slice(1).split('\\"');for(let p=0;p<i.length;++p){const v=i[p].indexOf('"');v!==-1&&(i[p]=i[p].slice(0,v),i.length=p+1),i[p]=i[p].replace(/\\(.)/g,"$1")}d=i.join('"')}return d}function A(d){const i=d.indexOf("'");if(i===-1)return d;const p=d.slice(0,i),b=d.slice(i+1).replace(/^[^']*'/,"");return m(p,b)}function l(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(i,p,v,b){if(v==="q"||v==="Q")return b=b.replace(/_/g," "),b=b.replace(/=([0-9a-fA-F]{2})/g,function(C,e){return String.fromCharCode(parseInt(e,16))}),m(p,b);try{b=atob(b)}catch{}return m(p,b)})}return""}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFNetworkStream=void 0;var c=V(1),Q=V(26);const q=200,G=206;function U(R){const A=R.response;return typeof A!="string"?A:(0,c.stringToBytes)(A).buffer}class M{constructor(A,l={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.getXhr=l.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,l,d){const i={begin:A,end:l};for(const p in d)i[p]=d[p];return this.request(i)}requestFull(A){return this.request(A)}request(A){const l=this.getXhr(),d=this.currXhrId++,i=this.pendingRequests[d]={xhr:l};l.open("GET",this.url),l.withCredentials=this.withCredentials;for(const p in this.httpHeaders){const v=this.httpHeaders[p];typeof v>"u"||l.setRequestHeader(p,v)}return this.isHttp&&"begin"in A&&"end"in A?(l.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),i.expectedStatus=G):i.expectedStatus=q,l.responseType="arraybuffer",A.onError&&(l.onerror=function(p){A.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,d),l.onprogress=this.onProgress.bind(this,d),i.onHeadersReceived=A.onHeadersReceived,i.onDone=A.onDone,i.onError=A.onError,i.onProgress=A.onProgress,l.send(null),d}onProgress(A,l){var i;const d=this.pendingRequests[A];!d||(i=d.onProgress)==null||i.call(d,l)}onStateChange(A,l){var C,e,o;const d=this.pendingRequests[A];if(!d)return;const i=d.xhr;if(i.readyState>=2&&d.onHeadersReceived&&(d.onHeadersReceived(),delete d.onHeadersReceived),i.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],i.status===0&&this.isHttp){(C=d.onError)==null||C.call(d,i.status);return}const p=i.status||q;if(!(p===q&&d.expectedStatus===G)&&p!==d.expectedStatus){(e=d.onError)==null||e.call(d,i.status);return}const b=U(i);if(p===G){const _=i.getResponseHeader("Content-Range"),P=/bytes (\d+)-(\d+)\/(\d+)/.exec(_);d.onDone({begin:parseInt(P[1],10),chunk:b})}else b?d.onDone({begin:0,chunk:b}):(o=d.onError)==null||o.call(d,i.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const l=this.pendingRequests[A].xhr;delete this.pendingRequests[A],l.abort()}}class m{constructor(A){this._source=A,this._manager=new M(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const l=this._rangeRequestReaders.indexOf(A);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new T(this._manager,this._source),this._fullRequestReader}getRangeReader(A,l){const d=new F(this._manager,A,l);return d.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(d),d}cancelAllRequests(A){var l;(l=this._fullRequestReader)==null||l.cancel(A);for(const d of this._rangeRequestReaders.slice(0))d.cancel(A)}}g.PDFNetworkStream=m;class T{constructor(A,l){this._manager=A;const d={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=A.requestFull(d),this._headersReceivedCapability=(0,c.createPromiseCapability)(),this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,l=this._manager.getRequestXhr(A),d=v=>l.getResponseHeader(v),{allowRangeRequests:i,suggestedLength:p}=(0,Q.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=p||this._contentLength,this._filename=(0,Q.extractFilenameFromHeader)(d),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,Q.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var l;(l=this.onProgress)==null||l.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,c.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class F{constructor(A,l,d){this._manager=A;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(l,d,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const l=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunk=l,this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,Q.createResponseStatusError)(A,this._url);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var l;this.isStreamingSupported||(l=this.onProgress)==null||l.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,c.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(J,g,V)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFFetchStream=void 0;var c=V(1),Q=V(26);function q(T,F,R){return{method:"GET",headers:T,signal:R==null?void 0:R.signal,mode:"cors",credentials:F?"include":"same-origin",redirect:"follow"}}function G(T){const F=new Headers;for(const R in T){const A=T[R];typeof A>"u"||F.append(R,A)}return F}class U{constructor(F){this.source=F,this.isHttp=/^https?:/i.test(F.url),this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F,R;return(R=(F=this._fullRequestReader)==null?void 0:F._loaded)!=null?R:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new M(this),this._fullRequestReader}getRangeReader(F,R){if(R<=this._progressiveDataLength)return null;const A=new m(this,F,R);return this._rangeRequestReaders.push(A),A}cancelAllRequests(F){this._fullRequestReader&&this._fullRequestReader.cancel(F);for(const R of this._rangeRequestReaders.slice(0))R.cancel(F)}}g.PDFFetchStream=U;class M{constructor(F){this._stream=F,this._reader=null,this._loaded=0,this._filename=null;const R=F.source;this._withCredentials=R.withCredentials||!1,this._contentLength=R.length,this._headersCapability=(0,c.createPromiseCapability)(),this._disableRange=R.disableRange||!1,this._rangeChunkSize=R.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!R.disableStream,this._isRangeSupported=!R.disableRange,this._headers=G(this._stream.httpHeaders);const A=R.url;fetch(A,q(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,Q.validateResponseStatus)(l.status))throw(0,Q.createResponseStatusError)(l.status,A);this._reader=l.body.getReader(),this._headersCapability.resolve();const d=v=>l.headers.get(v),{allowRangeRequests:i,suggestedLength:p}=(0,Q.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=p||this._contentLength,this._filename=(0,Q.extractFilenameFromHeader)(d),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:F,done:R}=await this._reader.read();return R?{value:F,done:R}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController&&this._abortController.abort()}}class m{constructor(F,R,A){this._stream=F,this._reader=null,this._loaded=0;const l=F.source;this._withCredentials=l.withCredentials||!1,this._readCapability=(0,c.createPromiseCapability)(),this._isStreamingSupported=!l.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=G(this._stream.httpHeaders),this._headers.append("Range",`bytes=${R}-${A-1}`);const d=l.url;fetch(d,q(this._headers,this._withCredentials,this._abortController)).then(i=>{if(!(0,Q.validateResponseStatus)(i.status))throw(0,Q.createResponseStatusError)(i.status,d);this._readCapability.resolve(),this._reader=i.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:F,done:R}=await this._reader.read();return R?{value:F,done:R}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(J){var g=__webpack_module_cache__[J];if(g!==void 0)return g.exports;var V=__webpack_module_cache__[J]={exports:{}};return __webpack_modules__[J](V,V.exports,__w_pdfjs_require__),V.exports}var __webpack_exports__={};return(()=>{var J=__webpack_exports__;Object.defineProperty(J,"__esModule",{value:!0}),Object.defineProperty(J,"AnnotationLayer",{enumerable:!0,get:function(){return Q.AnnotationLayer}}),Object.defineProperty(J,"AnnotationMode",{enumerable:!0,get:function(){return g.AnnotationMode}}),Object.defineProperty(J,"CMapCompressionType",{enumerable:!0,get:function(){return g.CMapCompressionType}}),Object.defineProperty(J,"GlobalWorkerOptions",{enumerable:!0,get:function(){return q.GlobalWorkerOptions}}),Object.defineProperty(J,"InvalidPDFException",{enumerable:!0,get:function(){return g.InvalidPDFException}}),Object.defineProperty(J,"LoopbackPort",{enumerable:!0,get:function(){return V.LoopbackPort}}),Object.defineProperty(J,"MissingPDFException",{enumerable:!0,get:function(){return g.MissingPDFException}}),Object.defineProperty(J,"OPS",{enumerable:!0,get:function(){return g.OPS}}),Object.defineProperty(J,"PDFDataRangeTransport",{enumerable:!0,get:function(){return V.PDFDataRangeTransport}}),Object.defineProperty(J,"PDFDateString",{enumerable:!0,get:function(){return c.PDFDateString}}),Object.defineProperty(J,"PDFWorker",{enumerable:!0,get:function(){return V.PDFWorker}}),Object.defineProperty(J,"PasswordResponses",{enumerable:!0,get:function(){return g.PasswordResponses}}),Object.defineProperty(J,"PermissionFlag",{enumerable:!0,get:function(){return g.PermissionFlag}}),Object.defineProperty(J,"PixelsPerInch",{enumerable:!0,get:function(){return c.PixelsPerInch}}),Object.defineProperty(J,"RenderingCancelledException",{enumerable:!0,get:function(){return c.RenderingCancelledException}}),Object.defineProperty(J,"SVGGraphics",{enumerable:!0,get:function(){return M.SVGGraphics}}),Object.defineProperty(J,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return g.UNSUPPORTED_FEATURES}}),Object.defineProperty(J,"UnexpectedResponseException",{enumerable:!0,get:function(){return g.UnexpectedResponseException}}),Object.defineProperty(J,"Util",{enumerable:!0,get:function(){return g.Util}}),Object.defineProperty(J,"VerbosityLevel",{enumerable:!0,get:function(){return g.VerbosityLevel}}),Object.defineProperty(J,"XfaLayer",{enumerable:!0,get:function(){return m.XfaLayer}}),Object.defineProperty(J,"build",{enumerable:!0,get:function(){return V.build}}),Object.defineProperty(J,"createPromiseCapability",{enumerable:!0,get:function(){return g.createPromiseCapability}}),Object.defineProperty(J,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return g.createValidAbsoluteUrl}}),Object.defineProperty(J,"getDocument",{enumerable:!0,get:function(){return V.getDocument}}),Object.defineProperty(J,"getFilenameFromUrl",{enumerable:!0,get:function(){return c.getFilenameFromUrl}}),Object.defineProperty(J,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return c.getPdfFilenameFromUrl}}),Object.defineProperty(J,"getXfaPageViewport",{enumerable:!0,get:function(){return c.getXfaPageViewport}}),Object.defineProperty(J,"isPdfFile",{enumerable:!0,get:function(){return c.isPdfFile}}),Object.defineProperty(J,"loadScript",{enumerable:!0,get:function(){return c.loadScript}}),Object.defineProperty(J,"renderTextLayer",{enumerable:!0,get:function(){return U.renderTextLayer}}),Object.defineProperty(J,"shadow",{enumerable:!0,get:function(){return g.shadow}}),Object.defineProperty(J,"version",{enumerable:!0,get:function(){return V.version}});var g=__w_pdfjs_require__(1),V=__w_pdfjs_require__(4),c=__w_pdfjs_require__(5),Q=__w_pdfjs_require__(20),q=__w_pdfjs_require__(13),G=__w_pdfjs_require__(3),U=__w_pdfjs_require__(23),M=__w_pdfjs_require__(24),m=__w_pdfjs_require__(22);if(G.isNodeJS){const{PDFNodeStream:T}=__w_pdfjs_require__(25);(0,V.setPDFNetworkStreamFactory)(F=>new T(F))}else{const{PDFNetworkStream:T}=__w_pdfjs_require__(28),{PDFFetchStream:F}=__w_pdfjs_require__(29);(0,V.setPDFNetworkStreamFactory)(R=>(0,c.isValidFetchUrl)(R.url)?new F(R):new T(R))}})(),__webpack_exports__})())})(pdf);let libPath="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.14.305",pdfjsLibPath=libPath,pdfjsWorkerSrc=pdfjsLibPath+"/build/pdf.worker.min.js";const _withScopeId=J=>(pushScopeId("data-v-5a2da71a"),J=J(),popScopeId(),J),_hoisted_1={class:"container"},_hoisted_2={key:0,class:"process"},_hoisted_3=_withScopeId(()=>createBaseVNode("div",{class:"text"},"\u6B63\u5728\u751F\u6210\u56FE\u7247\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85",-1)),_sfc_main=defineComponent({__name:"PDF-to-Image",setup(J){let g=useDialogStore();pdf.exports.GlobalWorkerOptions.workerSrc=pdfjsWorkerSrc;let V=ref(!1),c=ref(0),Q=q=>{let G=function(U){let M=q[U],m=new FileReader;m.onload=function(){pdf.exports.getDocument({url:m.result,cMapPacked:!0,cMapUrl:pdfjsLibPath+"/cmaps/"}).promise.then(T=>{let F=function(R){T.getPage(R+1).then(async function(A){let l=A.getViewport({scale:1}),d=document.createElement("canvas"),i=d.getContext("2d",{willReadFrequently:!0}),p=3*96/72;d.width=Math.floor(l.width*p),d.height=Math.floor(l.height*p),A.render({canvasContext:i,transform:[p,0,0,p,0,0],viewport:l}).promise.then(function(){let b=d.toDataURL("image/jpeg"),C=document.createElement("a");C.href=b,C.download=M.name.replace(".pdf","")+(T.numPages>1?"_"+(R+1):"")+".jpg",C.click();let e=+((U+R/T.numPages)/q.length*100).toFixed(2);c.value=e>99.99?99.99:e,R+1>=T.numPages?U+1>=q.length?(c.value=100,g.openDialog({id:"confirm",data:["\u6E29\u99A8\u63D0\u793A","\u6240\u6709PDF\u6587\u4EF6\u5DF2\u5168\u90E8\u8F6C\u6362\u6210\u56FE\u7247\uFF0C\u8BF7\u53BB\u6D4F\u89C8\u5668\u9ED8\u8BA4\u4E0B\u8F7D\u5730\u65B9\u67E5\u770B\uFF01",!0],callback(){V.value=!1,c.value=0}})):G(U+1):F(R+1)})})};F(0)}).catch(T=>{console.error(T)})},m.readAsDataURL(M)};G(0),V.value=!0};return(q,G)=>(openBlock(),createElementBlock("div",_hoisted_1,[createVNode(uiSelectFile,{onChange:unref(Q),title:"PDF\u8F6C\u56FE\u7247",tips:"\u9009\u62E9\u4E00\u4EFD\u6216\u591A\u4EFDPDF\u6587\u4EF6\u540E\uFF0C\u53EF\u4EE5\u628A\u8FD9\u4E9B\u6587\u4EF6\u8F6C\u6210\u56FE\u7247",type:"pdf"},null,8,["onChange"]),unref(V)?(openBlock(),createElementBlock("div",_hoisted_2,[_hoisted_3,createBaseVNode("div",{class:"line",style:normalizeStyle({borderLeftWidth:+(unref(c)*3+1)+"px"})},[createBaseVNode("span",null," \u8FDB\u5EA6\uFF1A"+toDisplayString(unref(c))+"% ",1)],4)])):createCommentVNode("",!0)]))}}),PDFToImage_vue_vue_type_style_index_0_scoped_5a2da71a_lang="",PDFToImage=_export_sfc(_sfc_main,[["__scopeId","data-v-5a2da71a"]]);export{PDFToImage as default};
