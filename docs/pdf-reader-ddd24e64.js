var $t=Object.defineProperty;var zt=(J,g,H)=>g in J?$t(J,g,{enumerable:!0,configurable:!0,writable:!0,value:H}):J[g]=H;var Ut=(J,g,H)=>(zt(J,typeof g!="symbol"?g+"":g,H),H),Gt=(J,g,H)=>{if(!g.has(J))throw TypeError("Cannot "+H)};var dt=(J,g,H)=>(Gt(J,g,"read from private field"),H?H.call(J):g.get(J)),xt=(J,g,H)=>{if(g.has(J))throw TypeError("Cannot add the same private member more than once");g instanceof WeakSet?g.add(J):g.set(J,H)},Pt=(J,g,H,c)=>(Gt(J,g,"write to private field"),c?c.call(J,H):g.set(J,H),H),Xt=(J,g,H,c)=>({set _(Q){Pt(J,g,Q,H)},get _(){return dt(J,g,c)}}),Lt=(J,g,H)=>(Gt(J,g,"access private method"),H);import{d as defineComponent,u as useDialogStore,b as createElementBlock,e as createBaseVNode,n as normalizeStyle,t as toDisplayString,f as unref,r as renderSlot,o as openBlock,_ as _export_sfc,g as ref,c as createVNode,a as createTextVNode}from"./index-0fa0c183.js";const _hoisted_1={class:"app-frame-view"},_hoisted_2={class:"title"},_sfc_main=defineComponent({__name:"app-frame",props:{icon:{type:String,default:""},title:{type:String,default:""}},setup(J){let g=useDialogStore();return(H,c)=>(openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("h2",{style:normalizeStyle({backgroundImage:"url("+J.icon+")"})},toDisplayString(J.title),5),createBaseVNode("div",{class:"close",title:"\u5173\u95ED",onClick:c[0]||(c[0]=Q=>unref(g).closeDialog())})]),renderSlot(H.$slots,"default",{},void 0,!0)]))}}),appFrame_vue_vue_type_style_index_0_scoped_3cd3e1f1_lang="",AppFrame=_export_sfc(_sfc_main,[["__scopeId","data-v-3cd3e1f1"]]);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(J){var g=J.default;if(typeof g=="function"){var H=function(){return g.apply(this,arguments)};H.prototype=g.prototype}else H={};return Object.defineProperty(H,"__esModule",{value:!0}),Object.keys(J).forEach(function(c){var Q=Object.getOwnPropertyDescriptor(J,c);Object.defineProperty(H,c,Q.get?Q:{enumerable:!0,get:function(){return J[c]}})}),H}function commonjsRequire(J){throw new Error('Could not dynamically require "'+J+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(g,H){module.exports=H()})(commonjsGlobal,()=>(()=>{var __webpack_modules__=[,(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.VerbosityLevel=g.Util=g.UnknownErrorException=g.UnexpectedResponseException=g.UNSUPPORTED_FEATURES=g.TextRenderingMode=g.StreamType=g.RenderingIntentFlag=g.PermissionFlag=g.PasswordResponses=g.PasswordException=g.PageActionEventType=g.OPS=g.MissingPDFException=g.InvalidPDFException=g.ImageKind=g.IDENTITY_MATRIX=g.FormatError=g.FontType=g.FeatureTest=g.FONT_IDENTITY_MATRIX=g.DocumentActionEventType=g.CMapCompressionType=g.BaseException=g.AnnotationType=g.AnnotationStateModelType=g.AnnotationReviewState=g.AnnotationReplyType=g.AnnotationMode=g.AnnotationMarkedState=g.AnnotationFlag=g.AnnotationFieldFlag=g.AnnotationBorderStyleType=g.AnnotationActionEventType=g.AbortException=void 0,g.arrayByteLength=N,g.arraysToBytes=O,g.assert=Y,g.bytesToString=A,g.createPromiseCapability=_t,g.createValidAbsoluteUrl=ot,g.escapeString=At,g.getModificationDate=Et,g.getVerbosityLevel=B,g.info=z,g.isArrayBuffer=Tt,g.isArrayEqual=yt,g.isAscii=mt,g.objectFromMap=X,g.objectSize=L,g.setVerbosityLevel=$,g.shadow=S,g.string32=W,g.stringToBytes=w,g.stringToPDFString=nt,g.stringToUTF16BEString=ut,g.stringToUTF8String=gt,g.unreachable=Z,g.utf8StringToString=St,g.warn=K,H(2);const c=[1,0,0,1,0,0];g.IDENTITY_MATRIX=c;const Q=[.001,0,0,.001,0,0];g.FONT_IDENTITY_MATRIX=Q;const q={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};g.RenderingIntentFlag=q;const G={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};g.AnnotationMode=G;const U={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};g.PermissionFlag=U;const R={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};g.TextRenderingMode=R;const _={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};g.ImageKind=_;const T={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};g.AnnotationType=T;const F={MARKED:"Marked",REVIEW:"Review"};g.AnnotationStateModelType=F;const M={MARKED:"Marked",UNMARKED:"Unmarked"};g.AnnotationMarkedState=M;const b={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};g.AnnotationReviewState=b;const l={GROUP:"Group",REPLY:"R"};g.AnnotationReplyType=l;const u={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};g.AnnotationFlag=u;const r={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};g.AnnotationFieldFlag=r;const p={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};g.AnnotationBorderStyleType=p;const C={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};g.AnnotationActionEventType=C;const y={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};g.DocumentActionEventType=y;const v={O:"PageOpen",C:"PageClose"};g.PageActionEventType=v;const e={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};g.StreamType=e;const o={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};g.FontType=o;const m={ERRORS:0,WARNINGS:1,INFOS:5};g.VerbosityLevel=m;const P={NONE:0,BINARY:1,STREAM:2};g.CMapCompressionType=P;const x={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};g.OPS=x;const k={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};g.UNSUPPORTED_FEATURES=k;const E={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};g.PasswordResponses=E;let D=m.WARNINGS;function $(V){Number.isInteger(V)&&(D=V)}function B(){return D}function z(V){D>=m.INFOS&&console.log(`Info: ${V}`)}function K(V){D>=m.WARNINGS&&console.log(`Warning: ${V}`)}function Z(V){throw new Error(V)}function Y(V,I){V||Z(I)}function et(V){if(!V)return!1;switch(V.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ot(V,I=null,j=null){if(!V)return null;try{if(j&&typeof V=="string"){if(j.addDefaultProtocol&&V.startsWith("www.")){const ht=V.match(/\./g);ht&&ht.length>=2&&(V=`http://${V}`)}if(j.tryConvertEncoding)try{V=gt(V)}catch{}}const at=I?new URL(V,I):new URL(V);if(et(at))return at}catch{}return null}function S(V,I,j){return Object.defineProperty(V,I,{value:j,enumerable:!0,configurable:!0,writable:!1}),j}const a=function(){function I(j,at){this.constructor===I&&Z("Cannot initialize BaseException."),this.message=j,this.name=at}return I.prototype=new Error,I.constructor=I,I}();g.BaseException=a;class s extends a{constructor(I,j){super(I,"PasswordException"),this.code=j}}g.PasswordException=s;class f extends a{constructor(I,j){super(I,"UnknownErrorException"),this.details=j}}g.UnknownErrorException=f;class t extends a{constructor(I){super(I,"InvalidPDFException")}}g.InvalidPDFException=t;class n extends a{constructor(I){super(I,"MissingPDFException")}}g.MissingPDFException=n;class i extends a{constructor(I,j){super(I,"UnexpectedResponseException"),this.status=j}}g.UnexpectedResponseException=i;class d extends a{constructor(I){super(I,"FormatError")}}g.FormatError=d;class h extends a{constructor(I){super(I,"AbortException")}}g.AbortException=h;function A(V){(typeof V!="object"||V===null||V.length===void 0)&&Z("Invalid argument for bytesToString");const I=V.length,j=8192;if(I<j)return String.fromCharCode.apply(null,V);const at=[];for(let ht=0;ht<I;ht+=j){const pt=Math.min(ht+j,I),ft=V.subarray(ht,pt);at.push(String.fromCharCode.apply(null,ft))}return at.join("")}function w(V){typeof V!="string"&&Z("Invalid argument for stringToBytes");const I=V.length,j=new Uint8Array(I);for(let at=0;at<I;++at)j[at]=V.charCodeAt(at)&255;return j}function N(V){if(V.length!==void 0)return V.length;if(V.byteLength!==void 0)return V.byteLength;Z("Invalid argument for arrayByteLength")}function O(V){const I=V.length;if(I===1&&V[0]instanceof Uint8Array)return V[0];let j=0;for(let pt=0;pt<I;pt++)j+=N(V[pt]);let at=0;const ht=new Uint8Array(j);for(let pt=0;pt<I;pt++){let ft=V[pt];ft instanceof Uint8Array||(typeof ft=="string"?ft=w(ft):ft=new Uint8Array(ft));const wt=ft.byteLength;ht.set(ft,at),at+=wt}return ht}function W(V){return String.fromCharCode(V>>24&255,V>>16&255,V>>8&255,V&255)}function L(V){return Object.keys(V).length}function X(V){const I=Object.create(null);for(const[j,at]of V)I[j]=at;return I}function st(){const V=new Uint8Array(4);return V[0]=1,new Uint32Array(V.buffer,0,1)[0]===1}function rt(){try{return new Function(""),!0}catch{return!1}}class it{static get isLittleEndian(){return S(this,"isLittleEndian",st())}static get isEvalSupported(){return S(this,"isEvalSupported",rt())}static get isOffscreenCanvasSupported(){return S(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}g.FeatureTest=it;const tt=[...Array(256).keys()].map(V=>V.toString(16).padStart(2,"0"));class lt{static makeHexColor(I,j,at){return`#${tt[I]}${tt[j]}${tt[at]}`}static scaleMinMax(I,j){let at;I[0]?(I[0]<0&&(at=j[0],j[0]=j[1],j[1]=at),j[0]*=I[0],j[1]*=I[0],I[3]<0&&(at=j[2],j[2]=j[3],j[3]=at),j[2]*=I[3],j[3]*=I[3]):(at=j[0],j[0]=j[2],j[2]=at,at=j[1],j[1]=j[3],j[3]=at,I[1]<0&&(at=j[2],j[2]=j[3],j[3]=at),j[2]*=I[1],j[3]*=I[1],I[2]<0&&(at=j[0],j[0]=j[1],j[1]=at),j[0]*=I[2],j[1]*=I[2]),j[0]+=I[4],j[1]+=I[4],j[2]+=I[5],j[3]+=I[5]}static transform(I,j){return[I[0]*j[0]+I[2]*j[1],I[1]*j[0]+I[3]*j[1],I[0]*j[2]+I[2]*j[3],I[1]*j[2]+I[3]*j[3],I[0]*j[4]+I[2]*j[5]+I[4],I[1]*j[4]+I[3]*j[5]+I[5]]}static applyTransform(I,j){const at=I[0]*j[0]+I[1]*j[2]+j[4],ht=I[0]*j[1]+I[1]*j[3]+j[5];return[at,ht]}static applyInverseTransform(I,j){const at=j[0]*j[3]-j[1]*j[2],ht=(I[0]*j[3]-I[1]*j[2]+j[2]*j[5]-j[4]*j[3])/at,pt=(-I[0]*j[1]+I[1]*j[0]+j[4]*j[1]-j[5]*j[0])/at;return[ht,pt]}static getAxialAlignedBoundingBox(I,j){const at=lt.applyTransform(I,j),ht=lt.applyTransform(I.slice(2,4),j),pt=lt.applyTransform([I[0],I[3]],j),ft=lt.applyTransform([I[2],I[1]],j);return[Math.min(at[0],ht[0],pt[0],ft[0]),Math.min(at[1],ht[1],pt[1],ft[1]),Math.max(at[0],ht[0],pt[0],ft[0]),Math.max(at[1],ht[1],pt[1],ft[1])]}static inverseTransform(I){const j=I[0]*I[3]-I[1]*I[2];return[I[3]/j,-I[1]/j,-I[2]/j,I[0]/j,(I[2]*I[5]-I[4]*I[3])/j,(I[4]*I[1]-I[5]*I[0])/j]}static apply3dTransform(I,j){return[I[0]*j[0]+I[1]*j[1]+I[2]*j[2],I[3]*j[0]+I[4]*j[1]+I[5]*j[2],I[6]*j[0]+I[7]*j[1]+I[8]*j[2]]}static singularValueDecompose2dScale(I){const j=[I[0],I[2],I[1],I[3]],at=I[0]*j[0]+I[1]*j[2],ht=I[0]*j[1]+I[1]*j[3],pt=I[2]*j[0]+I[3]*j[2],ft=I[2]*j[1]+I[3]*j[3],wt=(at+ft)/2,Rt=Math.sqrt((at+ft)**2-4*(at*ft-pt*ht))/2,Ft=wt+Rt||1,Ct=wt-Rt||1;return[Math.sqrt(Ft),Math.sqrt(Ct)]}static normalizeRect(I){const j=I.slice(0);return I[0]>I[2]&&(j[0]=I[2],j[2]=I[0]),I[1]>I[3]&&(j[1]=I[3],j[3]=I[1]),j}static intersect(I,j){const at=Math.max(Math.min(I[0],I[2]),Math.min(j[0],j[2])),ht=Math.min(Math.max(I[0],I[2]),Math.max(j[0],j[2]));if(at>ht)return null;const pt=Math.max(Math.min(I[1],I[3]),Math.min(j[1],j[3])),ft=Math.min(Math.max(I[1],I[3]),Math.max(j[1],j[3]));return pt>ft?null:[at,pt,ht,ft]}static bezierBoundingBox(I,j,at,ht,pt,ft,wt,Rt){const Ft=[],Ct=[[],[]];let Mt,kt,It,bt,Nt,jt,Bt,Wt;for(let qt=0;qt<2;++qt){if(qt===0?(kt=6*I-12*at+6*pt,Mt=-3*I+9*at-9*pt+3*wt,It=3*at-3*I):(kt=6*j-12*ht+6*ft,Mt=-3*j+9*ht-9*ft+3*Rt,It=3*ht-3*j),Math.abs(Mt)<1e-12){if(Math.abs(kt)<1e-12)continue;bt=-It/kt,0<bt&&bt<1&&Ft.push(bt);continue}Bt=kt*kt-4*It*Mt,Wt=Math.sqrt(Bt),!(Bt<0)&&(Nt=(-kt+Wt)/(2*Mt),0<Nt&&Nt<1&&Ft.push(Nt),jt=(-kt-Wt)/(2*Mt),0<jt&&jt<1&&Ft.push(jt))}let Ot=Ft.length,vt;const Dt=Ot;for(;Ot--;)bt=Ft[Ot],vt=1-bt,Ct[0][Ot]=vt*vt*vt*I+3*vt*vt*bt*at+3*vt*bt*bt*pt+bt*bt*bt*wt,Ct[1][Ot]=vt*vt*vt*j+3*vt*vt*bt*ht+3*vt*bt*bt*ft+bt*bt*bt*Rt;return Ct[0][Dt]=I,Ct[1][Dt]=j,Ct[0][Dt+1]=wt,Ct[1][Dt+1]=Rt,Ct[0].length=Ct[1].length=Dt+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}g.Util=lt;const ct=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function nt(V){if(V[0]>="\xEF"){let j;if(V[0]==="\xFE"&&V[1]==="\xFF"?j="utf-16be":V[0]==="\xFF"&&V[1]==="\xFE"?j="utf-16le":V[0]==="\xEF"&&V[1]==="\xBB"&&V[2]==="\xBF"&&(j="utf-8"),j)try{const at=new TextDecoder(j,{fatal:!0}),ht=w(V);return at.decode(ht)}catch(at){K(`stringToPDFString: "${at}".`)}}const I=[];for(let j=0,at=V.length;j<at;j++){const ht=ct[V.charCodeAt(j)];I.push(ht?String.fromCharCode(ht):V.charAt(j))}return I.join("")}function At(V){return V.replace(/([()\\\n\r])/g,I=>I===`
`?"\\n":I==="\r"?"\\r":`\\${I}`)}function mt(V){return/^[\x00-\x7F]*$/.test(V)}function ut(V){const I=["\xFE\xFF"];for(let j=0,at=V.length;j<at;j++){const ht=V.charCodeAt(j);I.push(String.fromCharCode(ht>>8&255),String.fromCharCode(ht&255))}return I.join("")}function gt(V){return decodeURIComponent(escape(V))}function St(V){return unescape(encodeURIComponent(V))}function Tt(V){return typeof V=="object"&&V!==null&&V.byteLength!==void 0}function yt(V,I){if(V.length!==I.length)return!1;for(let j=0,at=V.length;j<at;j++)if(V[j]!==I[j])return!1;return!0}function Et(V=new Date){return[V.getUTCFullYear().toString(),(V.getUTCMonth()+1).toString().padStart(2,"0"),V.getUTCDate().toString().padStart(2,"0"),V.getUTCHours().toString().padStart(2,"0"),V.getUTCMinutes().toString().padStart(2,"0"),V.getUTCSeconds().toString().padStart(2,"0")].join("")}function _t(){const V=Object.create(null);let I=!1;return Object.defineProperty(V,"settled",{get(){return I}}),V.promise=new Promise(function(j,at){V.resolve=function(ht){I=!0,j(ht)},V.reject=function(ht){I=!0,at(ht)}}),V}},(J,g,H)=>{H(3)},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.isNodeJS=void 0;const H=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");g.isNodeJS=H},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var J,H,c,Q,q,G,U,R,_,Ht,F;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(5),_font_loader=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(13),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(14),_metadata=__w_pdfjs_require__(15),_optional_content_config=__w_pdfjs_require__(16),_transport_stream=__w_pdfjs_require__(17),_xfa_text=__w_pdfjs_require__(18);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:b,NodeCMapReaderFactory:l,NodeStandardFontDataFactory:u}=__w_pdfjs_require__(19);exports.DefaultCanvasFactory=DefaultCanvasFactory=b,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=l,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=u}let createPDFNetworkStream;function setPDFNetworkStreamFactory(b){createPDFNetworkStream=b}function getDocument(b){const l=new PDFDocumentLoadingTask;let u;if(typeof b=="string"||b instanceof URL)u={url:b};else if((0,_util.isArrayBuffer)(b))u={data:b};else if(b instanceof PDFDataRangeTransport)u={range:b};else{if(typeof b!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!b.url&&!b.data&&!b.range)throw new Error("Invalid parameter object: need either .data, .range or .url");u=b}const r=Object.create(null);let p=null,C=null;for(const v in u){const e=u[v];switch(v){case"url":if(typeof window<"u")try{r[v]=new URL(e,window.location).href;continue}catch(o){(0,_util.warn)(`Cannot create valid URL: "${o}".`)}else if(typeof e=="string"||e instanceof URL){r[v]=e.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":p=e;continue;case"worker":C=e;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&e instanceof Buffer)r[v]=new Uint8Array(e);else{if(e instanceof Uint8Array)break;if(typeof e=="string")r[v]=(0,_util.stringToBytes)(e);else if(typeof e=="object"&&e!==null&&!isNaN(e.length))r[v]=new Uint8Array(e);else if((0,_util.isArrayBuffer)(e))r[v]=new Uint8Array(e);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}r[v]=e}if(r.CMapReaderFactory=r.CMapReaderFactory||DefaultCMapReaderFactory,r.StandardFontDataFactory=r.StandardFontDataFactory||DefaultStandardFontDataFactory,r.ignoreErrors=r.stopAtErrors!==!0,r.fontExtraProperties=r.fontExtraProperties===!0,r.pdfBug=r.pdfBug===!0,r.enableXfa=r.enableXfa===!0,(!Number.isInteger(r.rangeChunkSize)||r.rangeChunkSize<1)&&(r.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof r.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(r.docBaseUrl))&&(r.docBaseUrl=null),(!Number.isInteger(r.maxImageSize)||r.maxImageSize<-1)&&(r.maxImageSize=-1),typeof r.cMapUrl!="string"&&(r.cMapUrl=null),typeof r.standardFontDataUrl!="string"&&(r.standardFontDataUrl=null),typeof r.useWorkerFetch!="boolean"&&(r.useWorkerFetch=r.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&r.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof r.isEvalSupported!="boolean"&&(r.isEvalSupported=!0),typeof r.disableFontFace!="boolean"&&(r.disableFontFace=_is_node.isNodeJS),typeof r.useSystemFonts!="boolean"&&(r.useSystemFonts=!_is_node.isNodeJS&&!r.disableFontFace),(typeof r.ownerDocument!="object"||r.ownerDocument===null)&&(r.ownerDocument=globalThis.document),typeof r.disableRange!="boolean"&&(r.disableRange=!1),typeof r.disableStream!="boolean"&&(r.disableStream=!1),typeof r.disableAutoFetch!="boolean"&&(r.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(r.verbosity),!C){const v={verbosity:r.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};C=v.port?PDFWorker.fromPort(v):new PDFWorker(v),l._worker=C}const y=l.docId;return C.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const v=_fetchDocument(C,r,p,y),e=new Promise(function(o){let m;p?m=new _transport_stream.PDFDataTransportStream({length:r.length,initialData:r.initialData,progressiveDone:r.progressiveDone,contentDispositionFilename:r.contentDispositionFilename,disableRange:r.disableRange,disableStream:r.disableStream},p):r.data||(m=createPDFNetworkStream({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream})),o(m)});return Promise.all([v,e]).then(function([o,m]){if(l.destroyed)throw new Error("Loading aborted");const P=new _message_handler.MessageHandler(y,o,C.port),x=new WorkerTransport(P,l,m,r);l._transport=x,P.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(b,l,u,r){if(b.destroyed)throw new Error("Worker was destroyed");u&&(l.length=u.length,l.initialData=u.initialData,l.progressiveDone=u.progressiveDone,l.contentDispositionFilename=u.contentDispositionFilename);const p=await b.messageHandler.sendWithPromise("GetDocRequest",{docId:r,apiVersion:"2.14.305",source:{data:l.data,url:l.url,password:l.password,disableAutoFetch:l.disableAutoFetch,rangeChunkSize:l.rangeChunkSize,length:l.length},maxImageSize:l.maxImageSize,disableFontFace:l.disableFontFace,docBaseUrl:l.docBaseUrl,ignoreErrors:l.ignoreErrors,isEvalSupported:l.isEvalSupported,fontExtraProperties:l.fontExtraProperties,enableXfa:l.enableXfa,useSystemFonts:l.useSystemFonts,cMapUrl:l.useWorkerFetch?l.cMapUrl:null,standardFontDataUrl:l.useWorkerFetch?l.standardFontDataUrl:null});if(b.destroyed)throw new Error("Worker was destroyed");return p}const g=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${Xt(g,J)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var l;this.destroyed=!0,await((l=this._transport)==null?void 0:l.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=g;J=new WeakMap,xt(PDFDocumentLoadingTask,J,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,u,r=!1,p=null){this.length=l,this.initialData=u,this.progressiveDone=r,this.contentDispositionFilename=p,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,u){for(const r of this._rangeListeners)r(l,u)}onDataProgress(l,u){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(l,u)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const u of this._progressiveReadListeners)u(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,u){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,u){this._pdfInfo=l,this._transport=u,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,u,r,p,C=!1){this._pageIndex=l,this._pageInfo=u,this._ownerDocument=p,this._transport=r,this._stats=C?new _display_utils.StatTimer:null,this._pdfBug=C,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:u=this.rotate,offsetX:r=0,offsetY:p=0,dontFlip:C=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:u,offsetX:r,offsetY:p,dontFlip:C})}getAnnotations({intent:l="display"}={}){const u=this._transport.getRenderingIntent(l);let r=this._annotationPromises.get(u.cacheKey);return r||(r=this._transport.getAnnotations(this._pageIndex,u.renderingIntent),this._annotationPromises.set(u.cacheKey,r),r=r.then(p=>{for(const C of p)C.titleObj!==void 0&&Object.defineProperty(C,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),C.titleObj.str}}),C.contentsObj!==void 0&&Object.defineProperty(C,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),C.contentsObj.str}});return p})),r}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:u,intent:r="display",annotationMode:p=_util.AnnotationMode.ENABLE,transform:C=null,imageLayer:y=null,canvasFactory:v=null,background:e=null,optionalContentConfigPromise:o=null,annotationCanvasMap:m=null,pageColors:P=null}){var K,Z;((K=arguments[0])==null?void 0:K.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&p===_util.AnnotationMode.ENABLE&&(p=_util.AnnotationMode.ENABLE_FORMS)),((Z=arguments[0])==null?void 0:Z.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&p===_util.AnnotationMode.ENABLE&&(p=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const x=this._transport.getRenderingIntent(r,p);this.pendingCleanup=!1,o||(o=this._transport.getOptionalContentConfig());let k=this._intentStates.get(x.cacheKey);k||(k=Object.create(null),this._intentStates.set(x.cacheKey,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const E=v||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),D=!!(x.renderingIntent&_util.RenderingIntentFlag.PRINT);k.displayReadyCapability||(k.displayReadyCapability=(0,_util.createPromiseCapability)(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(x));const $=Y=>{k.renderTasks.delete(B),(this.cleanupAfterRender||D)&&(this.pendingCleanup=!0),this._tryCleanup(),Y?(B.capability.reject(Y),this._abortOperatorList({intentState:k,reason:Y instanceof Error?Y:new Error(Y)})):B.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},B=new InternalRenderTask({callback:$,params:{canvasContext:l,viewport:u,transform:C,imageLayer:y,background:e},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:m,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:E,useRequestAnimationFrame:!D,pdfBug:this._pdfBug,pageColors:P});(k.renderTasks||(k.renderTasks=new Set)).add(B);const z=B.task;return Promise.all([k.displayReadyCapability.promise,o]).then(([Y,et])=>{if(this.pendingCleanup){$();return}this._stats&&this._stats.time("Rendering"),B.initializeGraphics({transparency:Y,optionalContentConfig:et}),B.operatorListChanged()}).catch($),z}getOperatorList({intent:l="display",annotationMode:u=_util.AnnotationMode.ENABLE}={}){function r(){C.operatorList.lastChunk&&(C.opListReadCapability.resolve(C.operatorList),C.renderTasks.delete(y))}const p=this._transport.getRenderingIntent(l,u,!0);let C=this._intentStates.get(p.cacheKey);C||(C=Object.create(null),this._intentStates.set(p.cacheKey,C));let y;return C.opListReadCapability||(y=Object.create(null),y.operatorListChanged=r,C.opListReadCapability=(0,_util.createPromiseCapability)(),(C.renderTasks||(C.renderTasks=new Set)).add(y),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(p)),C.opListReadCapability.promise}streamTextContent({disableCombineTextItems:l=!1,includeMarkedContent:u=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:l!==!0,includeMarkedContent:u===!0},{highWaterMark:100,size(p){return p.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));const u=this.streamTextContent(l);return new Promise(function(r,p){function C(){y.read().then(function({value:e,done:o}){if(o){r(v);return}Object.assign(v.styles,e.styles),v.items.push(...e.items),C()},p)}const y=u.getReader(),v={items:[],styles:Object.create(null)};C()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const l=[];for(const u of this._intentStates.values())if(this._abortOperatorList({intentState:u,reason:new Error("Page was destroyed."),force:!0}),!u.opListReadCapability)for(const r of u.renderTasks)l.push(r.completed),r.cancel();this.objs.clear();for(const u of this._bitmaps)u.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(l)}cleanup(l=!1){return this.pendingCleanup=!0,this._tryCleanup(l)}_tryCleanup(l=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:u,operatorList:r}of this._intentStates.values())if(u.size>0||!r.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,l&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const u of this._bitmaps)u.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(l,u){const r=this._intentStates.get(u);!r||(this._stats&&this._stats.timeEnd("Page Request"),r.displayReadyCapability&&r.displayReadyCapability.resolve(l))}_renderPageChunk(l,u){for(let r=0,p=l.length;r<p;r++)u.operatorList.fnArray.push(l.fnArray[r]),u.operatorList.argsArray.push(l.argsArray[r]);u.operatorList.lastChunk=l.lastChunk;for(const r of u.renderTasks)r.operatorListChanged();l.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:l,cacheKey:u}){const p=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:u,annotationStorage:l&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),C=this._intentStates.get(u);C.streamReader=p;const y=()=>{p.read().then(({value:v,done:e})=>{if(e){C.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,C),y())},v=>{if(C.streamReader=null,!this._transport.destroyed){if(C.operatorList){C.operatorList.lastChunk=!0;for(const e of C.renderTasks)e.operatorListChanged();this._tryCleanup()}if(C.displayReadyCapability)C.displayReadyCapability.reject(v);else if(C.opListReadCapability)C.opListReadCapability.reject(v);else throw v}})};y()}_abortOperatorList({intentState:l,reason:u,force:r=!1}){if(!!l.streamReader){if(!r){if(l.renderTasks.size>0)return;if(u instanceof _display_utils.RenderingCancelledException){l.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:l,reason:u,force:!0}),l.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(l.streamReader.cancel(new _util.AbortException(u.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[p,C]of this._intentStates)if(C===l){this._intentStates.delete(p);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(l,u){const r={data:structuredClone(l,u)};this._deferred.then(()=>{for(const p of this._listeners)p.call(this,r)})}addEventListener(l,u){this._listeners.push(u)}removeEventListener(l,u){const r=this._listeners.indexOf(u);this._listeners.splice(r,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const b=(H=document==null?void 0:document.currentScript)==null?void 0:H.src;b&&(PDFWorkerUtil.fallbackWorkerSrc=b.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(b,l){let u;try{if(u=new URL(b),!u.origin||u.origin==="null")return!1}catch{return!1}const r=new URL(l,u);return u.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(b){const l=`importScripts("${b}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class{constructor({name:b=null,port:l=null,verbosity:u=(0,_util.getVerbosityLevel)()}={}){if(l&&dt(_PDFWorker,c).has(l))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=b,this.destroyed=!1,this.verbosity=u,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,l){dt(_PDFWorker,c).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _message_handler.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let b=_PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,b)||(b=PDFWorkerUtil.createCDNWrapper(new URL(b,window.location).href));const l=new Worker(b),u=new _message_handler.MessageHandler("main","worker",l),r=()=>{l.removeEventListener("error",p),u.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},p=()=>{this._webWorker||r()};l.addEventListener("error",p),u.on("test",y=>{if(l.removeEventListener("error",p),this.destroyed){r();return}y?(this._messageHandler=u,this._port=l,this._webWorker=l,this._readyCapability.resolve(),u.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),u.destroy(),l.terminate())}),u.on("ready",y=>{if(l.removeEventListener("error",p),this.destroyed){r();return}try{C()}catch{this._setupFakeWorker()}});const C=()=>{const y=new Uint8Array;u.send("test",y,[y.buffer])};C();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const u=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(u+"_worker",u,l);b.setup(r,l);const p=new _message_handler.MessageHandler(u,u+"_worker",l);this._messageHandler=p,this._readyCapability.resolve(),p.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${b.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),dt(_PDFWorker,c).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return dt(this,c).has(b.port)?dt(this,c).get(b.port):new _PDFWorker(b)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;c=new WeakMap,xt(PDFWorker,c,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(l,u,r,p){xt(this,Q,null);xt(this,q,new Map);xt(this,G,new Map);xt(this,U,null);this.messageHandler=l,this.loadingTask=u,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:u.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:p.ownerDocument,styleElement:p.styleElement}),this._params=p,p.useWorkerFetch||(this.CMapReaderFactory=new p.CMapReaderFactory({baseUrl:p.cMapUrl,isCompressed:p.cMapPacked}),this.StandardFontDataFactory=new p.StandardFontDataFactory({baseUrl:p.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return dt(this,Q)}getRenderingIntent(l,u=_util.AnnotationMode.ENABLE,r=!1){let p=_util.RenderingIntentFlag.DISPLAY,C="";switch(l){case"any":p=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":p=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(u){case _util.AnnotationMode.DISABLE:p+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:p+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:p+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,C=this.annotationStorage.hash;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${u}`)}return r&&(p+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:p,cacheKey:`${p}_${C}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const r of dt(this,q).values())l.push(r._destroy());dt(this,q).clear(),dt(this,G).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const u=this.messageHandler.sendWithPromise("Terminate",null);return l.push(u),Promise.all(l).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),Pt(this,U,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:u}=this;l.on("GetReader",(r,p)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=C=>{this._lastProgress={loaded:C.loaded,total:C.total}},p.onPull=()=>{this._fullReader.read().then(function({value:C,done:y}){if(y){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(C),"GetReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(C),1,[C])}).catch(C=>{p.error(C)})},p.onCancel=C=>{this._fullReader.cancel(C),p.ready.catch(y=>{if(!this.destroyed)throw y})}}),l.on("ReaderHeadersReady",r=>{const p=(0,_util.createPromiseCapability)(),C=this._fullReader;return C.headersReady.then(()=>{var y;(!C.isStreamingSupported||!C.isRangeSupported)&&(this._lastProgress&&((y=u.onProgress)==null||y.call(u,this._lastProgress)),C.onProgress=v=>{var e;(e=u.onProgress)==null||e.call(u,{loaded:v.loaded,total:v.total})}),p.resolve({isStreamingSupported:C.isStreamingSupported,isRangeSupported:C.isRangeSupported,contentLength:C.contentLength})},p.reject),p.promise}),l.on("GetRangeReader",(r,p)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const C=this._networkStream.getRangeReader(r.begin,r.end);if(!C){p.close();return}p.onPull=()=>{C.read().then(function({value:y,done:v}){if(v){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(y),"GetRangeReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(y),1,[y])}).catch(y=>{p.error(y)})},p.onCancel=y=>{C.cancel(y),p.ready.catch(v=>{if(!this.destroyed)throw v})}}),l.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,u._capability.resolve(new PDFDocumentProxy(r,this))}),l.on("DocException",function(r){let p;switch(r.name){case"PasswordException":p=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":p=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":p=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":p=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":p=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}u._capability.reject(p)}),l.on("PasswordRequest",r=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),u.onPassword){const p=C=>{C instanceof Error?this._passwordCapability.reject(C):this._passwordCapability.resolve({password:C})};try{u.onPassword(p,r.code)}catch(C){this._passwordCapability.reject(C)}}else this._passwordCapability.reject(new _util.PasswordException(r.message,r.code));return this._passwordCapability.promise}),l.on("DataLoaded",r=>{var p;(p=u.onProgress)==null||p.call(u,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),l.on("StartRenderPage",r=>{if(this.destroyed)return;dt(this,q).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),l.on("commonobj",([r,p,C])=>{var y;if(!this.destroyed&&!this.commonObjs.has(r))switch(p){case"Font":const v=this._params;if("error"in C){const m=C.error;(0,_util.warn)(`Error during font loading: ${m}`),this.commonObjs.resolve(r,m);break}let e=null;v.pdfBug&&((y=globalThis.FontInspector)==null?void 0:y.enabled)&&(e={registerFont(m,P){globalThis.FontInspector.fontAdded(m,P)}});const o=new _font_loader.FontFaceObject(C,{isEvalSupported:v.isEvalSupported,disableFontFace:v.disableFontFace,ignoreErrors:v.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:e});this.fontLoader.bind(o).catch(m=>l.sendWithPromise("FontFallback",{id:r})).finally(()=>{!v.fontExtraProperties&&o.data&&(o.data=null),this.commonObjs.resolve(r,o)});break;case"FontPath":case"Image":this.commonObjs.resolve(r,C);break;default:throw new Error(`Got unknown common object type ${p}`)}}),l.on("obj",([r,p,C,y])=>{var e;if(this.destroyed)return;const v=dt(this,q).get(p);if(!v.objs.has(r))switch(C){case"Image":v.objs.resolve(r,y);const o=8e6;if(y){let m;if(y.bitmap){const{bitmap:P,width:x,height:k}=y;m=x*k*4,v._bitmaps.add(P)}else m=((e=y.data)==null?void 0:e.length)||0;m>o&&(v.cleanupAfterRender=!0)}break;case"Pattern":v.objs.resolve(r,y);break;default:throw new Error(`Got unknown object type ${C}`)}}),l.on("DocProgress",r=>{var p;this.destroyed||(p=u.onProgress)==null||p.call(u,{loaded:r.loaded,total:r.total})}),l.on("DocStats",r=>{this.destroyed||Pt(this,Q,Object.freeze({streamTypes:Object.freeze(r.streamTypes),fontTypes:Object.freeze(r.fontTypes)}))}),l.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),l.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:l}){var u,r;this.destroyed||(r=(u=this.loadingTask).onUnsupportedFeature)==null||r.call(u,l)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const u=l-1,r=dt(this,G).get(u);if(r)return r;const p=this.messageHandler.sendWithPromise("GetPage",{pageIndex:u}).then(C=>{if(this.destroyed)throw new Error("Transport destroyed");const y=new PDFPageProxy(u,C,this,this._params.ownerDocument,this._params.pdfBug);return dt(this,q).set(u,y),y});return dt(this,G).set(u,p),p}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,u){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:u})}saveDocument(){var l,u;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(u=(l=this._fullReader)==null?void 0:l.filename)!=null?u:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return dt(this,U)||Pt(this,U,this.messageHandler.sendWithPromise("GetMetadata",null).then(l=>{var u,r,p,C;return{info:l[0],metadata:l[1]?new _metadata.Metadata(l[1]):null,contentDispositionFilename:(r=(u=this._fullReader)==null?void 0:u.filename)!=null?r:null,contentLength:(C=(p=this._fullReader)==null?void 0:p.contentLength)!=null?C:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const u of dt(this,q).values())if(!u.cleanup())throw new Error(`startCleanup: Page ${u.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),Pt(this,U,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const l=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l.disableAutoFetch,enableXfa:l.enableXfa})}}Q=new WeakMap,q=new WeakMap,G=new WeakMap,U=new WeakMap;class PDFObjects{constructor(){xt(this,_);xt(this,R,Object.create(null))}get(l,u=null){if(u){const p=Lt(this,_,Ht).call(this,l);return p.capability.promise.then(()=>u(p.data)),null}const r=dt(this,R)[l];if(!(r!=null&&r.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return r.data}has(l){const u=dt(this,R)[l];return(u==null?void 0:u.capability.settled)||!1}resolve(l,u=null){const r=Lt(this,_,Ht).call(this,l);r.data=u,r.capability.resolve()}clear(){Pt(this,R,Object.create(null))}}R=new WeakMap,_=new WeakSet,Ht=function(l){const u=dt(this,R)[l];return u||(dt(this,R)[l]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(l){this._internalRenderTask=l,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;const M=class{constructor({callback:l,params:u,objs:r,commonObjs:p,annotationCanvasMap:C,operatorList:y,pageIndex:v,canvasFactory:e,useRequestAnimationFrame:o=!1,pdfBug:m=!1,pageColors:P=null}){this.callback=l,this.params=u,this.objs=r,this.commonObjs=p,this.annotationCanvasMap=C,this.operatorListIdx=null,this.operatorList=y,this._pageIndex=v,this.canvasFactory=e,this._pdfBug=m,this.pageColors=P,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=o===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=u.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:u}){var e;if(this.cancelled)return;if(this._canvas){if(dt(M,F).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");dt(M,F).add(this._canvas)}this._pdfBug&&((e=globalThis.StepperManager)==null?void 0:e.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:p,transform:C,imageLayer:y,background:v}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,y,u,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:C,viewport:p,transparency:l,background:v}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(l=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&dt(M,F).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&dt(M,F).delete(this._canvas),this.callback())))}};let InternalRenderTask=M;F=new WeakMap,xt(InternalRenderTask,F,new WeakSet);const version="2.14.305";exports.version=version;const build="eaaa8b4ad";exports.build=build},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.StatTimer=g.RenderingCancelledException=g.PixelsPerInch=g.PageViewport=g.PDFDateString=g.DOMStandardFontDataFactory=g.DOMSVGFactory=g.DOMCanvasFactory=g.DOMCMapReaderFactory=void 0,g.deprecated=e,g.getFilenameFromUrl=r,g.getPdfFilenameFromUrl=p,g.getXfaPageViewport=P,g.isDataScheme=l,g.isPdfFile=u,g.isValidFetchUrl=y,g.loadScript=v;var c=H(6),Q=H(1);const q="http://www.w3.org/2000/svg",x=class{};let G=x;Ut(G,"CSS",96),Ut(G,"PDF",72),Ut(G,"PDF_TO_CSS_UNITS",x.CSS/x.PDF),g.PixelsPerInch=G;class U extends c.BaseCanvasFactory{constructor({ownerDocument:E=globalThis.document}={}){super(),this._document=E}_createCanvas(E,D){const $=this._document.createElement("canvas");return $.width=E,$.height=D,$}}g.DOMCanvasFactory=U;async function R(k,E=!1){if(y(k,document.baseURI)){const D=await fetch(k);if(!D.ok)throw new Error(D.statusText);return E?new Uint8Array(await D.arrayBuffer()):(0,Q.stringToBytes)(await D.text())}return new Promise((D,$)=>{const B=new XMLHttpRequest;B.open("GET",k,!0),E&&(B.responseType="arraybuffer"),B.onreadystatechange=()=>{if(B.readyState===XMLHttpRequest.DONE){if(B.status===200||B.status===0){let z;if(E&&B.response?z=new Uint8Array(B.response):!E&&B.responseText&&(z=(0,Q.stringToBytes)(B.responseText)),z){D(z);return}}$(new Error(B.statusText))}},B.send(null)})}class _ extends c.BaseCMapReaderFactory{_fetchData(E,D){return R(E,this.isCompressed).then($=>({cMapData:$,compressionType:D}))}}g.DOMCMapReaderFactory=_;class T extends c.BaseStandardFontDataFactory{_fetchData(E){return R(E,!0)}}g.DOMStandardFontDataFactory=T;class F extends c.BaseSVGFactory{_createSVG(E){return document.createElementNS(q,E)}}g.DOMSVGFactory=F;class M{constructor({viewBox:E,scale:D,rotation:$,offsetX:B=0,offsetY:z=0,dontFlip:K=!1}){this.viewBox=E,this.scale=D,this.rotation=$,this.offsetX=B,this.offsetY=z;const Z=(E[2]+E[0])/2,Y=(E[3]+E[1])/2;let et,ot,S,a;switch($%=360,$<0&&($+=360),$){case 180:et=-1,ot=0,S=0,a=1;break;case 90:et=0,ot=1,S=1,a=0;break;case 270:et=0,ot=-1,S=-1,a=0;break;case 0:et=1,ot=0,S=0,a=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}K&&(S=-S,a=-a);let s,f,t,n;et===0?(s=Math.abs(Y-E[1])*D+B,f=Math.abs(Z-E[0])*D+z,t=Math.abs(E[3]-E[1])*D,n=Math.abs(E[2]-E[0])*D):(s=Math.abs(Z-E[0])*D+B,f=Math.abs(Y-E[1])*D+z,t=Math.abs(E[2]-E[0])*D,n=Math.abs(E[3]-E[1])*D),this.transform=[et*D,ot*D,S*D,a*D,s-et*D*Z-S*D*Y,f-ot*D*Z-a*D*Y],this.width=t,this.height=n}clone({scale:E=this.scale,rotation:D=this.rotation,offsetX:$=this.offsetX,offsetY:B=this.offsetY,dontFlip:z=!1}={}){return new M({viewBox:this.viewBox.slice(),scale:E,rotation:D,offsetX:$,offsetY:B,dontFlip:z})}convertToViewportPoint(E,D){return Q.Util.applyTransform([E,D],this.transform)}convertToViewportRectangle(E){const D=Q.Util.applyTransform([E[0],E[1]],this.transform),$=Q.Util.applyTransform([E[2],E[3]],this.transform);return[D[0],D[1],$[0],$[1]]}convertToPdfPoint(E,D){return Q.Util.applyInverseTransform([E,D],this.transform)}}g.PageViewport=M;class b extends Q.BaseException{constructor(E,D){super(E,"RenderingCancelledException"),this.type=D}}g.RenderingCancelledException=b;function l(k){const E=k.length;let D=0;for(;D<E&&k[D].trim()==="";)D++;return k.substring(D,D+5).toLowerCase()==="data:"}function u(k){return typeof k=="string"&&/\.pdf$/i.test(k)}function r(k){const E=k.indexOf("#"),D=k.indexOf("?"),$=Math.min(E>0?E:k.length,D>0?D:k.length);return k.substring(k.lastIndexOf("/",$)+1,$)}function p(k,E="document.pdf"){if(typeof k!="string")return E;if(l(k))return(0,Q.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),E;const D=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,$=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,B=D.exec(k);let z=$.exec(B[1])||$.exec(B[2])||$.exec(B[3]);if(z&&(z=z[0],z.includes("%")))try{z=$.exec(decodeURIComponent(z))[0]}catch{}return z||E}class C{constructor(){this.started=Object.create(null),this.times=[]}time(E){E in this.started&&(0,Q.warn)(`Timer is already running for ${E}`),this.started[E]=Date.now()}timeEnd(E){E in this.started||(0,Q.warn)(`Timer has not been started for ${E}`),this.times.push({name:E,start:this.started[E],end:Date.now()}),delete this.started[E]}toString(){const E=[];let D=0;for(const $ of this.times){const B=$.name;B.length>D&&(D=B.length)}for(const $ of this.times){const B=$.end-$.start;E.push(`${$.name.padEnd(D)} ${B}ms
`)}return E.join("")}}g.StatTimer=C;function y(k,E){try{const{protocol:D}=E?new URL(k,E):new URL(k);return D==="http:"||D==="https:"}catch{return!1}}function v(k,E=!1){return new Promise((D,$)=>{const B=document.createElement("script");B.src=k,B.onload=function(z){E&&B.remove(),D(z)},B.onerror=function(){$(new Error(`Cannot load script at: ${B.src}`))},(document.head||document.documentElement).appendChild(B)})}function e(k){console.log("Deprecated API usage: "+k)}let o;class m{static toDateObject(E){if(!E||typeof E!="string")return null;o||(o=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const D=o.exec(E);if(!D)return null;const $=parseInt(D[1],10);let B=parseInt(D[2],10);B=B>=1&&B<=12?B-1:0;let z=parseInt(D[3],10);z=z>=1&&z<=31?z:1;let K=parseInt(D[4],10);K=K>=0&&K<=23?K:0;let Z=parseInt(D[5],10);Z=Z>=0&&Z<=59?Z:0;let Y=parseInt(D[6],10);Y=Y>=0&&Y<=59?Y:0;const et=D[7]||"Z";let ot=parseInt(D[8],10);ot=ot>=0&&ot<=23?ot:0;let S=parseInt(D[9],10)||0;return S=S>=0&&S<=59?S:0,et==="-"?(K+=ot,Z+=S):et==="+"&&(K-=ot,Z-=S),new Date(Date.UTC($,B,z,K,Z,Y))}}g.PDFDateString=m;function P(k,{scale:E=1,rotation:D=0}){const{width:$,height:B}=k.attributes.style,z=[0,0,parseInt($),parseInt(B)];return new M({viewBox:z,scale:E,rotation:D})}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.BaseStandardFontDataFactory=g.BaseSVGFactory=g.BaseCanvasFactory=g.BaseCMapReaderFactory=void 0;var c=H(1);class Q{constructor(){this.constructor===Q&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_,T){if(_<=0||T<=0)throw new Error("Invalid canvas size");const F=this._createCanvas(_,T);return{canvas:F,context:F.getContext("2d")}}reset(_,T,F){if(!_.canvas)throw new Error("Canvas is not specified");if(T<=0||F<=0)throw new Error("Invalid canvas size");_.canvas.width=T,_.canvas.height=F}destroy(_){if(!_.canvas)throw new Error("Canvas is not specified");_.canvas.width=0,_.canvas.height=0,_.canvas=null,_.context=null}_createCanvas(_,T){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}g.BaseCanvasFactory=Q;class q{constructor({baseUrl:_=null,isCompressed:T=!1}){this.constructor===q&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_,this.isCompressed=T}async fetch({name:_}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_)throw new Error("CMap name must be specified.");const T=this.baseUrl+_+(this.isCompressed?".bcmap":""),F=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData(T,F).catch(M=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${T}`)})}_fetchData(_,T){(0,c.unreachable)("Abstract method `_fetchData` called.")}}g.BaseCMapReaderFactory=q;class G{constructor({baseUrl:_=null}){this.constructor===G&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_}async fetch({filename:_}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_)throw new Error("Font filename must be specified.");const T=`${this.baseUrl}${_}`;return this._fetchData(T).catch(F=>{throw new Error(`Unable to load font data at: ${T}`)})}_fetchData(_){(0,c.unreachable)("Abstract method `_fetchData` called.")}}g.BaseStandardFontDataFactory=G;class U{constructor(){this.constructor===U&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(_,T){if(_<=0||T<=0)throw new Error("Invalid SVG dimensions");const F=this._createSVG("svg:svg");return F.setAttribute("version","1.1"),F.setAttribute("width",`${_}px`),F.setAttribute("height",`${T}px`),F.setAttribute("preserveAspectRatio","none"),F.setAttribute("viewBox",`0 0 ${_} ${T}`),F}createElement(_){if(typeof _!="string")throw new Error("Invalid SVG element type");return this._createSVG(_)}_createSVG(_){(0,c.unreachable)("Abstract method `_createSVG` called.")}}g.BaseSVGFactory=U},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.FontLoader=g.FontFaceObject=void 0;var c=H(1);class Q{constructor({docId:R,onUnsupportedFeature:_,ownerDocument:T=globalThis.document,styleElement:F=null}){this.constructor===Q&&(0,c.unreachable)("Cannot initialize BaseFontLoader."),this.docId=R,this._onUnsupportedFeature=_,this._document=T,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(R){this.nativeFontFaces.push(R),this._document.fonts.add(R)}insertRule(R){let _=this.styleElement;_||(_=this.styleElement=this._document.createElement("style"),_.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(_));const T=_.sheet;T.insertRule(R,T.cssRules.length)}clear(){for(const R of this.nativeFontFaces)this._document.fonts.delete(R);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(R){if(R.attached||R.missingFile)return;if(R.attached=!0,this.isFontLoadingAPISupported){const T=R.createNativeFontFace();if(T){this.addNativeFontFace(T);try{await T.loaded}catch(F){throw this._onUnsupportedFeature({featureId:c.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,c.warn)(`Failed to load font '${T.family}': '${F}'.`),R.disableFontFace=!0,F}}return}const _=R.createFontFaceRule();if(_){if(this.insertRule(_),this.isSyncFontLoadingSupported)return;await new Promise(T=>{const F=this._queueLoadingCallback(T);this._prepareFontLoadEvent([_],[R],F)})}}_queueLoadingCallback(R){(0,c.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var _;const R=!!((_=this._document)!=null&&_.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",R)}get isSyncFontLoadingSupported(){(0,c.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,c.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(R,_,T){(0,c.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let q;g.FontLoader=q,g.FontLoader=q=class extends Q{constructor(R){super(R),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let R=!1;if(typeof navigator>"u")R=!0;else{const _=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(_==null?void 0:_[1])>=14&&(R=!0)}return(0,c.shadow)(this,"isSyncFontLoadingSupported",R)}_queueLoadingCallback(R){function _(){for((0,c.assert)(!F.done,"completeRequest() cannot be called twice."),F.done=!0;T.requests.length>0&&T.requests[0].done;){const M=T.requests.shift();setTimeout(M.callback,0)}}const T=this.loadingContext,F={id:`pdfjs-font-loading-${T.nextRequestId++}`,done:!1,complete:_,callback:R};return T.requests.push(F),F}get _loadTestFont(){const R=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,c.shadow)(this,"_loadTestFont",R())}_prepareFontLoadEvent(R,_,T){function F($,B){return $.charCodeAt(B)<<24|$.charCodeAt(B+1)<<16|$.charCodeAt(B+2)<<8|$.charCodeAt(B+3)&255}function M($,B,z,K){const Z=$.substring(0,B),Y=$.substring(B+z);return Z+K+Y}let b,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const r=u.getContext("2d");let p=0;function C($,B){if(p++,p>30){(0,c.warn)("Load test font never loaded."),B();return}if(r.font="30px "+$,r.fillText(".",0,20),r.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(C.bind(null,$,B))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=M(v,976,y.length,y);const o=16,m=1482184792;let P=F(v,o);for(b=0,l=y.length-3;b<l;b+=4)P=P-m+F(y,b)|0;b<y.length&&(P=P-m+F(y+"XXX",b)|0),v=M(v,o,4,(0,c.string32)(P));const x=`url(data:font/opentype;base64,${btoa(v)});`,k=`@font-face {font-family:"${y}";src:${x}}`;this.insertRule(k);const E=[];for(const $ of _)E.push($.loadedName);E.push(y);const D=this._document.createElement("div");D.style.visibility="hidden",D.style.width=D.style.height="10px",D.style.position="absolute",D.style.top=D.style.left="0px";for(const $ of E){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=$,D.appendChild(B)}this._document.body.appendChild(D),C(y,()=>{D.remove(),T.complete()})}};class G{constructor(R,{isEvalSupported:_=!0,disableFontFace:T=!1,ignoreErrors:F=!1,onUnsupportedFeature:M,fontRegistry:b=null}){this.compiledGlyphs=Object.create(null);for(const l in R)this[l]=R[l];this.isEvalSupported=_!==!1,this.disableFontFace=T===!0,this.ignoreErrors=F===!0,this._onUnsupportedFeature=M,this.fontRegistry=b}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let R;if(!this.cssFontInfo)R=new FontFace(this.loadedName,this.data,{});else{const _={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_.style=`oblique ${this.cssFontInfo.italicAngle}deg`),R=new FontFace(this.cssFontInfo.fontFamily,this.data,_)}return this.fontRegistry&&this.fontRegistry.registerFont(this),R}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const R=(0,c.bytesToString)(this.data),_=`url(data:${this.mimetype};base64,${btoa(R)});`;let T;if(!this.cssFontInfo)T=`@font-face {font-family:"${this.loadedName}";src:${_}}`;else{let F=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(F+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),T=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${F}src:${_}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,_),T}getPathGenerator(R,_){if(this.compiledGlyphs[_]!==void 0)return this.compiledGlyphs[_];let T;try{T=R.get(this.loadedName+"_path_"+_)}catch(F){if(!this.ignoreErrors)throw F;return this._onUnsupportedFeature({featureId:c.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,c.warn)(`getPathGenerator - ignoring character: "${F}".`),this.compiledGlyphs[_]=function(M,b){}}if(this.isEvalSupported&&c.FeatureTest.isEvalSupported){const F=[];for(const M of T){const b=M.args!==void 0?M.args.join(","):"";F.push("c.",M.cmd,"(",b,`);
`)}return this.compiledGlyphs[_]=new Function("c","size",F.join(""))}return this.compiledGlyphs[_]=function(F,M){for(const b of T)b.cmd==="scale"&&(b.args=[M,-M]),F[b.cmd].apply(F,b.args)}}}g.FontFaceObject=G},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.AnnotationStorage=void 0;var c=H(9),Q=H(1);class q{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(U,R){const _=this._storage.get(U);return _===void 0?R:Object.assign(R,_)}getRawValue(U){return this._storage.get(U)}setValue(U,R){const _=this._storage.get(U);let T=!1;if(_!==void 0)for(const[F,M]of Object.entries(R))_[F]!==M&&(T=!0,_[F]=M);else T=!0,this._storage.set(U,R);T&&this._setModified()}getAll(){return this._storage.size>0?(0,Q.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get hash(){const U=new c.MurmurHash3_64;for(const[R,_]of this._storage)U.update(`${R}:${JSON.stringify(_)}`);return U.hexdigest()}}g.AnnotationStorage=q},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.MurmurHash3_64=void 0;var c=H(1);const Q=3285377520,q=4294901760,G=65535;class U{constructor(_){this.h1=_?_&4294967295:Q,this.h2=_?_&4294967295:Q}update(_){let T,F;if(typeof _=="string"){T=new Uint8Array(_.length*2),F=0;for(let m=0,P=_.length;m<P;m++){const x=_.charCodeAt(m);x<=255?T[F++]=x:(T[F++]=x>>>8,T[F++]=x&255)}}else if((0,c.isArrayBuffer)(_))T=_.slice(),F=T.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const M=F>>2,b=F-M*4,l=new Uint32Array(T.buffer,0,M);let u=0,r=0,p=this.h1,C=this.h2;const y=3432918353,v=461845907,e=y&G,o=v&G;for(let m=0;m<M;m++)m&1?(u=l[m],u=u*y&q|u*e&G,u=u<<15|u>>>17,u=u*v&q|u*o&G,p^=u,p=p<<13|p>>>19,p=p*5+3864292196):(r=l[m],r=r*y&q|r*e&G,r=r<<15|r>>>17,r=r*v&q|r*o&G,C^=r,C=C<<13|C>>>19,C=C*5+3864292196);switch(u=0,b){case 3:u^=T[M*4+2]<<16;case 2:u^=T[M*4+1]<<8;case 1:u^=T[M*4],u=u*y&q|u*e&G,u=u<<15|u>>>17,u=u*v&q|u*o&G,M&1?p^=u:C^=u}this.h1=p,this.h2=C}hexdigest(){let _=this.h1,T=this.h2;_^=T>>>1,_=_*3981806797&q|_*36045&G,T=T*4283543511&q|((T<<16|_>>>16)*2950163797&q)>>>16,_^=T>>>1,_=_*444984403&q|_*60499&G,T=T*3301882366&q|((T<<16|_>>>16)*3120437893&q)>>>16,_^=T>>>1;const F=(_>>>0).toString(16),M=(T>>>0).toString(16);return F.padStart(8,"0")+M.padStart(8,"0")}}g.MurmurHash3_64=U},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.CanvasGraphics=void 0;var c=H(1),Q=H(11),q=H(12),G=H(3),U=H(5);const R=16,_=100,T=4096,F=15,M=10,b=1e3,l=16,u=1.000001;function r(S,a){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){a.save(),this.__originalSave()},S.restore=function(){a.restore(),this.__originalRestore()},S.translate=function(f,t){a.translate(f,t),this.__originalTranslate(f,t)},S.scale=function(f,t){a.scale(f,t),this.__originalScale(f,t)},S.transform=function(f,t,n,i,d,h){a.transform(f,t,n,i,d,h),this.__originalTransform(f,t,n,i,d,h)},S.setTransform=function(f,t,n,i,d,h){a.setTransform(f,t,n,i,d,h),this.__originalSetTransform(f,t,n,i,d,h)},S.resetTransform=function(){a.resetTransform(),this.__originalResetTransform()},S.rotate=function(f){a.rotate(f),this.__originalRotate(f)},S.clip=function(f){a.clip(f),this.__originalClip(f)},S.moveTo=function(s,f){a.moveTo(s,f),this.__originalMoveTo(s,f)},S.lineTo=function(s,f){a.lineTo(s,f),this.__originalLineTo(s,f)},S.bezierCurveTo=function(s,f,t,n,i,d){a.bezierCurveTo(s,f,t,n,i,d),this.__originalBezierCurveTo(s,f,t,n,i,d)},S.rect=function(s,f,t,n){a.rect(s,f,t,n),this.__originalRect(s,f,t,n)},S.closePath=function(){a.closePath(),this.__originalClosePath()},S.beginPath=function(){a.beginPath(),this.__originalBeginPath()}}function p(S){if(S._transformStack&&(S._transformStack=[]),!S.mozCurrentTransform){S._originalSave=S.save,S._originalRestore=S.restore,S._originalRotate=S.rotate,S._originalScale=S.scale,S._originalTranslate=S.translate,S._originalTransform=S.transform,S._originalSetTransform=S.setTransform,S._originalResetTransform=S.resetTransform,S._transformMatrix=S._transformMatrix||[1,0,0,1,0,0],S._transformStack=[];try{const a=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(S),"lineWidth");S._setLineWidth=a.set,S._getLineWidth=a.get,Object.defineProperty(S,"lineWidth",{set:function(f){this._setLineWidth(f*u)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(S,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(S,"mozCurrentTransformInverse",{get:function(){const[s,f,t,n,i,d]=this._transformMatrix,h=s*n-f*t,A=f*t-s*n;return[n/h,f/A,t/A,s/h,(n*i-t*d)/A,(f*i-s*d)/h]}}),S.save=function(){const s=this._transformMatrix;this._transformStack.push(s),this._transformMatrix=s.slice(0,6),this._originalSave()},S.restore=function(){this._transformStack.length===0&&(0,c.warn)("Tried to restore a ctx when the stack was already empty.");const s=this._transformStack.pop();s&&(this._transformMatrix=s,this._originalRestore())},S.translate=function(s,f){const t=this._transformMatrix;t[4]=t[0]*s+t[2]*f+t[4],t[5]=t[1]*s+t[3]*f+t[5],this._originalTranslate(s,f)},S.scale=function(s,f){const t=this._transformMatrix;t[0]*=s,t[1]*=s,t[2]*=f,t[3]*=f,this._originalScale(s,f)},S.transform=function(s,f,t,n,i,d){const h=this._transformMatrix;this._transformMatrix=[h[0]*s+h[2]*f,h[1]*s+h[3]*f,h[0]*t+h[2]*n,h[1]*t+h[3]*n,h[0]*i+h[2]*d+h[4],h[1]*i+h[3]*d+h[5]],S._originalTransform(s,f,t,n,i,d)},S.setTransform=function(s,f,t,n,i,d){this._transformMatrix=[s,f,t,n,i,d],S._originalSetTransform(s,f,t,n,i,d)},S.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],S._originalResetTransform()},S.rotate=function(s){const f=Math.cos(s),t=Math.sin(s),n=this._transformMatrix;this._transformMatrix=[n[0]*f+n[2]*t,n[1]*f+n[3]*t,n[0]*-t+n[2]*f,n[1]*-t+n[3]*f,n[4],n[5]],this._originalRotate(s)}}}class C{constructor(a){this.canvasFactory=a,this.cache=Object.create(null)}getCanvas(a,s,f,t){let n;return this.cache[a]!==void 0?(n=this.cache[a],this.canvasFactory.reset(n,s,f),n.context.setTransform(1,0,0,1,0,0)):(n=this.canvasFactory.create(s,f),this.cache[a]=n),t&&p(n.context),n}delete(a){delete this.cache[a]}clear(){for(const a in this.cache){const s=this.cache[a];this.canvasFactory.destroy(s),delete this.cache[a]}}}function y(S,a,s,f,t,n,i,d,h,A){const[w,N,O,W,L,X]=S.mozCurrentTransform;if(N===0&&O===0){const it=i*w+L,tt=Math.round(it),lt=d*W+X,ct=Math.round(lt),nt=(i+h)*w+L,At=Math.abs(Math.round(nt)-tt)||1,mt=(d+A)*W+X,ut=Math.abs(Math.round(mt)-ct)||1;return S.setTransform(Math.sign(w),0,0,Math.sign(W),tt,ct),S.drawImage(a,s,f,t,n,0,0,At,ut),S.setTransform(w,N,O,W,L,X),[At,ut]}if(w===0&&W===0){const it=d*O+L,tt=Math.round(it),lt=i*N+X,ct=Math.round(lt),nt=(d+A)*O+L,At=Math.abs(Math.round(nt)-tt)||1,mt=(i+h)*N+X,ut=Math.abs(Math.round(mt)-ct)||1;return S.setTransform(0,Math.sign(N),Math.sign(O),0,tt,ct),S.drawImage(a,s,f,t,n,0,0,ut,At),S.setTransform(w,N,O,W,L,X),[ut,At]}S.drawImage(a,s,f,t,n,i,d,h,A);const st=Math.hypot(w,N),rt=Math.hypot(O,W);return[st*h,rt*A]}function v(S){const{width:a,height:s}=S;if(a>b||s>b)return null;const f=1e3,t=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=a+1;let i=new Uint8Array(n*(s+1)),d,h,A;const w=a+7&-8;let N=new Uint8Array(w*s),O=0;for(const tt of S.data){let lt=128;for(;lt>0;)N[O++]=tt&lt?0:255,lt>>=1}let W=0;for(O=0,N[O]!==0&&(i[0]=1,++W),h=1;h<a;h++)N[O]!==N[O+1]&&(i[h]=N[O]?2:1,++W),O++;for(N[O]!==0&&(i[h]=2,++W),d=1;d<s;d++){O=d*w,A=d*n,N[O-w]!==N[O]&&(i[A]=N[O]?1:8,++W);let tt=(N[O]?4:0)+(N[O-w]?8:0);for(h=1;h<a;h++)tt=(tt>>2)+(N[O+1]?4:0)+(N[O-w+1]?8:0),t[tt]&&(i[A+h]=t[tt],++W),O++;if(N[O-w]!==N[O]&&(i[A+h]=N[O]?2:4,++W),W>f)return null}for(O=w*(s-1),A=d*n,N[O]!==0&&(i[A]=8,++W),h=1;h<a;h++)N[O]!==N[O+1]&&(i[A+h]=N[O]?4:8,++W),O++;if(N[O]!==0&&(i[A+h]=4,++W),W>f)return null;const L=new Int32Array([0,n,-1,0,-n,0,0,0,1]);let X,st,rt;for(G.isNodeJS?st=[]:X=new Path2D,d=0;W&&d<=s;d++){let tt=d*n;const lt=tt+a;for(;tt<lt&&!i[tt];)tt++;if(tt===lt)continue;X?X.moveTo(tt%n,d):rt=[tt%n,d];const ct=tt;let nt=i[tt];do{const At=L[nt];do tt+=At;while(!i[tt]);const mt=i[tt];mt!==5&&mt!==10?(nt=mt,i[tt]=0):(nt=mt&51*nt>>4,i[tt]&=nt>>2|nt<<2),X?X.lineTo(tt%n,tt/n|0):rt.push(tt%n,tt/n|0),i[tt]||--W}while(ct!==tt);X||st.push(rt),--d}return N=null,i=null,function(tt){if(tt.save(),tt.scale(1/a,-1/s),tt.translate(0,-s),X)tt.fill(X);else{tt.beginPath();for(const lt of st){tt.moveTo(lt[0],lt[1]);for(let ct=2,nt=lt.length;ct<nt;ct+=2)tt.lineTo(lt[ct],lt[ct+1])}tt.fill()}tt.beginPath(),tt.restore()}}class e{constructor(a,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,a,s])}clone(){const a=Object.create(this);return a.clipBox=this.clipBox.slice(),a}setCurrentPoint(a,s){this.x=a,this.y=s}updatePathMinMax(a,s,f){[s,f]=c.Util.applyTransform([s,f],a),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,f),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,f)}updateRectMinMax(a,s){const f=c.Util.applyTransform(s,a),t=c.Util.applyTransform(s.slice(2),a);this.minX=Math.min(this.minX,f[0],t[0]),this.minY=Math.min(this.minY,f[1],t[1]),this.maxX=Math.max(this.maxX,f[0],t[0]),this.maxY=Math.max(this.maxY,f[1],t[1])}updateScalingPathMinMax(a,s){c.Util.scaleMinMax(a,s),this.minX=Math.min(this.minX,s[0]),this.maxX=Math.max(this.maxX,s[1]),this.minY=Math.min(this.minY,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(a,s,f,t,n,i,d,h,A,w){const N=c.Util.bezierBoundingBox(s,f,t,n,i,d,h,A);if(w){w[0]=Math.min(w[0],N[0],N[2]),w[1]=Math.max(w[1],N[0],N[2]),w[2]=Math.min(w[2],N[1],N[3]),w[3]=Math.max(w[3],N[1],N[3]);return}this.updateRectMinMax(a,N)}getPathBoundingBox(a=Q.PathType.FILL,s=null){const f=[this.minX,this.minY,this.maxX,this.maxY];if(a===Q.PathType.STROKE){s||(0,c.unreachable)("Stroke bounding box must include transform.");const t=c.Util.singularValueDecompose2dScale(s),n=t[0]*this.lineWidth/2,i=t[1]*this.lineWidth/2;f[0]-=n,f[1]-=i,f[2]+=n,f[3]+=i}return f}updateClipFromPath(){const a=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(a||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(a){this.clipBox=a,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(a=Q.PathType.FILL,s=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(a,s))}}function o(S,a,s=null){if(typeof ImageData<"u"&&a instanceof ImageData){S.putImageData(a,0,0);return}const f=a.height,t=a.width,n=f%l,i=(f-n)/l,d=n===0?i:i+1,h=S.createImageData(t,l);let A=0,w;const N=a.data,O=h.data;let W,L,X,st,rt,it,tt,lt;if(s)switch(s.length){case 1:rt=s[0],it=s[0],tt=s[0],lt=s[0];break;case 4:rt=s[0],it=s[1],tt=s[2],lt=s[3];break}if(a.kind===c.ImageKind.GRAYSCALE_1BPP){const ct=N.byteLength,nt=new Uint32Array(O.buffer,0,O.byteLength>>2),At=nt.length,mt=t+7>>3;let ut=4294967295,gt=c.FeatureTest.isLittleEndian?4278190080:255;for(lt&&lt[0]===255&&lt[255]===0&&([ut,gt]=[gt,ut]),W=0;W<d;W++){for(X=W<i?l:n,w=0,L=0;L<X;L++){const St=ct-A;let Tt=0;const yt=St>mt?t:St*8-7,Et=yt&-8;let _t=0,V=0;for(;Tt<Et;Tt+=8)V=N[A++],nt[w++]=V&128?ut:gt,nt[w++]=V&64?ut:gt,nt[w++]=V&32?ut:gt,nt[w++]=V&16?ut:gt,nt[w++]=V&8?ut:gt,nt[w++]=V&4?ut:gt,nt[w++]=V&2?ut:gt,nt[w++]=V&1?ut:gt;for(;Tt<yt;Tt++)_t===0&&(V=N[A++],_t=128),nt[w++]=V&_t?ut:gt,_t>>=1}for(;w<At;)nt[w++]=0;S.putImageData(h,0,W*l)}}else if(a.kind===c.ImageKind.RGBA_32BPP){const ct=!!(rt||it||tt);for(L=0,st=t*l*4,W=0;W<i;W++){if(O.set(N.subarray(A,A+st)),A+=st,ct)for(let nt=0;nt<st;nt+=4)rt&&(O[nt+0]=rt[O[nt+0]]),it&&(O[nt+1]=it[O[nt+1]]),tt&&(O[nt+2]=tt[O[nt+2]]);S.putImageData(h,0,L),L+=l}if(W<d){if(st=t*n*4,O.set(N.subarray(A,A+st)),ct)for(let nt=0;nt<st;nt+=4)rt&&(O[nt+0]=rt[O[nt+0]]),it&&(O[nt+1]=it[O[nt+1]]),tt&&(O[nt+2]=tt[O[nt+2]]);S.putImageData(h,0,L)}}else if(a.kind===c.ImageKind.RGB_24BPP){const ct=!!(rt||it||tt);for(X=l,st=t*X,W=0;W<d;W++){for(W>=i&&(X=n,st=t*X),w=0,L=st;L--;)O[w++]=N[A++],O[w++]=N[A++],O[w++]=N[A++],O[w++]=255;if(ct)for(let nt=0;nt<w;nt+=4)rt&&(O[nt+0]=rt[O[nt+0]]),it&&(O[nt+1]=it[O[nt+1]]),tt&&(O[nt+2]=tt[O[nt+2]]);S.putImageData(h,0,W*l)}}else throw new Error(`bad image kind: ${a.kind}`)}function m(S,a){if(a.bitmap){S.drawImage(a.bitmap,0,0);return}const s=a.height,f=a.width,t=s%l,n=(s-t)/l,i=t===0?n:n+1,d=S.createImageData(f,l);let h=0;const A=a.data,w=d.data;for(let N=0;N<i;N++){const O=N<n?l:t;({srcPos:h}=(0,q.applyMaskImageData)({src:A,srcPos:h,dest:w,width:f,height:O})),S.putImageData(d,0,N*l)}}function P(S,a){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let f=0,t=s.length;f<t;f++){const n=s[f];S[n]!==void 0&&(a[n]=S[n])}S.setLineDash!==void 0&&(a.setLineDash(S.getLineDash()),a.lineDashOffset=S.lineDashOffset)}function x(S,a){S.strokeStyle=S.fillStyle=a||"#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0)}function k(S,a,s,f){const t=S.length;for(let n=3;n<t;n+=4){const i=S[n];if(i===0)S[n-3]=a,S[n-2]=s,S[n-1]=f;else if(i<255){const d=255-i;S[n-3]=S[n-3]*i+a*d>>8,S[n-2]=S[n-2]*i+s*d>>8,S[n-1]=S[n-1]*i+f*d>>8}}}function E(S,a,s){const f=S.length,t=1/255;for(let n=3;n<f;n+=4){const i=s?s[S[n]]:S[n];a[n]=a[n]*i*t|0}}function D(S,a,s){const f=S.length;for(let t=3;t<f;t+=4){const n=S[t-3]*77+S[t-2]*152+S[t-1]*28;a[t]=s?a[t]*s[n>>8]>>8:a[t]*n>>16}}function $(S,a,s,f,t,n,i,d,h,A,w){const N=!!n,O=N?n[0]:0,W=N?n[1]:0,L=N?n[2]:0;let X;t==="Luminosity"?X=D:X=E;const rt=Math.min(f,Math.ceil(1048576/s));for(let it=0;it<f;it+=rt){const tt=Math.min(rt,f-it),lt=S.getImageData(d-A,it+(h-w),s,tt),ct=a.getImageData(d,it+h,s,tt);N&&k(lt.data,O,W,L),X(lt.data,ct.data,i),a.putImageData(ct,d,it+h)}}function B(S,a,s,f){const t=f[0],n=f[1],i=f[2]-t,d=f[3]-n;i===0||d===0||($(a.context,s,i,d,a.subtype,a.backdrop,a.transferMap,t,n,a.offsetX,a.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(s.canvas,0,0),S.restore())}function z(S,a){const s=c.Util.singularValueDecompose2dScale(S);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const f=Math.fround((globalThis.devicePixelRatio||1)*U.PixelsPerInch.PDF_TO_CSS_UNITS);return a!==void 0?a:s[0]<=f||s[1]<=f}const K=["butt","round","square"],Z=["miter","round","bevel"],Y={},et={};class ot{constructor(a,s,f,t,n,i,d,h){this.ctx=a,this.current=new e(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=f,this.canvasFactory=t,this.imageLayer=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=i,this.cachedCanvases=new C(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(h==null?void 0:h.background)||null,this.foregroundColor=(h==null?void 0:h.foreground)||null,a&&p(a),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(a,s=null){return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):s}beginDrawing({transform:a,viewport:s,transparency:f=!1,background:t=null}){const n=this.ctx.canvas.width,i=this.ctx.canvas.height,d=t||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const h=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const A=this.backgroundColor=this.ctx.fillStyle;let w=!0,N=d;if(this.ctx.fillStyle=d,N=this.ctx.fillStyle,w=typeof N=="string"&&/^#[0-9A-Fa-f]{6}$/.test(N),h==="#000000"&&A==="#ffffff"||h===A||!w)this.foregroundColor=this.backgroundColor=null;else{const O=parseInt(N.slice(1),16),W=(O&&16711680)>>16,L=(O&&65280)>>8,X=O&&255,st=it=>(it/=255,it<=.03928?it/12.92:((it+.055)/1.055)**2.4),rt=Math.round(.2126*st(W)+.7152*st(L)+.0722*st(X));this.selectColor=(it,tt,lt)=>{const ct=.2126*st(it)+.7152*st(tt)+.0722*st(lt);return Math.round(ct)===rt?A:h}}}if(this.ctx.fillStyle=this.backgroundColor||d,this.ctx.fillRect(0,0,n,i),this.ctx.restore(),f){const h=this.cachedCanvases.getCanvas("transparent",n,i,!0);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),x(this.ctx,this.foregroundColor),a&&(this.ctx.transform.apply(this.ctx,a),this.outputScaleX=a[0],this.outputScaleY=a[0]),this.ctx.transform.apply(this.ctx,s.transform),this.viewportScale=s.scale,this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(a,s,f,t){const n=a.argsArray,i=a.fnArray;let d=s||0;const h=n.length;if(h===d)return d;const A=h-d>M&&typeof f=="function",w=A?Date.now()+F:0;let N=0;const O=this.commonObjs,W=this.objs;let L;for(;;){if(t!==void 0&&d===t.nextBreakPoint)return t.breakIt(d,f),d;if(L=i[d],L!==c.OPS.dependency)this[L].apply(this,n[d]);else for(const X of n[d]){const st=X.startsWith("g_")?O:W;if(!st.has(X))return st.get(X,f),d}if(d++,d===h)return d;if(A&&++N>M){if(Date.now()>w)return f(),d;N=0}}}endDrawing(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const a of this._cachedBitmapsMap.values()){for(const s of a.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);a.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(a,s){const f=a.width,t=a.height;let n=Math.max(Math.hypot(s[0],s[1]),1),i=Math.max(Math.hypot(s[2],s[3]),1),d=f,h=t,A="prescale1",w,N;for(;n>2&&d>1||i>2&&h>1;){let O=d,W=h;n>2&&d>1&&(O=Math.ceil(d/2),n/=d/O),i>2&&h>1&&(W=Math.ceil(h/2),i/=h/W),w=this.cachedCanvases.getCanvas(A,O,W,!1),N=w.context,N.clearRect(0,0,O,W),N.drawImage(a,0,0,d,h,0,0,O,W),a=w.canvas,d=O,h=W,A=A==="prescale1"?"prescale2":"prescale1"}return{img:a,paintWidth:d,paintHeight:h}}_createMaskCanvas(a){const s=this.ctx,{width:f,height:t}=a,n=this.current.fillColor,i=this.current.patternFill,d=s.mozCurrentTransform;let h,A,w,N;if((a.bitmap||a.data)&&a.count>1){const At=a.bitmap||a.data.buffer,mt=d.slice(0,4);A=JSON.stringify(i?mt:[mt,n]),h=this._cachedBitmapsMap.get(At),h||(h=new Map,this._cachedBitmapsMap.set(At,h));const ut=h.get(A);if(ut&&!i){const gt=Math.round(Math.min(d[0],d[2])+d[4]),St=Math.round(Math.min(d[1],d[3])+d[5]);return{canvas:ut,offsetX:gt,offsetY:St}}w=ut}w||(N=this.cachedCanvases.getCanvas("maskCanvas",f,t,!1),m(N.context,a));let O=c.Util.transform(d,[1/f,0,0,-1/t,0,0]);O=c.Util.transform(O,[1,0,0,1,0,-t]);const W=c.Util.applyTransform([0,0],O),L=c.Util.applyTransform([f,t],O),X=c.Util.normalizeRect([W[0],W[1],L[0],L[1]]),st=Math.round(X[2]-X[0])||1,rt=Math.round(X[3]-X[1])||1,it=this.cachedCanvases.getCanvas("fillCanvas",st,rt,!0),tt=it.context,lt=Math.min(W[0],L[0]),ct=Math.min(W[1],L[1]);tt.translate(-lt,-ct),tt.transform.apply(tt,O),w||(w=this._scaleImage(N.canvas,tt.mozCurrentTransformInverse),w=w.img,h&&i&&h.set(A,w)),tt.imageSmoothingEnabled=z(tt.mozCurrentTransform,a.interpolate),y(tt,w,0,0,w.width,w.height,0,0,f,t),tt.globalCompositeOperation="source-in";const nt=c.Util.transform(tt.mozCurrentTransformInverse,[1,0,0,1,-lt,-ct]);return tt.fillStyle=i?n.getPattern(s,this,nt,Q.PathType.FILL):n,tt.fillRect(0,0,f,t),h&&!i&&(this.cachedCanvases.delete("fillCanvas"),h.set(A,it.canvas)),{canvas:it.canvas,offsetX:Math.round(lt),offsetY:Math.round(ct)}}setLineWidth(a){a!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=a,this.ctx.lineWidth=a}setLineCap(a){this.ctx.lineCap=K[a]}setLineJoin(a){this.ctx.lineJoin=Z[a]}setMiterLimit(a){this.ctx.miterLimit=a}setDash(a,s){const f=this.ctx;f.setLineDash!==void 0&&(f.setLineDash(a),f.lineDashOffset=s)}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(let s=0,f=a.length;s<f;s++){const t=a[s],n=t[0],i=t[1];switch(n){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=t[1];break;case"ca":this.current.fillAlpha=t[1],this.ctx.globalAlpha=t[1];break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=i}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const a=this.inSMaskMode;this.current.activeSMask&&!a?this.beginSMaskMode():!this.current.activeSMask&&a&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const a=this.ctx.canvas.width,s=this.ctx.canvas.height,f="smaskGroupAt"+this.groupLevel,t=this.cachedCanvases.getCanvas(f,a,s,!0);this.suspendedCtx=this.ctx,this.ctx=t.context;const n=this.ctx;n.setTransform.apply(n,this.suspendedCtx.mozCurrentTransform),P(this.suspendedCtx,n),r(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),P(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(a){if(!this.current.activeSMask)return;a?(a[0]=Math.floor(a[0]),a[1]=Math.floor(a[1]),a[2]=Math.ceil(a[2]),a[3]=Math.ceil(a[3])):a=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,f=this.suspendedCtx;B(f,s,this.ctx,a),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(P(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const a=this.current;this.stateStack.push(a),this.current=a.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),P(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(a,s,f,t,n,i){this.ctx.transform(a,s,f,t,n,i),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(a,s,f){const t=this.ctx,n=this.current;let i=n.x,d=n.y,h,A;const w=t.mozCurrentTransform,N=w[0]===0&&w[3]===0||w[1]===0&&w[2]===0,O=N?f.slice(0):null;for(let W=0,L=0,X=a.length;W<X;W++)switch(a[W]|0){case c.OPS.rectangle:i=s[L++],d=s[L++];const st=s[L++],rt=s[L++],it=i+st,tt=d+rt;t.moveTo(i,d),st===0||rt===0?t.lineTo(it,tt):(t.lineTo(it,d),t.lineTo(it,tt),t.lineTo(i,tt)),N||n.updateRectMinMax(w,[i,d,it,tt]),t.closePath();break;case c.OPS.moveTo:i=s[L++],d=s[L++],t.moveTo(i,d),N||n.updatePathMinMax(w,i,d);break;case c.OPS.lineTo:i=s[L++],d=s[L++],t.lineTo(i,d),N||n.updatePathMinMax(w,i,d);break;case c.OPS.curveTo:h=i,A=d,i=s[L+4],d=s[L+5],t.bezierCurveTo(s[L],s[L+1],s[L+2],s[L+3],i,d),n.updateCurvePathMinMax(w,h,A,s[L],s[L+1],s[L+2],s[L+3],i,d,O),L+=6;break;case c.OPS.curveTo2:h=i,A=d,t.bezierCurveTo(i,d,s[L],s[L+1],s[L+2],s[L+3]),n.updateCurvePathMinMax(w,h,A,i,d,s[L],s[L+1],s[L+2],s[L+3],O),i=s[L+2],d=s[L+3],L+=4;break;case c.OPS.curveTo3:h=i,A=d,i=s[L+2],d=s[L+3],t.bezierCurveTo(s[L],s[L+1],i,d,i,d),n.updateCurvePathMinMax(w,h,A,s[L],s[L+1],i,d,i,d,O),L+=4;break;case c.OPS.closePath:t.closePath();break}N&&n.updateScalingPathMinMax(w,O),n.setCurrentPoint(i,d)}closePath(){this.ctx.closePath()}stroke(a){a=typeof a<"u"?a:!0;const s=this.ctx,f=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof f=="object"&&(f==null?void 0:f.getPattern)?(s.save(),s.strokeStyle=f.getPattern(s,this,s.mozCurrentTransformInverse,Q.PathType.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),a&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(a){a=typeof a<"u"?a:!0;const s=this.ctx,f=this.current.fillColor,t=this.current.patternFill;let n=!1;t&&(s.save(),s.fillStyle=f.getPattern(s,this,s.mozCurrentTransformInverse,Q.PathType.FILL),n=!0);const i=this.current.getClippedPathBoundingBox();this.contentVisible&&i!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),n&&s.restore(),a&&this.consumePath(i)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Y}eoClip(){this.pendingClip=et}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const a=this.pendingTextPaths,s=this.ctx;if(a===void 0){s.beginPath();return}s.save(),s.beginPath();for(let f=0;f<a.length;f++){const t=a[f];s.setTransform.apply(s,t.transform),s.translate(t.x,t.y),t.addToPath(s,t.fontSize)}s.restore(),s.clip(),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(a){this.current.charSpacing=a}setWordSpacing(a){this.current.wordSpacing=a}setHScale(a){this.current.textHScale=a/100}setLeading(a){this.current.leading=-a}setFont(a,s){const f=this.commonObjs.get(a),t=this.current;if(!f)throw new Error(`Can't find font for ${a}`);if(t.fontMatrix=f.fontMatrix||c.FONT_IDENTITY_MATRIX,(t.fontMatrix[0]===0||t.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+a),s<0?(s=-s,t.fontDirection=-1):t.fontDirection=1,this.current.font=f,this.current.fontSize=s,f.isType3Font)return;const n=f.loadedName||"sans-serif";let i="normal";f.black?i="900":f.bold&&(i="bold");const d=f.italic?"italic":"normal",h=`"${n}", ${f.fallbackName}`;let A=s;s<R?A=R:s>_&&(A=_),this.current.fontSizeScale=s/A,this.ctx.font=`${d} ${i} ${A}px ${h}`}setTextRenderingMode(a){this.current.textRenderingMode=a}setTextRise(a){this.current.textRise=a}moveText(a,s){this.current.x=this.current.lineX+=a,this.current.y=this.current.lineY+=s}setLeadingMoveText(a,s){this.setLeading(-s),this.moveText(a,s)}setTextMatrix(a,s,f,t,n,i){this.current.textMatrix=[a,s,f,t,n,i],this.current.textMatrixScale=Math.hypot(a,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(a,s,f,t){const n=this.ctx,i=this.current,d=i.font,h=i.textRenderingMode,A=i.fontSize/i.fontSizeScale,w=h&c.TextRenderingMode.FILL_STROKE_MASK,N=!!(h&c.TextRenderingMode.ADD_TO_PATH_FLAG),O=i.patternFill&&!d.missingFile;let W;(d.disableFontFace||N||O)&&(W=d.getPathGenerator(this.commonObjs,a)),d.disableFontFace||O?(n.save(),n.translate(s,f),n.beginPath(),W(n,A),t&&n.setTransform.apply(n,t),(w===c.TextRenderingMode.FILL||w===c.TextRenderingMode.FILL_STROKE)&&n.fill(),(w===c.TextRenderingMode.STROKE||w===c.TextRenderingMode.FILL_STROKE)&&n.stroke(),n.restore()):((w===c.TextRenderingMode.FILL||w===c.TextRenderingMode.FILL_STROKE)&&n.fillText(a,s,f),(w===c.TextRenderingMode.STROKE||w===c.TextRenderingMode.FILL_STROKE)&&n.strokeText(a,s,f)),N&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:n.mozCurrentTransform,x:s,y:f,fontSize:A,addToPath:W})}get isFontSubpixelAAEnabled(){const{context:a}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10,!1);a.scale(1.5,1),a.fillText("I",0,10);const s=a.getImageData(0,0,10,10).data;let f=!1;for(let t=3;t<s.length;t+=4)if(s[t]>0&&s[t]<255){f=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",f)}showText(a){const s=this.current,f=s.font;if(f.isType3Font)return this.showType3Text(a);const t=s.fontSize;if(t===0)return;const n=this.ctx,i=s.fontSizeScale,d=s.charSpacing,h=s.wordSpacing,A=s.fontDirection,w=s.textHScale*A,N=a.length,O=f.vertical,W=O?1:-1,L=f.defaultVMetrics,X=t*s.fontMatrix[0],st=s.textRenderingMode===c.TextRenderingMode.FILL&&!f.disableFontFace&&!s.patternFill;n.save(),n.transform.apply(n,s.textMatrix),n.translate(s.x,s.y+s.textRise),A>0?n.scale(w,-1):n.scale(w,1);let rt;if(s.patternFill){n.save();const nt=s.fillColor.getPattern(n,this,n.mozCurrentTransformInverse,Q.PathType.FILL);rt=n.mozCurrentTransform,n.restore(),n.fillStyle=nt}let it=s.lineWidth;const tt=s.textMatrixScale;if(tt===0||it===0){const nt=s.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(nt===c.TextRenderingMode.STROKE||nt===c.TextRenderingMode.FILL_STROKE)&&(it=this.getSinglePixelWidth())}else it/=tt;i!==1&&(n.scale(i,i),it/=i),n.lineWidth=it;let lt=0,ct;for(ct=0;ct<N;++ct){const nt=a[ct];if(typeof nt=="number"){lt+=W*nt*t/1e3;continue}let At=!1;const mt=(nt.isSpace?h:0)+d,ut=nt.fontChar,gt=nt.accent;let St,Tt,yt=nt.width;if(O){const _t=nt.vmetric||L,V=-(nt.vmetric?_t[1]:yt*.5)*X,I=_t[2]*X;yt=_t?-_t[0]:yt,St=V/i,Tt=(lt+I)/i}else St=lt/i,Tt=0;if(f.remeasure&&yt>0){const _t=n.measureText(ut).width*1e3/t*i;if(yt<_t&&this.isFontSubpixelAAEnabled){const V=yt/_t;At=!0,n.save(),n.scale(V,1),St/=V}else yt!==_t&&(St+=(yt-_t)/2e3*t/i)}if(this.contentVisible&&(nt.isInFont||f.missingFile)){if(st&&!gt)n.fillText(ut,St,Tt);else if(this.paintChar(ut,St,Tt,rt),gt){const _t=St+t*gt.offset.x/i,V=Tt-t*gt.offset.y/i;this.paintChar(gt.fontChar,_t,V,rt)}}let Et;O?Et=yt*X-mt*A:Et=yt*X+mt*A,lt+=Et,At&&n.restore()}O?s.y-=lt:s.x+=lt*w,n.restore(),this.compose()}showType3Text(a){const s=this.ctx,f=this.current,t=f.font,n=f.fontSize,i=f.fontDirection,d=t.vertical?1:-1,h=f.charSpacing,A=f.wordSpacing,w=f.textHScale*i,N=f.fontMatrix||c.FONT_IDENTITY_MATRIX,O=a.length,W=f.textRenderingMode===c.TextRenderingMode.INVISIBLE;let L,X,st,rt;if(!(W||n===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,s.save(),s.transform.apply(s,f.textMatrix),s.translate(f.x,f.y),s.scale(w,i),L=0;L<O;++L){if(X=a[L],typeof X=="number"){rt=d*X*n/1e3,this.ctx.translate(rt,0),f.x+=rt*w;continue}const it=(X.isSpace?A:0)+h,tt=t.charProcOperatorList[X.operatorListId];if(!tt){(0,c.warn)(`Type3 character "${X.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=X,this.save(),s.scale(n,n),s.transform.apply(s,N),this.executeOperatorList(tt),this.restore()),st=c.Util.applyTransform([X.width,0],N)[0]*n+it,s.translate(st,0),f.x+=st*w}s.restore(),this.processingType3=null}}setCharWidth(a,s){}setCharWidthAndBounds(a,s,f,t,n,i){this.ctx.rect(f,t,n-f,i-t),this.ctx.clip(),this.endPath()}getColorN_Pattern(a){let s;if(a[0]==="TilingPattern"){const f=a[1],t=this.baseTransform||this.ctx.mozCurrentTransform.slice(),n={createCanvasGraphics:i=>new ot(i,this.commonObjs,this.objs,this.canvasFactory)};s=new Q.TilingPattern(a,f,this.ctx,n,t)}else s=this._getPattern(a[1],a[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(a,s,f){var n;const t=((n=this.selectColor)==null?void 0:n.call(this,a,s,f))||c.Util.makeHexColor(a,s,f);this.ctx.strokeStyle=t,this.current.strokeColor=t}setFillRGBColor(a,s,f){var n;const t=((n=this.selectColor)==null?void 0:n.call(this,a,s,f))||c.Util.makeHexColor(a,s,f);this.ctx.fillStyle=t,this.current.fillColor=t,this.current.patternFill=!1}_getPattern(a,s=null){let f;return this.cachedPatterns.has(a)?f=this.cachedPatterns.get(a):(f=(0,Q.getShadingPattern)(this.objs.get(a)),this.cachedPatterns.set(a,f)),s&&(f.matrix=s),f}shadingFill(a){if(!this.contentVisible)return;const s=this.ctx;this.save();const f=this._getPattern(a);s.fillStyle=f.getPattern(s,this,s.mozCurrentTransformInverse,Q.PathType.SHADING);const t=s.mozCurrentTransformInverse;if(t){const n=s.canvas,i=n.width,d=n.height,h=c.Util.applyTransform([0,0],t),A=c.Util.applyTransform([0,d],t),w=c.Util.applyTransform([i,0],t),N=c.Util.applyTransform([i,d],t),O=Math.min(h[0],A[0],w[0],N[0]),W=Math.min(h[1],A[1],w[1],N[1]),L=Math.max(h[0],A[0],w[0],N[0]),X=Math.max(h[1],A[1],w[1],N[1]);this.ctx.fillRect(O,W,L-O,X-W)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(a,s){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(a)&&a.length===6&&this.transform.apply(this,a),this.baseTransform=this.ctx.mozCurrentTransform,s)){const f=s[2]-s[0],t=s[3]-s[1];this.ctx.rect(s[0],s[1],f,t),this.current.updateRectMinMax(this.ctx.mozCurrentTransform,s),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(a){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;a.isolated||(0,c.info)("TODO: Support non-isolated groups."),a.knockout&&(0,c.warn)("Knockout groups not supported.");const f=s.mozCurrentTransform;if(a.matrix&&s.transform.apply(s,a.matrix),!a.bbox)throw new Error("Bounding box is required.");let t=c.Util.getAxialAlignedBoundingBox(a.bbox,s.mozCurrentTransform);const n=[0,0,s.canvas.width,s.canvas.height];t=c.Util.intersect(t,n)||[0,0,0,0];const i=Math.floor(t[0]),d=Math.floor(t[1]);let h=Math.max(Math.ceil(t[2])-i,1),A=Math.max(Math.ceil(t[3])-d,1),w=1,N=1;h>T&&(w=h/T,h=T),A>T&&(N=A/T,A=T),this.current.startNewPathAndClipBox([0,0,h,A]);let O="groupAt"+this.groupLevel;a.smask&&(O+="_smask_"+this.smaskCounter++%2);const W=this.cachedCanvases.getCanvas(O,h,A,!0),L=W.context;L.scale(1/w,1/N),L.translate(-i,-d),L.transform.apply(L,f),a.smask?this.smaskStack.push({canvas:W.canvas,context:L,offsetX:i,offsetY:d,scaleX:w,scaleY:N,subtype:a.smask.subtype,backdrop:a.smask.backdrop,transferMap:a.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(i,d),s.scale(w,N),s.save()),P(s,L),this.ctx=L,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(a){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,f=this.groupStack.pop();if(this.ctx=f,this.ctx.imageSmoothingEnabled=!1,a.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=this.ctx.mozCurrentTransform;this.restore(),this.ctx.save(),this.ctx.setTransform.apply(this.ctx,t);const n=c.Util.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],t);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(a,s,f,t,n){if(this.save(),Array.isArray(s)&&s.length===4){const i=s[2]-s[0],d=s[3]-s[1];if(n&&this.annotationCanvasMap){f=f.slice(),f[4]-=s[0],f[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=i,s[3]=d;const[h,A]=c.Util.singularValueDecompose2dScale(this.ctx.mozCurrentTransform),{viewportScale:w}=this,N=Math.ceil(i*this.outputScaleX*w),O=Math.ceil(d*this.outputScaleY*w);this.annotationCanvas=this.canvasFactory.create(N,O);const{canvas:W,context:L}=this.annotationCanvas,X=`var(--zoom-factor) * ${U.PixelsPerInch.PDF_TO_CSS_UNITS}`;W.style.width=`calc(${i}px * ${X})`,W.style.height=`calc(${d}px * ${X})`,this.annotationCanvasMap.set(a,W),this.annotationCanvas.savedCtx=this.ctx,this.ctx=L,this.ctx.setTransform(h,0,0,-A,0,d*A),p(this.ctx),x(this.ctx,this.foregroundColor)}else x(this.ctx,this.foregroundColor),this.ctx.rect(s[0],s[1],i,d),this.ctx.clip(),this.endPath()}this.current=new e(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,f),this.transform.apply(this,t)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas),this.restore()}paintImageMaskXObject(a){if(!this.contentVisible)return;const s=a.count;a=this.getObject(a.data,a),a.count=s;const f=this.ctx,t=this.processingType3;if(t&&(t.compiled===void 0&&(t.compiled=v(a)),t.compiled)){t.compiled(f);return}const n=this._createMaskCanvas(a),i=n.canvas;f.save(),f.setTransform(1,0,0,1,0,0),f.drawImage(i,n.offsetX,n.offsetY),f.restore(),this.compose()}paintImageMaskXObjectRepeat(a,s,f=0,t=0,n,i){if(!this.contentVisible)return;a=this.getObject(a.data,a);const d=this.ctx;d.save();const h=d.mozCurrentTransform;d.transform(s,f,t,n,0,0);const A=this._createMaskCanvas(a);d.setTransform(1,0,0,1,0,0);for(let w=0,N=i.length;w<N;w+=2){const O=c.Util.transform(h,[s,f,t,n,i[w],i[w+1]]),[W,L]=c.Util.applyTransform([0,0],O);d.drawImage(A.canvas,W,L)}d.restore(),this.compose()}paintImageMaskXObjectGroup(a){if(!this.contentVisible)return;const s=this.ctx,f=this.current.fillColor,t=this.current.patternFill;for(let n=0,i=a.length;n<i;n++){const d=a[n],h=d.width,A=d.height,w=this.cachedCanvases.getCanvas("maskCanvas",h,A,!1),N=w.context;N.save(),m(N,d),N.globalCompositeOperation="source-in",N.fillStyle=t?f.getPattern(N,this,s.mozCurrentTransformInverse,Q.PathType.FILL):f,N.fillRect(0,0,h,A),N.restore(),s.save(),s.transform.apply(s,d.transform),s.scale(1,-1),y(s,w.canvas,0,0,h,A,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(a){if(!this.contentVisible)return;const s=this.getObject(a);if(!s){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(a,s,f,t){if(!this.contentVisible)return;const n=this.getObject(a);if(!n){(0,c.warn)("Dependent image isn't ready yet");return}const i=n.width,d=n.height,h=[];for(let A=0,w=t.length;A<w;A+=2)h.push({transform:[s,0,0,f,t[A],t[A+1]],x:0,y:0,w:i,h:d});this.paintInlineImageXObjectGroup(n,h)}paintInlineImageXObject(a){if(!this.contentVisible)return;const s=a.width,f=a.height,t=this.ctx;this.save(),t.scale(1/s,-1/f);let n;if(typeof HTMLElement=="function"&&a instanceof HTMLElement||!a.data)n=a;else{const A=this.cachedCanvases.getCanvas("inlineImage",s,f,!1),w=A.context;o(w,a,this.current.transferMaps),n=A.canvas}const i=this._scaleImage(n,t.mozCurrentTransformInverse);t.imageSmoothingEnabled=z(t.mozCurrentTransform,a.interpolate);const[d,h]=y(t,i.img,0,0,i.paintWidth,i.paintHeight,0,-f,s,f);if(this.imageLayer){const A=this.getCanvasPosition(0,-f);this.imageLayer.appendImage({imgData:a,left:A[0],top:A[1],width:d,height:h})}this.compose(),this.restore()}paintInlineImageXObjectGroup(a,s){if(!this.contentVisible)return;const f=this.ctx,t=a.width,n=a.height,i=this.cachedCanvases.getCanvas("inlineImage",t,n,!1),d=i.context;o(d,a,this.current.transferMaps);for(let h=0,A=s.length;h<A;h++){const w=s[h];if(f.save(),f.transform.apply(f,w.transform),f.scale(1,-1),y(f,i.canvas,w.x,w.y,w.w,w.h,0,-1,1,1),this.imageLayer){const N=this.getCanvasPosition(w.x,w.y);this.imageLayer.appendImage({imgData:a,left:N[0],top:N[1],width:t,height:n})}f.restore()}this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(a){}markPointProps(a,s){}beginMarkedContent(a){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(a,s){a==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(a){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(a);const f=this.ctx;this.pendingClip&&(s||(this.pendingClip===et?f.clip("evenodd"):f.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),f.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const a=this.ctx.mozCurrentTransform;if(a[1]===0&&a[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(a[0]),Math.abs(a[3]));else{const s=Math.abs(a[0]*a[3]-a[2]*a[1]),f=Math.hypot(a[0],a[2]),t=Math.hypot(a[1],a[3]);this._cachedGetSinglePixelWidth=Math.max(f,t)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:a}=this.current,s=this.ctx.mozCurrentTransform;let f,t;if(s[1]===0&&s[2]===0){const n=Math.abs(s[0]),i=Math.abs(s[3]);if(a===0)f=1/n,t=1/i;else{const d=n*a,h=i*a;f=d<1?1/d:1,t=h<1?1/h:1}}else{const n=Math.abs(s[0]*s[3]-s[2]*s[1]),i=Math.hypot(s[0],s[1]),d=Math.hypot(s[2],s[3]);if(a===0)f=d/n,t=i/n;else{const h=a*n;f=d>h?d/h:1,t=i>h?i/h:1}}this._cachedScaleForStroking=[f,t]}return this._cachedScaleForStroking}rescaleAndStroke(a){const{ctx:s}=this,{lineWidth:f}=this.current,[t,n]=this.getScaleForStroking();if(s.lineWidth=f||1,t===1&&n===1){s.stroke();return}let i,d,h;a&&(i=s.mozCurrentTransform.slice(),d=s.getLineDash().slice(),h=s.lineDashOffset),s.scale(t,n);const A=Math.max(t,n);s.setLineDash(s.getLineDash().map(w=>w/A)),s.lineDashOffset/=A,s.stroke(),a&&(s.setTransform(...i),s.setLineDash(d),s.lineDashOffset=h)}getCanvasPosition(a,s){const f=this.ctx.mozCurrentTransform;return[f[0]*a+f[2]*s+f[4],f[1]*a+f[3]*s+f[5]]}isContentVisible(){for(let a=this.markedContentStack.length-1;a>=0;a--)if(!this.markedContentStack[a].visible)return!1;return!0}}g.CanvasGraphics=ot;for(const S in c.OPS)ot.prototype[S]!==void 0&&(ot.prototype[c.OPS[S]]=ot.prototype[S])},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.TilingPattern=g.PathType=void 0,g.getShadingPattern=b;var c=H(1),Q=H(3);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};g.PathType=q;function G(r,p){if(!p||Q.isNodeJS)return;const C=p[2]-p[0],y=p[3]-p[1],v=new Path2D;v.rect(p[0],p[1],C,y),r.clip(v)}class U{constructor(){this.constructor===U&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class R extends U{constructor(p){super(),this._type=p[1],this._bbox=p[2],this._colorStops=p[3],this._p0=p[4],this._p1=p[5],this._r0=p[6],this._r1=p[7],this.matrix=null}_createGradient(p){let C;this._type==="axial"?C=p.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=p.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const y of this._colorStops)C.addColorStop(y[0],y[1]);return C}getPattern(p,C,y,v){let e;if(v===q.STROKE||v===q.FILL){const o=C.current.getClippedPathBoundingBox(v,p.mozCurrentTransform)||[0,0,0,0],m=Math.ceil(o[2]-o[0])||1,P=Math.ceil(o[3]-o[1])||1,x=C.cachedCanvases.getCanvas("pattern",m,P,!0),k=x.context;k.clearRect(0,0,k.canvas.width,k.canvas.height),k.beginPath(),k.rect(0,0,k.canvas.width,k.canvas.height),k.translate(-o[0],-o[1]),y=c.Util.transform(y,[1,0,0,1,o[0],o[1]]),k.transform.apply(k,C.baseTransform),this.matrix&&k.transform.apply(k,this.matrix),G(k,this._bbox),k.fillStyle=this._createGradient(k),k.fill(),e=p.createPattern(x.canvas,"no-repeat");const E=new DOMMatrix(y);try{e.setTransform(E)}catch(D){(0,c.warn)(`RadialAxialShadingPattern.getPattern: "${D==null?void 0:D.message}".`)}}else G(p,this._bbox),e=this._createGradient(p);return e}}function _(r,p,C,y,v,e,o,m){const P=p.coords,x=p.colors,k=r.data,E=r.width*4;let D;P[C+1]>P[y+1]&&(D=C,C=y,y=D,D=e,e=o,o=D),P[y+1]>P[v+1]&&(D=y,y=v,v=D,D=o,o=m,m=D),P[C+1]>P[y+1]&&(D=C,C=y,y=D,D=e,e=o,o=D);const $=(P[C]+p.offsetX)*p.scaleX,B=(P[C+1]+p.offsetY)*p.scaleY,z=(P[y]+p.offsetX)*p.scaleX,K=(P[y+1]+p.offsetY)*p.scaleY,Z=(P[v]+p.offsetX)*p.scaleX,Y=(P[v+1]+p.offsetY)*p.scaleY;if(B>=Y)return;const et=x[e],ot=x[e+1],S=x[e+2],a=x[o],s=x[o+1],f=x[o+2],t=x[m],n=x[m+1],i=x[m+2],d=Math.round(B),h=Math.round(Y);let A,w,N,O,W,L,X,st;for(let rt=d;rt<=h;rt++){if(rt<K){let nt;rt<B?nt=0:nt=(B-rt)/(B-K),A=$-($-z)*nt,w=et-(et-a)*nt,N=ot-(ot-s)*nt,O=S-(S-f)*nt}else{let nt;rt>Y?nt=1:K===Y?nt=0:nt=(K-rt)/(K-Y),A=z-(z-Z)*nt,w=a-(a-t)*nt,N=s-(s-n)*nt,O=f-(f-i)*nt}let it;rt<B?it=0:rt>Y?it=1:it=(B-rt)/(B-Y),W=$-($-Z)*it,L=et-(et-t)*it,X=ot-(ot-n)*it,st=S-(S-i)*it;const tt=Math.round(Math.min(A,W)),lt=Math.round(Math.max(A,W));let ct=E*rt+tt*4;for(let nt=tt;nt<=lt;nt++)it=(A-nt)/(A-W),it<0?it=0:it>1&&(it=1),k[ct++]=w-(w-L)*it|0,k[ct++]=N-(N-X)*it|0,k[ct++]=O-(O-st)*it|0,k[ct++]=255}}function T(r,p,C){const y=p.coords,v=p.colors;let e,o;switch(p.type){case"lattice":const m=p.verticesPerRow,P=Math.floor(y.length/m)-1,x=m-1;for(e=0;e<P;e++){let k=e*m;for(let E=0;E<x;E++,k++)_(r,C,y[k],y[k+1],y[k+m],v[k],v[k+1],v[k+m]),_(r,C,y[k+m+1],y[k+1],y[k+m],v[k+m+1],v[k+1],v[k+m])}break;case"triangles":for(e=0,o=y.length;e<o;e+=3)_(r,C,y[e],y[e+1],y[e+2],v[e],v[e+1],v[e+2]);break;default:throw new Error("illegal figure")}}class F extends U{constructor(p){super(),this._coords=p[2],this._colors=p[3],this._figures=p[4],this._bounds=p[5],this._bbox=p[7],this._background=p[8],this.matrix=null}_createMeshCanvas(p,C,y){const m=Math.floor(this._bounds[0]),P=Math.floor(this._bounds[1]),x=Math.ceil(this._bounds[2])-m,k=Math.ceil(this._bounds[3])-P,E=Math.min(Math.ceil(Math.abs(x*p[0]*1.1)),3e3),D=Math.min(Math.ceil(Math.abs(k*p[1]*1.1)),3e3),$=x/E,B=k/D,z={coords:this._coords,colors:this._colors,offsetX:-m,offsetY:-P,scaleX:1/$,scaleY:1/B},K=E+2*2,Z=D+2*2,Y=y.getCanvas("mesh",K,Z,!1),et=Y.context,ot=et.createImageData(E,D);if(C){const a=ot.data;for(let s=0,f=a.length;s<f;s+=4)a[s]=C[0],a[s+1]=C[1],a[s+2]=C[2],a[s+3]=255}for(const a of this._figures)T(ot,a,z);return et.putImageData(ot,2,2),{canvas:Y.canvas,offsetX:m-2*$,offsetY:P-2*B,scaleX:$,scaleY:B}}getPattern(p,C,y,v){G(p,this._bbox);let e;if(v===q.SHADING)e=c.Util.singularValueDecompose2dScale(p.mozCurrentTransform);else if(e=c.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const m=c.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*m[0],e[1]*m[1]]}const o=this._createMeshCanvas(e,v===q.SHADING?null:this._background,C.cachedCanvases);return v!==q.SHADING&&(p.setTransform.apply(p,C.baseTransform),this.matrix&&p.transform.apply(p,this.matrix)),p.translate(o.offsetX,o.offsetY),p.scale(o.scaleX,o.scaleY),p.createPattern(o.canvas,"no-repeat")}}class M extends U{getPattern(){return"hotpink"}}function b(r){switch(r[0]){case"RadialAxial":return new R(r);case"Mesh":return new F(r);case"Dummy":return new M}throw new Error(`Unknown IR type: ${r[0]}`)}const l={COLORED:1,UNCOLORED:2};class u{static get MAX_PATTERN_SIZE(){return(0,c.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(p,C,y,v,e){this.operatorList=p[2],this.matrix=p[3]||[1,0,0,1,0,0],this.bbox=p[4],this.xstep=p[5],this.ystep=p[6],this.paintType=p[7],this.tilingType=p[8],this.color=C,this.ctx=y,this.canvasGraphicsFactory=v,this.baseTransform=e}createPatternCanvas(p){const C=this.operatorList,y=this.bbox,v=this.xstep,e=this.ystep,o=this.paintType,m=this.tilingType,P=this.color,x=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+m);const k=y[0],E=y[1],D=y[2],$=y[3],B=c.Util.singularValueDecompose2dScale(this.matrix),z=c.Util.singularValueDecompose2dScale(this.baseTransform),K=[B[0]*z[0],B[1]*z[1]],Z=this.getSizeAndScale(v,this.ctx.canvas.width,K[0]),Y=this.getSizeAndScale(e,this.ctx.canvas.height,K[1]),et=p.cachedCanvases.getCanvas("pattern",Z.size,Y.size,!0),ot=et.context,S=x.createCanvasGraphics(ot);S.groupLevel=p.groupLevel,this.setFillAndStrokeStyleToContext(S,o,P);let a=k,s=E,f=D,t=$;return k<0&&(a=0,f+=Math.abs(k)),E<0&&(s=0,t+=Math.abs(E)),ot.translate(-(Z.scale*a),-(Y.scale*s)),S.transform(Z.scale,0,0,Y.scale,0,0),ot.save(),this.clipBbox(S,a,s,f,t),S.baseTransform=S.ctx.mozCurrentTransform.slice(),S.executeOperatorList(C),S.endDrawing(),{canvas:et.canvas,scaleX:Z.scale,scaleY:Y.scale,offsetX:a,offsetY:s}}getSizeAndScale(p,C,y){p=Math.abs(p);const v=Math.max(u.MAX_PATTERN_SIZE,C);let e=Math.ceil(p*y);return e>=v?e=v:y=e/p,{scale:y,size:e}}clipBbox(p,C,y,v,e){const o=v-C,m=e-y;p.ctx.rect(C,y,o,m),p.current.updateRectMinMax(p.ctx.mozCurrentTransform,[C,y,v,e]),p.clip(),p.endPath()}setFillAndStrokeStyleToContext(p,C,y){const v=p.ctx,e=p.current;switch(C){case l.COLORED:const o=this.ctx;v.fillStyle=o.fillStyle,v.strokeStyle=o.strokeStyle,e.fillColor=o.fillStyle,e.strokeColor=o.strokeStyle;break;case l.UNCOLORED:const m=c.Util.makeHexColor(y[0],y[1],y[2]);v.fillStyle=m,v.strokeStyle=m,e.fillColor=m,e.strokeColor=m;break;default:throw new c.FormatError(`Unsupported paint type: ${C}`)}}getPattern(p,C,y,v){let e=y;v!==q.SHADING&&(e=c.Util.transform(e,C.baseTransform),this.matrix&&(e=c.Util.transform(e,this.matrix)));const o=this.createPatternCanvas(C);let m=new DOMMatrix(e);m=m.translate(o.offsetX,o.offsetY),m=m.scale(1/o.scaleX,1/o.scaleY);const P=p.createPattern(o.canvas,"repeat");try{P.setTransform(m)}catch(x){(0,c.warn)(`TilingPattern.getPattern: "${x==null?void 0:x.message}".`)}return P}}g.TilingPattern=u},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.applyMaskImageData=Q;var c=H(1);function Q({src:q,srcPos:G=0,dest:U,destPos:R=0,width:_,height:T,inverseDecode:F=!1}){const M=c.FeatureTest.isLittleEndian?4278190080:255,[b,l]=F?[0,M]:[M,0],u=_>>3,r=_&7,p=q.length;U=new Uint32Array(U.buffer);for(let C=0;C<T;C++){for(const v=G+u;G<v;G++){const e=G<p?q[G]:255;U[R++]=e&128?l:b,U[R++]=e&64?l:b,U[R++]=e&32?l:b,U[R++]=e&16?l:b,U[R++]=e&8?l:b,U[R++]=e&4?l:b,U[R++]=e&2?l:b,U[R++]=e&1?l:b}if(r===0)continue;const y=G<p?q[G++]:255;for(let v=0;v<r;v++)U[R++]=y&1<<7-v?l:b}return{srcPos:G,destPos:R}}},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.GlobalWorkerOptions=void 0;const H=Object.create(null);g.GlobalWorkerOptions=H,H.workerPort=H.workerPort===void 0?null:H.workerPort,H.workerSrc=H.workerSrc===void 0?"":H.workerSrc},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.MessageHandler=void 0;var c=H(1);const Q={UNKNOWN:0,DATA:1,ERROR:2},q={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function G(R){switch(R instanceof Error||typeof R=="object"&&R!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),R.name){case"AbortException":return new c.AbortException(R.message);case"MissingPDFException":return new c.MissingPDFException(R.message);case"PasswordException":return new c.PasswordException(R.message,R.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(R.message,R.status);case"UnknownErrorException":return new c.UnknownErrorException(R.message,R.details);default:return new c.UnknownErrorException(R.message,R.toString())}}class U{constructor(_,T,F){this.sourceName=_,this.targetName=T,this.comObj=F,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=M=>{const b=M.data;if(b.targetName!==this.sourceName)return;if(b.stream){this._processStreamMessage(b);return}if(b.callback){const u=b.callbackId,r=this.callbackCapabilities[u];if(!r)throw new Error(`Cannot resolve callback ${u}`);if(delete this.callbackCapabilities[u],b.callback===Q.DATA)r.resolve(b.data);else if(b.callback===Q.ERROR)r.reject(G(b.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[b.action];if(!l)throw new Error(`Unknown action from worker: ${b.action}`);if(b.callbackId){const u=this.sourceName,r=b.sourceName;new Promise(function(p){p(l(b.data))}).then(function(p){F.postMessage({sourceName:u,targetName:r,callback:Q.DATA,callbackId:b.callbackId,data:p})},function(p){F.postMessage({sourceName:u,targetName:r,callback:Q.ERROR,callbackId:b.callbackId,reason:G(p)})});return}if(b.streamId){this._createStreamSink(b);return}l(b.data)},F.addEventListener("message",this._onComObjOnMessage)}on(_,T){const F=this.actionHandler;if(F[_])throw new Error(`There is already an actionName called "${_}"`);F[_]=T}send(_,T,F){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,data:T},F)}sendWithPromise(_,T,F){const M=this.callbackId++,b=(0,c.createPromiseCapability)();this.callbackCapabilities[M]=b;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,callbackId:M,data:T},F)}catch(l){b.reject(l)}return b.promise}sendWithStream(_,T,F,M){const b=this.streamId++,l=this.sourceName,u=this.targetName,r=this.comObj;return new ReadableStream({start:p=>{const C=(0,c.createPromiseCapability)();return this.streamControllers[b]={controller:p,startCall:C,pullCall:null,cancelCall:null,isClosed:!1},r.postMessage({sourceName:l,targetName:u,action:_,streamId:b,data:T,desiredSize:p.desiredSize},M),C.promise},pull:p=>{const C=(0,c.createPromiseCapability)();return this.streamControllers[b].pullCall=C,r.postMessage({sourceName:l,targetName:u,stream:q.PULL,streamId:b,desiredSize:p.desiredSize}),C.promise},cancel:p=>{(0,c.assert)(p instanceof Error,"cancel must have a valid reason");const C=(0,c.createPromiseCapability)();return this.streamControllers[b].cancelCall=C,this.streamControllers[b].isClosed=!0,r.postMessage({sourceName:l,targetName:u,stream:q.CANCEL,streamId:b,reason:G(p)}),C.promise}},F)}_createStreamSink(_){const T=_.streamId,F=this.sourceName,M=_.sourceName,b=this.comObj,l=this,u=this.actionHandler[_.action],r={enqueue(p,C=1,y){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=C,v>0&&this.desiredSize<=0&&(this.sinkCapability=(0,c.createPromiseCapability)(),this.ready=this.sinkCapability.promise),b.postMessage({sourceName:F,targetName:M,stream:q.ENQUEUE,streamId:T,chunk:p},y)},close(){this.isCancelled||(this.isCancelled=!0,b.postMessage({sourceName:F,targetName:M,stream:q.CLOSE,streamId:T}),delete l.streamSinks[T])},error(p){(0,c.assert)(p instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,b.postMessage({sourceName:F,targetName:M,stream:q.ERROR,streamId:T,reason:G(p)}))},sinkCapability:(0,c.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:_.desiredSize,ready:null};r.sinkCapability.resolve(),r.ready=r.sinkCapability.promise,this.streamSinks[T]=r,new Promise(function(p){p(u(_.data,r))}).then(function(){b.postMessage({sourceName:F,targetName:M,stream:q.START_COMPLETE,streamId:T,success:!0})},function(p){b.postMessage({sourceName:F,targetName:M,stream:q.START_COMPLETE,streamId:T,reason:G(p)})})}_processStreamMessage(_){const T=_.streamId,F=this.sourceName,M=_.sourceName,b=this.comObj,l=this.streamControllers[T],u=this.streamSinks[T];switch(_.stream){case q.START_COMPLETE:_.success?l.startCall.resolve():l.startCall.reject(G(_.reason));break;case q.PULL_COMPLETE:_.success?l.pullCall.resolve():l.pullCall.reject(G(_.reason));break;case q.PULL:if(!u){b.postMessage({sourceName:F,targetName:M,stream:q.PULL_COMPLETE,streamId:T,success:!0});break}u.desiredSize<=0&&_.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=_.desiredSize,new Promise(function(r){r(u.onPull&&u.onPull())}).then(function(){b.postMessage({sourceName:F,targetName:M,stream:q.PULL_COMPLETE,streamId:T,success:!0})},function(r){b.postMessage({sourceName:F,targetName:M,stream:q.PULL_COMPLETE,streamId:T,reason:G(r)})});break;case q.ENQUEUE:if((0,c.assert)(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(_.chunk);break;case q.CLOSE:if((0,c.assert)(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this._deleteStreamController(l,T);break;case q.ERROR:(0,c.assert)(l,"error should have stream controller"),l.controller.error(G(_.reason)),this._deleteStreamController(l,T);break;case q.CANCEL_COMPLETE:_.success?l.cancelCall.resolve():l.cancelCall.reject(G(_.reason)),this._deleteStreamController(l,T);break;case q.CANCEL:if(!u)break;new Promise(function(r){r(u.onCancel&&u.onCancel(G(_.reason)))}).then(function(){b.postMessage({sourceName:F,targetName:M,stream:q.CANCEL_COMPLETE,streamId:T,success:!0})},function(r){b.postMessage({sourceName:F,targetName:M,stream:q.CANCEL_COMPLETE,streamId:T,reason:G(r)})}),u.sinkCapability.reject(G(_.reason)),u.isCancelled=!0,delete this.streamSinks[T];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(_,T){await Promise.allSettled([_.startCall&&_.startCall.promise,_.pullCall&&_.pullCall.promise,_.cancelCall&&_.cancelCall.promise]),delete this.streamControllers[T]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}g.MessageHandler=U},(J,g,H)=>{var q,G;Object.defineProperty(g,"__esModule",{value:!0}),g.Metadata=void 0;var c=H(1);class Q{constructor({parsedData:R,rawData:_}){xt(this,q,void 0);xt(this,G,void 0);Pt(this,q,R),Pt(this,G,_)}getRaw(){return dt(this,G)}get(R){var _;return(_=dt(this,q).get(R))!=null?_:null}getAll(){return(0,c.objectFromMap)(dt(this,q))}has(R){return dt(this,q).has(R)}}q=new WeakMap,G=new WeakMap,g.Metadata=Q},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.OptionalContentConfig=void 0;var c=H(1);class Q{constructor(U,R){this.visible=!0,this.name=U,this.intent=R}}class q{constructor(U){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,U!==null){this.name=U.name,this.creator=U.creator,this._order=U.order;for(const R of U.groups)this._groups.set(R.id,new Q(R.name,R.intent));if(U.baseState==="OFF")for(const R of this._groups)R.visible=!1;for(const R of U.on)this._groups.get(R).visible=!0;for(const R of U.off)this._groups.get(R).visible=!1}}_evaluateVisibilityExpression(U){const R=U.length;if(R<2)return!0;const _=U[0];for(let T=1;T<R;T++){const F=U[T];let M;if(Array.isArray(F))M=this._evaluateVisibilityExpression(F);else if(this._groups.has(F))M=this._groups.get(F).visible;else return(0,c.warn)(`Optional content group not found: ${F}`),!0;switch(_){case"And":if(!M)return!1;break;case"Or":if(M)return!0;break;case"Not":return!M;default:return!0}}return _==="And"}isVisible(U){if(this._groups.size===0)return!0;if(!U)return(0,c.warn)("Optional content group not defined."),!0;if(U.type==="OCG")return this._groups.has(U.id)?this._groups.get(U.id).visible:((0,c.warn)(`Optional content group not found: ${U.id}`),!0);if(U.type==="OCMD"){if(U.expression)return this._evaluateVisibilityExpression(U.expression);if(!U.policy||U.policy==="AnyOn"){for(const R of U.ids){if(!this._groups.has(R))return(0,c.warn)(`Optional content group not found: ${R}`),!0;if(this._groups.get(R).visible)return!0}return!1}else if(U.policy==="AllOn"){for(const R of U.ids){if(!this._groups.has(R))return(0,c.warn)(`Optional content group not found: ${R}`),!0;if(!this._groups.get(R).visible)return!1}return!0}else if(U.policy==="AnyOff"){for(const R of U.ids){if(!this._groups.has(R))return(0,c.warn)(`Optional content group not found: ${R}`),!0;if(!this._groups.get(R).visible)return!0}return!1}else if(U.policy==="AllOff"){for(const R of U.ids){if(!this._groups.has(R))return(0,c.warn)(`Optional content group not found: ${R}`),!0;if(this._groups.get(R).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${U.policy}.`),!0}return(0,c.warn)(`Unknown group type ${U.type}.`),!0}setVisibility(U,R=!0){if(!this._groups.has(U)){(0,c.warn)(`Optional content group not found: ${U}`);return}this._groups.get(U).visible=!!R}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,c.objectFromMap)(this._groups):null}getGroup(U){return this._groups.get(U)||null}}g.OptionalContentConfig=q},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFDataTransportStream=void 0;var c=H(1),Q=H(5);class q{constructor(_,T){(0,c.assert)(T,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=_.progressiveDone||!1,this._contentDispositionFilename=_.contentDispositionFilename||null;const F=_.initialData;if((F==null?void 0:F.length)>0){const M=new Uint8Array(F).buffer;this._queuedChunks.push(M)}this._pdfDataRangeTransport=T,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._contentLength=_.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((M,b)=>{this._onReceiveData({begin:M,chunk:b})}),this._pdfDataRangeTransport.addProgressListener((M,b)=>{this._onProgress({loaded:M,total:b})}),this._pdfDataRangeTransport.addProgressiveReadListener(M=>{this._onReceiveData({chunk:M})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(_){const T=new Uint8Array(_.chunk).buffer;if(_.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(T):this._queuedChunks.push(T);else{const F=this._rangeReaders.some(function(M){return M._begin!==_.begin?!1:(M._enqueue(T),!0)});(0,c.assert)(F,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var _,T;return(T=(_=this._fullRequestReader)==null?void 0:_._loaded)!=null?T:0}_onProgress(_){if(_.total===void 0){const T=this._rangeReaders[0];T!=null&&T.onProgress&&T.onProgress({loaded:_.loaded})}else{const T=this._fullRequestReader;T!=null&&T.onProgress&&T.onProgress({loaded:_.loaded,total:_.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(_){const T=this._rangeReaders.indexOf(_);T>=0&&this._rangeReaders.splice(T,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const _=this._queuedChunks;return this._queuedChunks=null,new G(this,_,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(_,T){if(T<=this._progressiveDataLength)return null;const F=new U(this,_,T);return this._pdfDataRangeTransport.requestDataRange(_,T),this._rangeReaders.push(F),F}cancelAllRequests(_){this._fullRequestReader&&this._fullRequestReader.cancel(_);for(const T of this._rangeReaders.slice(0))T.cancel(_);this._pdfDataRangeTransport.abort()}}g.PDFDataTransportStream=q;class G{constructor(_,T,F=!1,M=null){this._stream=_,this._done=F||!1,this._filename=(0,Q.isPdfFile)(M)?M:null,this._queuedChunks=T||[],this._loaded=0;for(const b of this._queuedChunks)this._loaded+=b.byteLength;this._requests=[],this._headersReady=Promise.resolve(),_._fullRequestReader=this,this.onProgress=null}_enqueue(_){this._done||(this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunks.push(_),this._loaded+=_.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=(0,c.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const T of this._requests)T.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class U{constructor(_,T,F){this._stream=_,this._begin=T,this._end=F,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(_){if(!this._done){if(this._requests.length===0)this._queuedChunk=_;else{this._requests.shift().resolve({value:_,done:!1});for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const T=this._queuedChunk;return this._queuedChunk=null,{value:T,done:!1}}if(this._done)return{value:void 0,done:!0};const _=(0,c.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const T of this._requests)T.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.XfaText=void 0;class H{static textContent(Q){const q=[],G={items:q,styles:Object.create(null)};function U(R){var F;if(!R)return;let _=null;const T=R.name;if(T==="#text")_=R.value;else if(H.shouldBuildText(T))(F=R==null?void 0:R.attributes)!=null&&F.textContent?_=R.attributes.textContent:R.value&&(_=R.value);else return;if(_!==null&&q.push({str:_}),!!R.children)for(const M of R.children)U(M)}return U(Q),G}static shouldBuildText(Q){return!(Q==="textarea"||Q==="input"||Q==="option"||Q==="select")}}g.XfaText=H},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.NodeStandardFontDataFactory=g.NodeCanvasFactory=g.NodeCMapReaderFactory=void 0;var c=H(6);const Q=function(R){return new Promise((_,T)=>{require$$5.readFile(R,(M,b)=>{if(M||!b){T(new Error(M));return}_(new Uint8Array(b))})})};class q extends c.BaseCanvasFactory{_createCanvas(_,T){return require$$5.createCanvas(_,T)}}g.NodeCanvasFactory=q;class G extends c.BaseCMapReaderFactory{_fetchData(_,T){return Q(_).then(F=>({cMapData:F,compressionType:T}))}}g.NodeCMapReaderFactory=G;class U extends c.BaseStandardFontDataFactory{_fetchData(_){return Q(_)}}g.NodeStandardFontDataFactory=U},(J,g,H)=>{var a,Vt;Object.defineProperty(g,"__esModule",{value:!0}),g.AnnotationLayer=void 0;var c=H(1),Q=H(5),q=H(8),G=H(21),U=H(22);const R=1e3,_=new WeakSet;function T(f){return{width:f[2]-f[0],height:f[3]-f[1]}}class F{static create(t){switch(t.data.annotationType){case c.AnnotationType.LINK:return new b(t);case c.AnnotationType.TEXT:return new l(t);case c.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new r(t);case"Btn":return t.data.radioButton?new C(t):t.data.checkBox?new p(t):new y(t);case"Ch":return new v(t)}return new u(t);case c.AnnotationType.POPUP:return new e(t);case c.AnnotationType.FREETEXT:return new m(t);case c.AnnotationType.LINE:return new P(t);case c.AnnotationType.SQUARE:return new x(t);case c.AnnotationType.CIRCLE:return new k(t);case c.AnnotationType.POLYLINE:return new E(t);case c.AnnotationType.CARET:return new $(t);case c.AnnotationType.INK:return new B(t);case c.AnnotationType.POLYGON:return new D(t);case c.AnnotationType.HIGHLIGHT:return new z(t);case c.AnnotationType.UNDERLINE:return new K(t);case c.AnnotationType.SQUIGGLY:return new Z(t);case c.AnnotationType.STRIKEOUT:return new Y(t);case c.AnnotationType.STAMP:return new et(t);case c.AnnotationType.FILEATTACHMENT:return new ot(t);default:return new M(t)}}}class M{constructor(t,{isRenderable:n=!1,ignoreBorder:i=!1,createQuadrilaterals:d=!1}={}){this.isRenderable=n,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,n&&(this.container=this._createContainer(i)),d&&(this.quadrilaterals=this._createQuadrilaterals(i))}_createContainer(t=!1){const n=this.data,i=this.page,d=this.viewport,h=document.createElement("section");let{width:A,height:w}=T(n.rect);h.setAttribute("data-annotation-id",n.id);const N=c.Util.normalizeRect([n.rect[0],i.view[3]-n.rect[1]+i.view[1],n.rect[2],i.view[3]-n.rect[3]+i.view[1]]);if(n.hasOwnCanvas){const O=d.transform.slice(),[W,L]=c.Util.singularValueDecompose2dScale(O);A=Math.ceil(A*W),w=Math.ceil(w*L),N[0]*=W,N[1]*=L;for(let X=0;X<4;X++)O[X]=Math.sign(O[X]);h.style.transform=`matrix(${O.join(",")})`}else h.style.transform=`matrix(${d.transform.join(",")})`;if(h.style.transformOrigin=`${-N[0]}px ${-N[1]}px`,!t&&n.borderStyle.width>0){h.style.borderWidth=`${n.borderStyle.width}px`,n.borderStyle.style!==c.AnnotationBorderStyleType.UNDERLINE&&(A-=2*n.borderStyle.width,w-=2*n.borderStyle.width);const O=n.borderStyle.horizontalCornerRadius,W=n.borderStyle.verticalCornerRadius;if(O>0||W>0){const X=`${O}px / ${W}px`;h.style.borderRadius=X}switch(n.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:h.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:h.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:h.style.borderBottomStyle="solid";break}n.borderColor||n.color||null?h.style.borderColor=c.Util.makeHexColor(n.color[0]|0,n.color[1]|0,n.color[2]|0):h.style.borderWidth=0}return h.style.left=`${N[0]}px`,h.style.top=`${N[1]}px`,n.hasOwnCanvas?h.style.width=h.style.height="auto":(h.style.width=`${A}px`,h.style.height=`${w}px`),h}get _commonActions(){const t=(n,i,d)=>{const h=d.detail[n];d.target.style[i]=G.ColorConverters[`${h[0]}_HTML`](h.slice(1))};return(0,c.shadow)(this,"_commonActions",{display:n=>{const i=n.detail.display%2===1;n.target.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:i,print:n.detail.display===0||n.detail.display===3})},print:n=>{this.annotationStorage.setValue(this.data.id,{print:n.detail.print})},hidden:n=>{n.target.style.visibility=n.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:n.detail.hidden})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.detail.readonly?n.target.setAttribute("readonly",""):n.target.removeAttribute("readonly")},required:n=>{n.detail.required?n.target.setAttribute("required",""):n.target.removeAttribute("required")},bgColor:n=>{t("bgColor","backgroundColor",n)},fillColor:n=>{t("fillColor","backgroundColor",n)},fgColor:n=>{t("fgColor","color",n)},textColor:n=>{t("textColor","color",n)},borderColor:n=>{t("borderColor","borderColor",n)},strokeColor:n=>{t("strokeColor","borderColor",n)}})}_dispatchEventFromSandbox(t,n){const i=this._commonActions;for(const d of Object.keys(n.detail)){const h=t[d]||i[d];h&&h(n)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const i=this._commonActions;for(const[d,h]of Object.entries(n)){const A=i[d];A&&(A({detail:h,target:t}),delete n[d])}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const n=[],i=this.data.rect;for(const d of this.data.quadPoints)this.data.rect=[d[2].x,d[2].y,d[1].x,d[1].y],n.push(this._createContainer(t));return this.data.rect=i,n}_createPopup(t,n){let i=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,i=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.style.height=i.style.height,t.style.width=i.style.width,i.appendChild(t));const h=new o({container:i,trigger:t,color:n.color,titleObj:n.titleObj,modificationDate:n.modificationDate,contentsObj:n.contentsObj,richText:n.richText,hideWrapper:!0}).render();h.style.left=i.style.width,i.appendChild(h)}_renderQuadrilaterals(t){for(const n of this.quadrilaterals)n.className=t;return this.quadrilaterals}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,n=null){const i=[];if(this._fieldObjects){const d=this._fieldObjects[t];if(d)for(const{page:h,id:A,exportValues:w}of d){if(h===-1||A===n)continue;const N=typeof w=="string"?w:null,O=document.getElementById(A);if(O&&!_.has(O)){(0,c.warn)(`_getElementsByName - element not allowed: ${A}`);continue}i.push({id:A,exportValue:N,domElement:O})}return i}for(const d of document.getElementsByName(t)){const{id:h,exportValue:A}=d;h!==n&&(!_.has(d)||i.push({id:h,exportValue:A,domElement:d}))}return i}static get platform(){const t=typeof navigator<"u"?navigator.platform:"";return(0,c.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class b extends M{constructor(t,n=null){const i=!!(t.data.url||t.data.dest||t.data.action||t.data.isTooltipOnly||t.data.resetForm||t.data.actions&&(t.data.actions.Action||t.data.actions["Mouse Up"]||t.data.actions["Mouse Down"]));super(t,{isRenderable:i,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0})}render(){const{data:t,linkService:n}=this,i=document.createElement("a");if(t.url)n.addLinkAttributes(i,t.url,t.newWindow);else if(t.action)this._bindNamedAction(i,t.action);else if(t.dest)this._bindLink(i,t.dest);else{let d=!1;t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(d=!0,this._bindJSAction(i,t)),t.resetForm?this._bindResetFormAction(i,t.resetForm):d||this._bindLink(i,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((d,h)=>{const A=h===0?i:i.cloneNode();return d.appendChild(A),d}):(this.container.className="linkAnnotation",this.container.appendChild(i),this.container)}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&(t.className="internalLink")}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),t.className="internalLink"}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const d of Object.keys(n.actions)){const h=i.get(d);!h||(t[h]=()=>{var A;return(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:d}}),!1})}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,n){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var W;i&&i();const{fields:d,refs:h,include:A}=n,w=[];if(d.length!==0||h.length!==0){const L=new Set(h);for(const X of d){const st=this._fieldObjects[X]||[];for(const{id:rt}of st)L.add(rt)}for(const X of Object.values(this._fieldObjects))for(const st of X)L.has(st.id)===A&&w.push(st)}else for(const L of Object.values(this._fieldObjects))w.push(...L);const N=this.annotationStorage,O=[];for(const L of w){const{id:X}=L;switch(O.push(X),L.type){case"text":{const rt=L.defaultValue||"";N.setValue(X,{value:rt});break}case"checkbox":case"radiobutton":{const rt=L.defaultValue===L.exportValues;N.setValue(X,{value:rt});break}case"combobox":case"listbox":{const rt=L.defaultValue||"";N.setValue(X,{value:rt});break}default:continue}const st=document.getElementById(X);!st||!_.has(st)||st.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:O,name:"ResetForm"}})),!1}}}class l extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.appendChild(t),this.container}}class u extends M{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:n,isMac:i}=M.platform;return n&&t.ctrlKey||i&&t.metaKey}_setEventListener(t,n,i,d){n.includes("mouse")?t.addEventListener(n,h=>{var A;(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:d(h),shift:h.shiftKey,modifier:this._getKeyModifier(h)}})}):t.addEventListener(n,h=>{var A;(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:d(h)}})})}_setEventListeners(t,n,i){var d;for(const[h,A]of n)(A==="Action"||((d=this.data.actions)==null?void 0:d[A]))&&this._setEventListener(t,h,A,i)}_setBackgroundColor(t){const n=this.data.backgroundColor||null;t.style.backgroundColor=n===null?"transparent":c.Util.makeHexColor(n[0],n[1],n[2])}}class r extends u{constructor(t){const n=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:n})}setPropertyOnSiblings(t,n,i,d){const h=this.annotationStorage;for(const A of this._getElementsByName(t.name,t.id))A.domElement&&(A.domElement[n]=i),h.setValue(A.id,{[d]:i})}render(){var d;const t=this.annotationStorage,n=this.data.id;this.container.className="textWidgetAnnotation";let i=null;if(this.renderForms){const h=t.getValue(n,{value:this.data.fieldValue}),A=h.formattedValue||h.value||"",w={userValue:null,formattedValue:null,valueOnFocus:""};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=A):(i=document.createElement("input"),i.type="text",i.setAttribute("value",A)),_.add(i),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=R,w.userValue=A,i.setAttribute("id",n),i.addEventListener("input",O=>{t.setValue(n,{value:O.target.value}),this.setPropertyOnSiblings(i,"value",O.target.value,"value")}),i.addEventListener("resetform",O=>{var L;const W=(L=this.data.defaultFieldValue)!=null?L:"";i.value=w.userValue=W,w.formattedValue=null});let N=O=>{const{formattedValue:W}=w;W!=null&&(O.target.value=W),O.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",W=>{w.userValue&&(W.target.value=w.userValue),w.valueOnFocus=W.target.value}),i.addEventListener("updatefromsandbox",W=>{const L={value(X){var st;w.userValue=(st=X.detail.value)!=null?st:"",t.setValue(n,{value:w.userValue.toString()}),X.target.value=w.userValue},formattedValue(X){const{formattedValue:st}=X.detail;w.formattedValue=st,st!=null&&X.target!==document.activeElement&&(X.target.value=st),t.setValue(n,{formattedValue:st})},selRange(X){X.target.setSelectionRange(...X.detail.selRange)}};this._dispatchEventFromSandbox(L,W)}),i.addEventListener("keydown",W=>{var st;let L=-1;if(W.key==="Escape"?L=0:W.key==="Enter"?L=2:W.key==="Tab"&&(L=3),L===-1)return;const{value:X}=W.target;w.valueOnFocus!==X&&(w.userValue=X,(st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:X,willCommit:!0,commitKey:L,selStart:W.target.selectionStart,selEnd:W.target.selectionEnd}}))});const O=N;N=null,i.addEventListener("blur",W=>{var X;const{value:L}=W.target;w.userValue=L,this._mouseState.isDown&&w.valueOnFocus!==L&&((X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:L,willCommit:!0,commitKey:1,selStart:W.target.selectionStart,selEnd:W.target.selectionEnd}})),O(W)}),(d=this.data.actions)!=null&&d.Keystroke&&i.addEventListener("beforeinput",W=>{var ct;const{data:L,target:X}=W,{value:st,selectionStart:rt,selectionEnd:it}=X;let tt=rt,lt=it;switch(W.inputType){case"deleteWordBackward":{const nt=st.substring(0,rt).match(/\w*[^\w]*$/);nt&&(tt-=nt[0].length);break}case"deleteWordForward":{const nt=st.substring(rt).match(/^[^\w]*\w*/);nt&&(lt+=nt[0].length);break}case"deleteContentBackward":rt===it&&(tt-=1);break;case"deleteContentForward":rt===it&&(lt+=1);break}W.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:st,change:L||"",willCommit:!1,selStart:tt,selEnd:lt}})}),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],W=>W.target.value)}if(N&&i.addEventListener("blur",N),this.data.maxLen!==null&&(i.maxLength=this.data.maxLen),this.data.comb){const W=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;i.classList.add("comb"),i.style.letterSpacing=`calc(${W}px - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell";return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.appendChild(i),this.container}_setTextStyle(t){const n=["left","center","right"],{fontSize:i,fontColor:d}=this.data.defaultAppearanceData,h=t.style;i&&(h.fontSize=`${i}px`),h.color=c.Util.makeHexColor(d[0],d[1],d[2]),this.data.textAlignment!==null&&(h.textAlign=n[this.data.textAlignment])}}class p extends u{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,n=this.data,i=n.id;let d=t.getValue(i,{value:n.exportValue===n.fieldValue}).value;typeof d=="string"&&(d=d!=="Off",t.setValue(i,{value:d})),this.container.className="buttonWidgetAnnotation checkBox";const h=document.createElement("input");return _.add(h),h.disabled=n.readOnly,h.type="checkbox",h.name=n.fieldName,d&&h.setAttribute("checked",!0),h.setAttribute("id",i),h.setAttribute("exportValue",n.exportValue),h.tabIndex=R,h.addEventListener("change",A=>{const{name:w,checked:N}=A.target;for(const O of this._getElementsByName(w,i)){const W=N&&O.exportValue===n.exportValue;O.domElement&&(O.domElement.checked=W),t.setValue(O.id,{value:W})}t.setValue(i,{value:N})}),h.addEventListener("resetform",A=>{const w=n.defaultFieldValue||"Off";A.target.checked=w===n.exportValue}),this.enableScripting&&this.hasJSActions&&(h.addEventListener("updatefromsandbox",A=>{const w={value(N){N.target.checked=N.detail.value!=="Off",t.setValue(i,{value:N.target.checked})}};this._dispatchEventFromSandbox(w,A)}),this._setEventListeners(h,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.checked)),this._setBackgroundColor(h),this._setDefaultPropertiesFromJS(h),this.container.appendChild(h),this.container}}class C extends u{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,n=this.data,i=n.id;let d=t.getValue(i,{value:n.fieldValue===n.buttonValue}).value;typeof d=="string"&&(d=d!==n.buttonValue,t.setValue(i,{value:d}));const h=document.createElement("input");if(_.add(h),h.disabled=n.readOnly,h.type="radio",h.name=n.fieldName,d&&h.setAttribute("checked",!0),h.setAttribute("id",i),h.tabIndex=R,h.addEventListener("change",A=>{const{name:w,checked:N}=A.target;for(const O of this._getElementsByName(w,i))t.setValue(O.id,{value:!1});t.setValue(i,{value:N})}),h.addEventListener("resetform",A=>{const w=n.defaultFieldValue;A.target.checked=w!=null&&w===n.buttonValue}),this.enableScripting&&this.hasJSActions){const A=n.buttonValue;h.addEventListener("updatefromsandbox",w=>{const N={value:O=>{const W=A===O.detail.value;for(const L of this._getElementsByName(O.target.name)){const X=W&&L.id===i;L.domElement&&(L.domElement.checked=X),t.setValue(L.id,{value:X})}}};this._dispatchEventFromSandbox(N,w)}),this._setEventListeners(h,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.checked)}return this._setBackgroundColor(h),this._setDefaultPropertiesFromJS(h),this.container.appendChild(h),this.container}}class y extends b{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();return t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText),this._setDefaultPropertiesFromJS(t),t}}class v extends u{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,n=this.data.id,i=t.getValue(n,{value:this.data.fieldValue});let{fontSize:d}=this.data.defaultAppearanceData;d||(d=9);const h=`calc(${d}px * var(--zoom-factor))`,A=document.createElement("select");_.add(A),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.setAttribute("id",n),A.tabIndex=R,A.style.fontSize=`${d}px`,this.data.combo||(A.size=this.data.options.length,this.data.multiSelect&&(A.multiple=!0)),A.addEventListener("resetform",O=>{const W=this.data.defaultFieldValue;for(const L of A.options)L.selected=L.value===W});for(const O of this.data.options){const W=document.createElement("option");W.textContent=O.displayValue,W.value=O.exportValue,this.data.combo&&(W.style.fontSize=h),i.value.includes(O.exportValue)&&W.setAttribute("selected",!0),A.appendChild(W)}const w=(O,W)=>{const L=W?"value":"textContent",X=O.target.options;return O.target.multiple?Array.prototype.filter.call(X,st=>st.selected).map(st=>st[L]):X.selectedIndex===-1?null:X[X.selectedIndex][L]},N=O=>{const W=O.target.options;return Array.prototype.map.call(W,L=>({displayValue:L.textContent,exportValue:L.value}))};return this.enableScripting&&this.hasJSActions?(A.addEventListener("updatefromsandbox",O=>{const W={value(L){const X=L.detail.value,st=new Set(Array.isArray(X)?X:[X]);for(const rt of A.options)rt.selected=st.has(rt.value);t.setValue(n,{value:w(L,!0)})},multipleSelection(L){A.multiple=!0},remove(L){const X=A.options,st=L.detail.remove;X[st].selected=!1,A.remove(st),X.length>0&&Array.prototype.findIndex.call(X,it=>it.selected)===-1&&(X[0].selected=!0),t.setValue(n,{value:w(L,!0),items:N(L)})},clear(L){for(;A.length!==0;)A.remove(0);t.setValue(n,{value:null,items:[]})},insert(L){const{index:X,displayValue:st,exportValue:rt}=L.detail.insert,it=document.createElement("option");it.textContent=st,it.value=rt,A.insertBefore(it,A.children[X]),t.setValue(n,{value:w(L,!0),items:N(L)})},items(L){const{items:X}=L.detail;for(;A.length!==0;)A.remove(0);for(const st of X){const{displayValue:rt,exportValue:it}=st,tt=document.createElement("option");tt.textContent=rt,tt.value=it,A.appendChild(tt)}A.options.length>0&&(A.options[0].selected=!0),t.setValue(n,{value:w(L,!0),items:N(L)})},indices(L){const X=new Set(L.detail.indices);for(const st of L.target.options)st.selected=X.has(st.index);t.setValue(n,{value:w(L,!0)})},editable(L){L.target.disabled=!L.detail.editable}};this._dispatchEventFromSandbox(W,O)}),A.addEventListener("input",O=>{var X;const W=w(O,!0),L=w(O,!1);t.setValue(n,{value:W}),(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:L,changeEx:W,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],O=>O.target.checked)):A.addEventListener("input",function(O){t.setValue(n,{value:w(O,!0)})}),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.appendChild(A),this.container}}class e extends M{constructor(t){var i,d,h;const n=!!(((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n})}render(){const t=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",t.includes(this.data.parentType))return this.container;const n=`[data-annotation-id="${this.data.parentId}"]`,i=this.layer.querySelectorAll(n);if(i.length===0)return this.container;const d=new o({container:this.container,trigger:Array.from(i),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),h=this.page,A=c.Util.normalizeRect([this.data.parentRect[0],h.view[3]-this.data.parentRect[1]+h.view[1],this.data.parentRect[2],h.view[3]-this.data.parentRect[3]+h.view[1]]),w=A[0]+this.data.parentRect[2]-this.data.parentRect[0],N=A[1];return this.container.style.transformOrigin=`${-w}px ${-N}px`,this.container.style.left=`${w}px`,this.container.style.top=`${N}px`,this.container.appendChild(d.render()),this.container}}class o{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){var w,N;const n=document.createElement("div");n.className="popupWrapper",this.hideElement=this.hideWrapper?n:this.container,this.hideElement.hidden=!0;const i=document.createElement("div");i.className="popup";const d=this.color;if(d){const O=.7*(255-d[0])+d[0],W=.7*(255-d[1])+d[1],L=.7*(255-d[2])+d[2];i.style.backgroundColor=c.Util.makeHexColor(O|0,W|0,L|0)}const h=document.createElement("h1");h.dir=this.titleObj.dir,h.textContent=this.titleObj.str,i.appendChild(h);const A=Q.PDFDateString.toDateObject(this.modificationDate);if(A){const O=document.createElement("span");O.className="popupDate",O.textContent="{{date}}, {{time}}",O.dataset.l10nId="annotation_date_string",O.dataset.l10nArgs=JSON.stringify({date:A.toLocaleDateString(),time:A.toLocaleTimeString()}),i.appendChild(O)}if(((w=this.richText)==null?void 0:w.str)&&(!((N=this.contentsObj)!=null&&N.str)||this.contentsObj.str===this.richText.str))U.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:i}),i.lastChild.className="richText popupContent";else{const O=this._formatContents(this.contentsObj);i.appendChild(O)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const O of this.trigger)O.addEventListener("click",this._toggle.bind(this)),O.addEventListener("mouseover",this._show.bind(this,!1)),O.addEventListener("mouseout",this._hide.bind(this,!1));return i.addEventListener("click",this._hide.bind(this,!0)),n.appendChild(i),n}_formatContents({str:t,dir:n}){const i=document.createElement("p");i.className="popupContent",i.dir=n;const d=t.split(/(?:\r\n?|\n)/);for(let h=0,A=d.length;h<A;++h){const w=d[h];i.appendChild(document.createTextNode(w)),h<A-1&&i.appendChild(document.createElement("br"))}return i}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class m extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class P extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:n,height:i}=T(t.rect),d=this.svgFactory.create(n,i),h=this.svgFactory.createElement("svg:line");return h.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),h.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),h.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),h.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),h.setAttribute("stroke-width",t.borderStyle.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),d.appendChild(h),this.container.append(d),this._createPopup(h,t),this.container}}class x extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:n,height:i}=T(t.rect),d=this.svgFactory.create(n,i),h=t.borderStyle.width,A=this.svgFactory.createElement("svg:rect");return A.setAttribute("x",h/2),A.setAttribute("y",h/2),A.setAttribute("width",n-h),A.setAttribute("height",i-h),A.setAttribute("stroke-width",h||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),d.appendChild(A),this.container.append(d),this._createPopup(A,t),this.container}}class k extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:n,height:i}=T(t.rect),d=this.svgFactory.create(n,i),h=t.borderStyle.width,A=this.svgFactory.createElement("svg:ellipse");return A.setAttribute("cx",n/2),A.setAttribute("cy",i/2),A.setAttribute("rx",n/2-h/2),A.setAttribute("ry",i/2-h/2),A.setAttribute("stroke-width",h||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),d.appendChild(A),this.container.append(d),this._createPopup(A,t),this.container}}class E extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:n,height:i}=T(t.rect),d=this.svgFactory.create(n,i);let h=[];for(const w of t.vertices){const N=w.x-t.rect[0],O=t.rect[3]-w.y;h.push(N+","+O)}h=h.join(" ");const A=this.svgFactory.createElement(this.svgElementName);return A.setAttribute("points",h),A.setAttribute("stroke-width",t.borderStyle.width||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),d.appendChild(A),this.container.append(d),this._createPopup(A,t),this.container}}class D extends E{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class B extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:n,height:i}=T(t.rect),d=this.svgFactory.create(n,i);for(const h of t.inkLists){let A=[];for(const N of h){const O=N.x-t.rect[0],W=t.rect[3]-N.y;A.push(`${O},${W}`)}A=A.join(" ");const w=this.svgFactory.createElement(this.svgElementName);w.setAttribute("points",A),w.setAttribute("stroke-width",t.borderStyle.width||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),this._createPopup(w,t),d.appendChild(w)}return this.container.append(d),this.container}}class z extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class K extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Z extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class Y extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class et extends M{constructor(t){var i,d,h;const n=!!(t.data.hasPopup||((i=t.data.titleObj)==null?void 0:i.str)||((d=t.data.contentsObj)==null?void 0:d.str)||((h=t.data.richText)==null?void 0:h.str));super(t,{isRenderable:n,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ot extends M{constructor(t){var d;super(t,{isRenderable:!0});const{filename:n,content:i}=this.data.file;this.filename=(0,Q.getFilenameFromUrl)(n),this.content=i,(d=this.linkService.eventBus)==null||d.dispatch("fileattachmentannotation",{source:this,filename:n,content:i})}render(){var n,i;this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((n=this.data.titleObj)==null?void 0:n.str)||((i=this.data.contentsObj)==null?void 0:i.str)||this.data.richText)&&this._createPopup(t,this.data),this.container.appendChild(t),this.container}_download(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.container,this.content,this.filename)}}class S{static render(t){const n=[],i=[];for(const h of t.annotations){if(!h)continue;const{width:A,height:w}=T(h.rect);if(!(A<=0||w<=0)){if(h.annotationType===c.AnnotationType.POPUP){i.push(h);continue}n.push(h)}}i.length&&n.push(...i);const d=t.div;for(const h of n){const A=F.create({data:h,layer:d,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Q.DOMSVGFactory,annotationStorage:t.annotationStorage||new q.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(A.isRenderable){const w=A.render();if(h.hidden&&(w.style.visibility="hidden"),Array.isArray(w))for(const N of w)d.appendChild(N);else A instanceof e?d.prepend(w):d.appendChild(w)}}Lt(this,a,Vt).call(this,d,t.annotationCanvasMap)}static update(t){const{page:n,viewport:i,annotations:d,annotationCanvasMap:h,div:A}=t,w=i.transform,N=`matrix(${w.join(",")})`;let O,W;for(const L of d){const X=A.querySelectorAll(`[data-annotation-id="${L.id}"]`);if(X)for(const st of X)if(L.hasOwnCanvas){const rt=c.Util.normalizeRect([L.rect[0],n.view[3]-L.rect[1]+n.view[1],L.rect[2],n.view[3]-L.rect[3]+n.view[1]]);if(!W){O=Math.abs(w[0]||w[1]);const lt=w.slice();for(let ct=0;ct<4;ct++)lt[ct]=Math.sign(lt[ct]);W=`matrix(${lt.join(",")})`}const it=rt[0]*O,tt=rt[1]*O;st.style.left=`${it}px`,st.style.top=`${tt}px`,st.style.transformOrigin=`${-it}px ${-tt}px`,st.style.transform=W}else st.style.transform=N}Lt(this,a,Vt).call(this,A,h),A.hidden=!1}}a=new WeakSet,Vt=function(t,n){if(!!n){for(const[i,d]of n){const h=t.querySelector(`[data-annotation-id="${i}"]`);if(!h)continue;const{firstChild:A}=h;A.nodeName==="CANVAS"?h.replaceChild(d,A):h.insertBefore(d,A)}n.clear()}},xt(S,a),g.AnnotationLayer=S},(J,g)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.ColorConverters=void 0;function H(Q){return Math.floor(Math.max(0,Math.min(1,Q))*255).toString(16).padStart(2,"0")}class c{static CMYK_G([q,G,U,R]){return["G",1-Math.min(1,.3*q+.59*U+.11*G+R)]}static G_CMYK([q]){return["CMYK",0,0,0,1-q]}static G_RGB([q]){return["RGB",q,q,q]}static G_HTML([q]){const G=H(q);return`#${G}${G}${G}`}static RGB_G([q,G,U]){return["G",.3*q+.59*G+.11*U]}static RGB_HTML([q,G,U]){const R=H(q),_=H(G),T=H(U);return`#${R}${_}${T}`}static T_HTML(){return"#00000000"}static CMYK_RGB([q,G,U,R]){return["RGB",1-Math.min(1,q+R),1-Math.min(1,U+R),1-Math.min(1,G+R)]}static CMYK_HTML(q){return this.RGB_HTML(this.CMYK_RGB(q))}static RGB_CMYK([q,G,U]){const R=1-q,_=1-G,T=1-U,F=Math.min(R,_,T);return["CMYK",R,_,T,F]}}g.ColorConverters=c},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.XfaLayer=void 0;var c=H(18);class Q{static setupStorage(G,U,R,_,T){const F=_.getValue(U,{value:null});switch(R.name){case"textarea":if(F.value!==null&&(G.textContent=F.value),T==="print")break;G.addEventListener("input",M=>{_.setValue(U,{value:M.target.value})});break;case"input":if(R.attributes.type==="radio"||R.attributes.type==="checkbox"){if(F.value===R.attributes.xfaOn?G.setAttribute("checked",!0):F.value===R.attributes.xfaOff&&G.removeAttribute("checked"),T==="print")break;G.addEventListener("change",M=>{_.setValue(U,{value:M.target.checked?M.target.getAttribute("xfaOn"):M.target.getAttribute("xfaOff")})})}else{if(F.value!==null&&G.setAttribute("value",F.value),T==="print")break;G.addEventListener("input",M=>{_.setValue(U,{value:M.target.value})})}break;case"select":if(F.value!==null)for(const M of R.children)M.attributes.value===F.value&&(M.attributes.selected=!0);G.addEventListener("input",M=>{const b=M.target.options,l=b.selectedIndex===-1?"":b[b.selectedIndex].value;_.setValue(U,{value:l})});break}}static setAttributes({html:G,element:U,storage:R=null,intent:_,linkService:T}){const{attributes:F}=U,M=G instanceof HTMLAnchorElement;F.type==="radio"&&(F.name=`${F.name}-${_}`);for(const[b,l]of Object.entries(F))if(!(l==null||b==="dataId"))if(b!=="style")if(b==="textContent")G.textContent=l;else if(b==="class")l.length&&G.setAttribute(b,l.join(" "));else{if(M&&(b==="href"||b==="newWindow"))continue;G.setAttribute(b,l)}else Object.assign(G.style,l);M&&T.addLinkAttributes(G,F.href,F.newWindow),R&&F.dataId&&this.setupStorage(G,F.dataId,U,R)}static render(G){var u;const U=G.annotationStorage,R=G.linkService,_=G.xfaHtml,T=G.intent||"display",F=document.createElement(_.name);_.attributes&&this.setAttributes({html:F,element:_,intent:T,linkService:R});const M=[[_,-1,F]],b=G.div;if(b.appendChild(F),G.viewport){const r=`matrix(${G.viewport.transform.join(",")})`;b.style.transform=r}T!=="richText"&&b.setAttribute("class","xfaLayer xfaFont");const l=[];for(;M.length>0;){const[r,p,C]=M[M.length-1];if(p+1===r.children.length){M.pop();continue}const y=r.children[++M[M.length-1][1]];if(y===null)continue;const{name:v}=y;if(v==="#text"){const o=document.createTextNode(y.value);l.push(o),C.appendChild(o);continue}let e;if((u=y==null?void 0:y.attributes)!=null&&u.xmlns?e=document.createElementNS(y.attributes.xmlns,v):e=document.createElement(v),C.appendChild(e),y.attributes&&this.setAttributes({html:e,element:y,storage:U,intent:T,linkService:R}),y.children&&y.children.length>0)M.push([y,-1,e]);else if(y.value){const o=document.createTextNode(y.value);c.XfaText.shouldBuildText(v)&&l.push(o),e.appendChild(o)}}for(const r of b.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))r.setAttribute("readOnly",!0);return{textDivs:l}}static update(G){const U=`matrix(${G.viewport.transform.join(",")})`;G.div.style.transform=U,G.div.hidden=!1}}g.XfaLayer=Q},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.renderTextLayer=p;var c=H(1);const Q=1e5,q=30,G=.8,U=new Map,R=/^\s+$/g;function _(C,y){const v=U.get(C);if(v)return v;y.save(),y.font=`${q}px ${C}`;const e=y.measureText("");let o=e.fontBoundingBoxAscent,m=Math.abs(e.fontBoundingBoxDescent);if(o){y.restore();const x=o/(o+m);return U.set(C,x),x}y.strokeStyle="red",y.clearRect(0,0,q,q),y.strokeText("g",0,0);let P=y.getImageData(0,0,q,q).data;m=0;for(let x=P.length-1-3;x>=0;x-=4)if(P[x]>0){m=Math.ceil(x/4/q);break}y.clearRect(0,0,q,q),y.strokeText("A",0,q),P=y.getImageData(0,0,q,q).data,o=0;for(let x=0,k=P.length;x<k;x+=4)if(P[x]>0){o=q-Math.floor(x/4/q);break}if(y.restore(),o){const x=o/(o+m);return U.set(C,x),x}return U.set(C,G),G}function T(C,y,v,e){const o=document.createElement("span"),m=C._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL};C._textDivs.push(o);const P=c.Util.transform(C._viewport.transform,y.transform);let x=Math.atan2(P[1],P[0]);const k=v[y.fontName];k.vertical&&(x+=Math.PI/2);const E=Math.hypot(P[2],P[3]),D=E*_(k.fontFamily,e);let $,B;x===0?($=P[4],B=P[5]-D):($=P[4]+D*Math.sin(x),B=P[5]-D*Math.cos(x)),o.style.left=`${$}px`,o.style.top=`${B}px`,o.style.fontSize=`${E}px`,o.style.fontFamily=k.fontFamily,o.setAttribute("role","presentation"),o.textContent=y.str,o.dir=y.dir,C._fontInspectorEnabled&&(o.dataset.fontName=y.fontName),x!==0&&(m.angle=x*(180/Math.PI));let z=!1;if(y.str.length>1||C._enhanceTextSelection&&R.test(y.str))z=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const K=Math.abs(y.transform[0]),Z=Math.abs(y.transform[3]);K!==Z&&Math.max(K,Z)/Math.min(K,Z)>1.5&&(z=!0)}if(z&&(k.vertical?m.canvasWidth=y.height*C._viewport.scale:m.canvasWidth=y.width*C._viewport.scale),C._textDivProperties.set(o,m),C._textContentStream&&C._layoutText(o),C._enhanceTextSelection&&m.hasText){let K=1,Z=0;x!==0&&(K=Math.cos(x),Z=Math.sin(x));const Y=(k.vertical?y.height:y.width)*C._viewport.scale,et=E;let ot,S;x!==0?(ot=[K,Z,-Z,K,$,B],S=c.Util.getAxialAlignedBoundingBox([0,0,Y,et],ot)):S=[$,B,$+Y,B+et],C._bounds.push({left:S[0],top:S[1],right:S[2],bottom:S[3],div:o,size:[Y,et],m:ot})}}function F(C){if(C._canceled)return;const y=C._textDivs,v=C._capability,e=y.length;if(e>Q){C._renderingDone=!0,v.resolve();return}if(!C._textContentStream)for(let o=0;o<e;o++)C._layoutText(y[o]);C._renderingDone=!0,v.resolve()}function M(C,y,v){let e=0;for(let o=0;o<v;o++){const m=C[y++];m>0&&(e=e?Math.min(m,e):m)}return e}function b(C){const y=C._bounds,v=C._viewport,e=l(v.width,v.height,y);for(let o=0;o<e.length;o++){const m=y[o].div,P=C._textDivProperties.get(m);if(P.angle===0){P.paddingLeft=y[o].left-e[o].left,P.paddingTop=y[o].top-e[o].top,P.paddingRight=e[o].right-y[o].right,P.paddingBottom=e[o].bottom-y[o].bottom,C._textDivProperties.set(m,P);continue}const x=e[o],k=y[o],E=k.m,D=E[0],$=E[1],B=[[0,0],[0,k.size[1]],[k.size[0],0],k.size],z=new Float64Array(64);for(let Z=0,Y=B.length;Z<Y;Z++){const et=c.Util.applyTransform(B[Z],E);z[Z+0]=D&&(x.left-et[0])/D,z[Z+4]=$&&(x.top-et[1])/$,z[Z+8]=D&&(x.right-et[0])/D,z[Z+12]=$&&(x.bottom-et[1])/$,z[Z+16]=$&&(x.left-et[0])/-$,z[Z+20]=D&&(x.top-et[1])/D,z[Z+24]=$&&(x.right-et[0])/-$,z[Z+28]=D&&(x.bottom-et[1])/D,z[Z+32]=D&&(x.left-et[0])/-D,z[Z+36]=$&&(x.top-et[1])/-$,z[Z+40]=D&&(x.right-et[0])/-D,z[Z+44]=$&&(x.bottom-et[1])/-$,z[Z+48]=$&&(x.left-et[0])/$,z[Z+52]=D&&(x.top-et[1])/-D,z[Z+56]=$&&(x.right-et[0])/$,z[Z+60]=D&&(x.bottom-et[1])/-D}const K=1+Math.min(Math.abs(D),Math.abs($));P.paddingLeft=M(z,32,16)/K,P.paddingTop=M(z,48,16)/K,P.paddingRight=M(z,0,16)/K,P.paddingBottom=M(z,16,16)/K,C._textDivProperties.set(m,P)}}function l(C,y,v){const e=v.map(function(m,P){return{x1:m.left,y1:m.top,x2:m.right,y2:m.bottom,index:P,x1New:void 0,x2New:void 0}});u(C,e);const o=new Array(v.length);for(const m of e){const P=m.index;o[P]={left:m.x1New,top:0,right:m.x2New,bottom:0}}v.map(function(m,P){const x=o[P],k=e[P];k.x1=m.top,k.y1=C-x.right,k.x2=m.bottom,k.y2=C-x.left,k.index=P,k.x1New=void 0,k.x2New=void 0}),u(y,e);for(const m of e){const P=m.index;o[P].top=m.x1New,o[P].bottom=m.x2New}return o}function u(C,y){y.sort(function(o,m){return o.x1-m.x1||o.index-m.index});const e=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const o of y){let m=0;for(;m<e.length&&e[m].end<=o.y1;)m++;let P=e.length-1;for(;P>=0&&e[P].start>=o.y2;)P--;let x,k,E,D,$=-1/0;for(E=m;E<=P;E++){x=e[E],k=x.boundary;let K;k.x2>o.x1?K=k.index>o.index?k.x1New:o.x1:k.x2New===void 0?K=(k.x2+o.x1)/2:K=k.x2New,K>$&&($=K)}for(o.x1New=$,E=m;E<=P;E++)x=e[E],k=x.boundary,k.x2New===void 0?k.x2>o.x1?k.index>o.index&&(k.x2New=k.x2):k.x2New=$:k.x2New>$&&(k.x2New=Math.max($,k.x2));const B=[];let z=null;for(E=m;E<=P;E++){x=e[E],k=x.boundary;const K=k.x2>o.x2?k:o;z===K?B[B.length-1].end=x.end:(B.push({start:x.start,end:x.end,boundary:K}),z=K)}for(e[m].start<o.y1&&(B[0].start=o.y1,B.unshift({start:e[m].start,end:o.y1,boundary:e[m].boundary})),o.y2<e[P].end&&(B[B.length-1].end=o.y2,B.push({start:o.y2,end:e[P].end,boundary:e[P].boundary})),E=m;E<=P;E++){if(x=e[E],k=x.boundary,k.x2New!==void 0)continue;let K=!1;for(D=m-1;!K&&D>=0&&e[D].start>=k.y1;D--)K=e[D].boundary===k;for(D=P+1;!K&&D<e.length&&e[D].end<=k.y2;D++)K=e[D].boundary===k;for(D=0;!K&&D<B.length;D++)K=B[D].boundary===k;K||(k.x2New=$)}Array.prototype.splice.apply(e,[m,P-m+1].concat(B))}for(const o of e){const m=o.boundary;m.x2New===void 0&&(m.x2New=Math.max(C,m.x2))}}class r{constructor({textContent:y,textContentStream:v,container:e,viewport:o,textDivs:m,textContentItemsStr:P,enhanceTextSelection:x}){var k;this._textContent=y,this._textContentStream=v,this._container=e,this._document=e.ownerDocument,this._viewport=o,this._textDivs=m||[],this._textContentItemsStr=P||[],this._enhanceTextSelection=!!x,this._fontInspectorEnabled=!!((k=globalThis.FontInspector)!=null&&k.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,c.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(y,v){for(let e=0,o=y.length;e<o;e++){if(y[e].str===void 0){if(y[e].type==="beginMarkedContentProps"||y[e].type==="beginMarkedContent"){const m=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),y[e].id!==null&&this._container.setAttribute("id",`${y[e].id}`),m.appendChild(this._container)}else y[e].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(y[e].str),T(this,y[e],v,this._layoutTextCtx)}}_layoutText(y){const v=this._textDivProperties.get(y);let e="";if(v.canvasWidth!==0&&v.hasText){const{fontSize:o,fontFamily:m}=y.style;(o!==this._layoutTextLastFontSize||m!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${o} ${m}`,this._layoutTextLastFontSize=o,this._layoutTextLastFontFamily=m);const{width:P}=this._layoutTextCtx.measureText(y.textContent);if(P>0){const x=v.canvasWidth/P;this._enhanceTextSelection&&(v.scale=x),e=`scaleX(${x})`}}if(v.angle!==0&&(e=`rotate(${v.angle}deg) ${e}`),e.length>0&&(this._enhanceTextSelection&&(v.originalTransform=e),y.style.transform=e),v.hasText&&this._container.appendChild(y),v.hasEOL){const o=document.createElement("br");o.setAttribute("role","presentation"),this._container.appendChild(o)}}_render(y=0){const v=(0,c.createPromiseCapability)();let e=Object.create(null);const o=this._document.createElement("canvas");if(o.height=o.width=q,this._layoutTextCtx=o.getContext("2d",{alpha:!1}),this._textContent){const m=this._textContent.items,P=this._textContent.styles;this._processItems(m,P),v.resolve()}else if(this._textContentStream){const m=()=>{this._reader.read().then(({value:P,done:x})=>{if(x){v.resolve();return}Object.assign(e,P.styles),this._processItems(P.items,e),m()},v.reject)};this._reader=this._textContentStream.getReader(),m()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');v.promise.then(()=>{e=null,y?this._renderTimer=setTimeout(()=>{F(this),this._renderTimer=null},y):F(this)},this._capability.reject)}expandTextDivs(y=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(b(this),this._bounds=null);const v=[],e=[];for(let o=0,m=this._textDivs.length;o<m;o++){const P=this._textDivs[o],x=this._textDivProperties.get(P);!x.hasText||(y?(v.length=0,e.length=0,x.originalTransform&&v.push(x.originalTransform),x.paddingTop>0?(e.push(`${x.paddingTop}px`),v.push(`translateY(${-x.paddingTop}px)`)):e.push(0),x.paddingRight>0?e.push(`${x.paddingRight/x.scale}px`):e.push(0),x.paddingBottom>0?e.push(`${x.paddingBottom}px`):e.push(0),x.paddingLeft>0?(e.push(`${x.paddingLeft/x.scale}px`),v.push(`translateX(${-x.paddingLeft/x.scale}px)`)):e.push(0),P.style.padding=e.join(" "),v.length&&(P.style.transform=v.join(" "))):(P.style.padding=null,P.style.transform=x.originalTransform))}}}function p(C){const y=new r({textContent:C.textContent,textContentStream:C.textContentStream,container:C.container,viewport:C.viewport,textDivs:C.textDivs,textContentItemsStr:C.textContentItemsStr,enhanceTextSelection:C.enhanceTextSelection});return y._render(C.timeout),y}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.SVGGraphics=void 0;var c=H(1),Q=H(5),q=H(3);let G=class{constructor(){(0,c.unreachable)("Not implemented: SVGGraphics")}};g.SVGGraphics=G;{let u=function(e){let o=[];const m=[];for(const P of e){if(P.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),m.push(o),o=o[o.length-1].items;continue}P.fn==="restore"?o=m.pop():o.push(P)}return o},r=function(e){if(Number.isInteger(e))return e.toString();const o=e.toFixed(10);let m=o.length-1;if(o[m]!=="0")return o;do m--;while(o[m]==="0");return o.substring(0,o[m]==="."?m:m+1)},p=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${r(e[0])} ${r(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const o=Math.acos(e[0])*180/Math.PI;return`rotate(${r(o)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${r(e[4])} ${r(e[5])})`;return`matrix(${r(e[0])} ${r(e[1])} ${r(e[2])} ${r(e[3])} ${r(e[4])} ${r(e[5])})`};const U={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},R="http://www.w3.org/XML/1998/namespace",_="http://www.w3.org/1999/xlink",T=["butt","round","square"],F=["miter","round","bevel"],M=function(e,o="",m=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!m)return URL.createObjectURL(new Blob([e],{type:o}));const P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let x=`data:${o};base64,`;for(let k=0,E=e.length;k<E;k+=3){const D=e[k]&255,$=e[k+1]&255,B=e[k+2]&255,z=D>>2,K=(D&3)<<4|$>>4,Z=k+1<E?($&15)<<2|B>>6:64,Y=k+2<E?B&63:64;x+=P[z]+P[K]+P[Z]+P[Y]}return x},b=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,m=new Int32Array(256);for(let B=0;B<256;B++){let z=B;for(let K=0;K<8;K++)z&1?z=3988292384^z>>1&2147483647:z=z>>1&2147483647;m[B]=z}function P(B,z,K){let Z=-1;for(let Y=z;Y<K;Y++){const et=(Z^B[Y])&255,ot=m[et];Z=Z>>>8^ot}return Z^-1}function x(B,z,K,Z){let Y=Z;const et=z.length;K[Y]=et>>24&255,K[Y+1]=et>>16&255,K[Y+2]=et>>8&255,K[Y+3]=et&255,Y+=4,K[Y]=B.charCodeAt(0)&255,K[Y+1]=B.charCodeAt(1)&255,K[Y+2]=B.charCodeAt(2)&255,K[Y+3]=B.charCodeAt(3)&255,Y+=4,K.set(z,Y),Y+=z.length;const ot=P(K,Z+4,Y);K[Y]=ot>>24&255,K[Y+1]=ot>>16&255,K[Y+2]=ot>>8&255,K[Y+3]=ot&255}function k(B,z,K){let Z=1,Y=0;for(let et=z;et<K;++et)Z=(Z+(B[et]&255))%65521,Y=(Y+Z)%65521;return Y<<16|Z}function E(B){if(!q.isNodeJS)return D(B);try{let z;parseInt(process.versions.node)>=8?z=B:z=Buffer.from(B);const K=require$$5.deflateSync(z,{level:9});return K instanceof Uint8Array?K:new Uint8Array(K)}catch(z){(0,c.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+z)}return D(B)}function D(B){let z=B.length;const K=65535,Z=Math.ceil(z/K),Y=new Uint8Array(2+z+Z*5+4);let et=0;Y[et++]=120,Y[et++]=156;let ot=0;for(;z>K;)Y[et++]=0,Y[et++]=255,Y[et++]=255,Y[et++]=0,Y[et++]=0,Y.set(B.subarray(ot,ot+K),et),et+=K,ot+=K,z-=K;Y[et++]=1,Y[et++]=z&255,Y[et++]=z>>8&255,Y[et++]=~z&65535&255,Y[et++]=(~z&65535)>>8&255,Y.set(B.subarray(ot),et),et+=B.length-ot;const S=k(B,0,B.length);return Y[et++]=S>>24&255,Y[et++]=S>>16&255,Y[et++]=S>>8&255,Y[et++]=S&255,Y}function $(B,z,K,Z){const Y=B.width,et=B.height;let ot,S,a;const s=B.data;switch(z){case c.ImageKind.GRAYSCALE_1BPP:S=0,ot=1,a=Y+7>>3;break;case c.ImageKind.RGB_24BPP:S=2,ot=8,a=Y*3;break;case c.ImageKind.RGBA_32BPP:S=6,ot=8,a=Y*4;break;default:throw new Error("invalid format")}const f=new Uint8Array((1+a)*et);let t=0,n=0;for(let N=0;N<et;++N)f[t++]=0,f.set(s.subarray(n,n+a),t),n+=a,t+=a;if(z===c.ImageKind.GRAYSCALE_1BPP&&Z){t=0;for(let N=0;N<et;N++){t++;for(let O=0;O<a;O++)f[t++]^=255}}const i=new Uint8Array([Y>>24&255,Y>>16&255,Y>>8&255,Y&255,et>>24&255,et>>16&255,et>>8&255,et&255,ot,S,0,0,0]),d=E(f),h=e.length+o*3+i.length+d.length,A=new Uint8Array(h);let w=0;return A.set(e,w),w+=e.length,x("IHDR",i,A,w),w+=o+i.length,x("IDATA",d,A,w),w+=o+d.length,x("IEND",new Uint8Array(0),A,w),M(A,"image/png",K)}return function(z,K,Z){const Y=z.kind===void 0?c.ImageKind.GRAYSCALE_1BPP:z.kind;return $(z,Y,K,Z)}}();class l{constructor(){this.fontSizeScale=1,this.fontWeight=U.fontWeight,this.fontSize=0,this.textMatrix=c.IDENTITY_MATRIX,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=c.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=U.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,m){this.x=o,this.y=m}}let C=0,y=0,v=0;g.SVGGraphics=G=class{constructor(e,o,m=!1){this.svgFactory=new Q.DOMSVGFactory,this.current=new l,this.transformMatrix=c.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!m,this._operatorIdMapping=[];for(const P in c.OPS)this._operatorIdMapping[c.OPS[P]]=P}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const o=e.fnArray,m=e.argsArray;for(let P=0,x=o.length;P<x;P++)if(o[P]===c.OPS.dependency)for(const k of m[P]){const E=k.startsWith("g_")?this.commonObjs:this.objs,D=new Promise($=>{E.get(k,$)});this.current.dependencies.push(D)}return Promise.all(this.current.dependencies)}transform(e,o,m,P,x,k){const E=[e,o,m,P,x,k];this.transformMatrix=c.Util.transform(this.transformMatrix,E),this.tgrp=null}getSVG(e,o){this.viewport=o;const m=this._initialize(o);return this.loadDependencies(e).then(()=>(this.transformMatrix=c.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),m))}convertOpList(e){const o=this._operatorIdMapping,m=e.argsArray,P=e.fnArray,x=[];for(let k=0,E=P.length;k<E;k++){const D=P[k];x.push({fnId:D,fn:o[D],args:m[k]})}return u(x)}executeOpTree(e){for(const o of e){const m=o.fn,P=o.fnId,x=o.args;switch(P|0){case c.OPS.beginText:this.beginText();break;case c.OPS.dependency:break;case c.OPS.setLeading:this.setLeading(x);break;case c.OPS.setLeadingMoveText:this.setLeadingMoveText(x[0],x[1]);break;case c.OPS.setFont:this.setFont(x);break;case c.OPS.showText:this.showText(x[0]);break;case c.OPS.showSpacedText:this.showText(x[0]);break;case c.OPS.endText:this.endText();break;case c.OPS.moveText:this.moveText(x[0],x[1]);break;case c.OPS.setCharSpacing:this.setCharSpacing(x[0]);break;case c.OPS.setWordSpacing:this.setWordSpacing(x[0]);break;case c.OPS.setHScale:this.setHScale(x[0]);break;case c.OPS.setTextMatrix:this.setTextMatrix(x[0],x[1],x[2],x[3],x[4],x[5]);break;case c.OPS.setTextRise:this.setTextRise(x[0]);break;case c.OPS.setTextRenderingMode:this.setTextRenderingMode(x[0]);break;case c.OPS.setLineWidth:this.setLineWidth(x[0]);break;case c.OPS.setLineJoin:this.setLineJoin(x[0]);break;case c.OPS.setLineCap:this.setLineCap(x[0]);break;case c.OPS.setMiterLimit:this.setMiterLimit(x[0]);break;case c.OPS.setFillRGBColor:this.setFillRGBColor(x[0],x[1],x[2]);break;case c.OPS.setStrokeRGBColor:this.setStrokeRGBColor(x[0],x[1],x[2]);break;case c.OPS.setStrokeColorN:this.setStrokeColorN(x);break;case c.OPS.setFillColorN:this.setFillColorN(x);break;case c.OPS.shadingFill:this.shadingFill(x[0]);break;case c.OPS.setDash:this.setDash(x[0],x[1]);break;case c.OPS.setRenderingIntent:this.setRenderingIntent(x[0]);break;case c.OPS.setFlatness:this.setFlatness(x[0]);break;case c.OPS.setGState:this.setGState(x[0]);break;case c.OPS.fill:this.fill();break;case c.OPS.eoFill:this.eoFill();break;case c.OPS.stroke:this.stroke();break;case c.OPS.fillStroke:this.fillStroke();break;case c.OPS.eoFillStroke:this.eoFillStroke();break;case c.OPS.clip:this.clip("nonzero");break;case c.OPS.eoClip:this.clip("evenodd");break;case c.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case c.OPS.paintImageXObject:this.paintImageXObject(x[0]);break;case c.OPS.paintInlineImageXObject:this.paintInlineImageXObject(x[0]);break;case c.OPS.paintImageMaskXObject:this.paintImageMaskXObject(x[0]);break;case c.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(x[0],x[1]);break;case c.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case c.OPS.closePath:this.closePath();break;case c.OPS.closeStroke:this.closeStroke();break;case c.OPS.closeFillStroke:this.closeFillStroke();break;case c.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case c.OPS.nextLine:this.nextLine();break;case c.OPS.transform:this.transform(x[0],x[1],x[2],x[3],x[4],x[5]);break;case c.OPS.constructPath:this.constructPath(x[0],x[1]);break;case c.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,c.warn)(`Unimplemented operator ${m}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,o,m,P,x,k){const E=this.current;E.textMatrix=E.lineMatrix=[e,o,m,P,x,k],E.textMatrixScale=Math.hypot(e,o),E.x=E.lineX=0,E.y=E.lineY=0,E.xcoords=[],E.ycoords=[],E.tspan=this.svgFactory.createElement("svg:tspan"),E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${r(E.fontSize)}px`),E.tspan.setAttributeNS(null,"y",r(-E.y)),E.txtElement=this.svgFactory.createElement("svg:text"),E.txtElement.appendChild(E.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=c.IDENTITY_MATRIX,e.lineMatrix=c.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,o){const m=this.current;m.x=m.lineX+=e,m.y=m.lineY+=o,m.xcoords=[],m.ycoords=[],m.tspan=this.svgFactory.createElement("svg:tspan"),m.tspan.setAttributeNS(null,"font-family",m.fontFamily),m.tspan.setAttributeNS(null,"font-size",`${r(m.fontSize)}px`),m.tspan.setAttributeNS(null,"y",r(-m.y))}showText(e){const o=this.current,m=o.font,P=o.fontSize;if(P===0)return;const x=o.fontSizeScale,k=o.charSpacing,E=o.wordSpacing,D=o.fontDirection,$=o.textHScale*D,B=m.vertical,z=B?1:-1,K=m.defaultVMetrics,Z=P*o.fontMatrix[0];let Y=0;for(const S of e){if(S===null){Y+=D*E;continue}else if(typeof S=="number"){Y+=z*S*P/1e3;continue}const a=(S.isSpace?E:0)+k,s=S.fontChar;let f,t,n=S.width;if(B){let d;const h=S.vmetric||K;d=S.vmetric?h[1]:n*.5,d=-d*Z;const A=h[2]*Z;n=h?-h[0]:n,f=d/x,t=(Y+A)/x}else f=Y/x,t=0;(S.isInFont||m.missingFile)&&(o.xcoords.push(o.x+f),B&&o.ycoords.push(-o.y+t),o.tspan.textContent+=s);let i;B?i=n*Z-a*D:i=n*Z+a*D,Y+=i}o.tspan.setAttributeNS(null,"x",o.xcoords.map(r).join(" ")),B?o.tspan.setAttributeNS(null,"y",o.ycoords.map(r).join(" ")):o.tspan.setAttributeNS(null,"y",r(-o.y)),B?o.y-=Y:o.x+=Y*$,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${r(o.fontSize)}px`),o.fontStyle!==U.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==U.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const et=o.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;if(et===c.TextRenderingMode.FILL||et===c.TextRenderingMode.FILL_STROKE?(o.fillColor!==U.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===c.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),et===c.TextRenderingMode.STROKE||et===c.TextRenderingMode.FILL_STROKE){const S=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,S)}let ot=o.textMatrix;o.textRise!==0&&(ot=ot.slice(),ot[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${p(ot)} scale(${r($)}, -1)`),o.txtElement.setAttributeNS(R,"xml:space","preserve"),o.txtElement.appendChild(o.tspan),o.txtgrp.appendChild(o.txtElement),this._ensureTransformGroup().appendChild(o.txtElement)}setLeadingMoveText(e,o){this.setLeading(-o),this.moveText(e,o)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const o=M(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${o}); }
`}setFont(e){const o=this.current,m=this.commonObjs.get(e[0]);let P=e[1];o.font=m,this.embedFonts&&!m.missingFile&&!this.embeddedFonts[m.loadedName]&&(this.addFontStyle(m),this.embeddedFonts[m.loadedName]=m),o.fontMatrix=m.fontMatrix||c.FONT_IDENTITY_MATRIX;let x="normal";m.black?x="900":m.bold&&(x="bold");const k=m.italic?"italic":"normal";P<0?(P=-P,o.fontDirection=-1):o.fontDirection=1,o.fontSize=P,o.fontFamily=m.loadedName,o.fontWeight=x,o.fontStyle=k,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",r(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const e=this.current;e.textRenderingMode&c.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=e.txtElement)==null?void 0:o.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=T[e]}setLineJoin(e){this.current.lineJoin=F[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,o,m){this.current.strokeColor=c.Util.makeHexColor(e,o,m)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,o,m){this.current.fillColor=c.Util.makeHexColor(e,o,m),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const o=this.viewport.width,m=this.viewport.height,P=c.Util.inverseTransform(this.transformMatrix),x=c.Util.applyTransform([0,0],P),k=c.Util.applyTransform([0,m],P),E=c.Util.applyTransform([o,0],P),D=c.Util.applyTransform([o,m],P),$=Math.min(x[0],k[0],E[0],D[0]),B=Math.min(x[1],k[1],E[1],D[1]),z=Math.max(x[0],k[0],E[0],D[0]),K=Math.max(x[1],k[1],E[1],D[1]),Z=this.svgFactory.createElement("svg:rect");Z.setAttributeNS(null,"x",$),Z.setAttributeNS(null,"y",B),Z.setAttributeNS(null,"width",z-$),Z.setAttributeNS(null,"height",K-B),Z.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&Z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(Z)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const o=e[1],m=e[2],P=e[3]||c.IDENTITY_MATRIX,[x,k,E,D]=e[4],$=e[5],B=e[6],z=e[7],K=`shading${v++}`,[Z,Y,et,ot]=c.Util.normalizeRect([...c.Util.applyTransform([x,k],P),...c.Util.applyTransform([E,D],P)]),[S,a]=c.Util.singularValueDecompose2dScale(P),s=$*S,f=B*a,t=this.svgFactory.createElement("svg:pattern");t.setAttributeNS(null,"id",K),t.setAttributeNS(null,"patternUnits","userSpaceOnUse"),t.setAttributeNS(null,"width",s),t.setAttributeNS(null,"height",f),t.setAttributeNS(null,"x",`${Z}`),t.setAttributeNS(null,"y",`${Y}`);const n=this.svg,i=this.transformMatrix,d=this.current.fillColor,h=this.current.strokeColor,A=this.svgFactory.create(et-Z,ot-Y);if(this.svg=A,this.transformMatrix=P,z===2){const w=c.Util.makeHexColor(...o);this.current.fillColor=w,this.current.strokeColor=w}return this.executeOpTree(this.convertOpList(m)),this.svg=n,this.transformMatrix=i,this.current.fillColor=d,this.current.strokeColor=h,t.appendChild(A.childNodes[0]),this.defs.appendChild(t),`url(#${K})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const o=`shading${v++}`,m=e[3];let P;switch(e[1]){case"axial":const x=e[4],k=e[5];P=this.svgFactory.createElement("svg:linearGradient"),P.setAttributeNS(null,"id",o),P.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),P.setAttributeNS(null,"x1",x[0]),P.setAttributeNS(null,"y1",x[1]),P.setAttributeNS(null,"x2",k[0]),P.setAttributeNS(null,"y2",k[1]);break;case"radial":const E=e[4],D=e[5],$=e[6],B=e[7];P=this.svgFactory.createElement("svg:radialGradient"),P.setAttributeNS(null,"id",o),P.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),P.setAttributeNS(null,"cx",D[0]),P.setAttributeNS(null,"cy",D[1]),P.setAttributeNS(null,"r",B),P.setAttributeNS(null,"fx",E[0]),P.setAttributeNS(null,"fy",E[1]),P.setAttributeNS(null,"fr",$);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const x of m){const k=this.svgFactory.createElement("svg:stop");k.setAttributeNS(null,"offset",x[0]),k.setAttributeNS(null,"stop-color",x[1]),P.appendChild(k)}return this.defs.appendChild(P),`url(#${o})`;case"Mesh":return(0,c.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,o){this.current.dashArray=e,this.current.dashPhase=o}constructPath(e,o){const m=this.current;let P=m.x,x=m.y,k=[],E=0;for(const D of e)switch(D|0){case c.OPS.rectangle:P=o[E++],x=o[E++];const $=o[E++],B=o[E++],z=P+$,K=x+B;k.push("M",r(P),r(x),"L",r(z),r(x),"L",r(z),r(K),"L",r(P),r(K),"Z");break;case c.OPS.moveTo:P=o[E++],x=o[E++],k.push("M",r(P),r(x));break;case c.OPS.lineTo:P=o[E++],x=o[E++],k.push("L",r(P),r(x));break;case c.OPS.curveTo:P=o[E+4],x=o[E+5],k.push("C",r(o[E]),r(o[E+1]),r(o[E+2]),r(o[E+3]),r(P),r(x)),E+=6;break;case c.OPS.curveTo2:k.push("C",r(P),r(x),r(o[E]),r(o[E+1]),r(o[E+2]),r(o[E+3])),P=o[E+2],x=o[E+3],E+=4;break;case c.OPS.curveTo3:P=o[E+2],x=o[E+3],k.push("C",r(o[E]),r(o[E+1]),r(P),r(x),r(P),r(x)),E+=4;break;case c.OPS.closePath:k.push("Z");break}k=k.join(" "),m.path&&e.length>0&&e[0]!==c.OPS.rectangle&&e[0]!==c.OPS.moveTo?k=m.path.getAttributeNS(null,"d")+k:(m.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(m.path)),m.path.setAttributeNS(null,"d",k),m.path.setAttributeNS(null,"fill","none"),m.element=m.path,m.setCurrentPoint(P,x)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const o=`clippath${C++}`,m=this.svgFactory.createElement("svg:clipPath");m.setAttributeNS(null,"id",o),m.setAttributeNS(null,"transform",p(this.transformMatrix));const P=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?P.setAttributeNS(null,"clip-rule","evenodd"):P.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,m.appendChild(P),this.defs.appendChild(m),e.activeClipUrl){e.clipGroup=null;for(const x of this.extraStack)x.clipGroup=null;m.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const o=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",o)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[o,m]of e)switch(o){case"LW":this.setLineWidth(m);break;case"LC":this.setLineCap(m);break;case"LJ":this.setLineJoin(m);break;case"ML":this.setMiterLimit(m);break;case"D":this.setDash(m[0],m[1]);break;case"RI":this.setRenderingIntent(m);break;case"FL":this.setFlatness(m);break;case"Font":this.setFont(m);break;case"CA":this.setStrokeAlpha(m);break;case"ca":this.setFillAlpha(m);break;default:(0,c.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,o=1){const m=this.current;let P=m.dashArray;o!==1&&P.length>0&&(P=P.map(function(x){return o*x})),e.setAttributeNS(null,"stroke",m.strokeColor),e.setAttributeNS(null,"stroke-opacity",m.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",r(m.miterLimit)),e.setAttributeNS(null,"stroke-linecap",m.lineCap),e.setAttributeNS(null,"stroke-linejoin",m.lineJoin),e.setAttributeNS(null,"stroke-width",r(o*m.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",P.map(r).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",r(o*m.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(e)}paintImageXObject(e){const o=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(!o){(0,c.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(e,o){const m=e.width,P=e.height,x=b(e,this.forceDataSchema,!!o),k=this.svgFactory.createElement("svg:rect");k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y","0"),k.setAttributeNS(null,"width",r(m)),k.setAttributeNS(null,"height",r(P)),this.current.element=k,this.clip("nonzero");const E=this.svgFactory.createElement("svg:image");E.setAttributeNS(_,"xlink:href",x),E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y",r(-P)),E.setAttributeNS(null,"width",r(m)+"px"),E.setAttributeNS(null,"height",r(P)+"px"),E.setAttributeNS(null,"transform",`scale(${r(1/m)} ${r(-1/P)})`),o?o.appendChild(E):this._ensureTransformGroup().appendChild(E)}paintImageMaskXObject(e){const o=this.current,m=e.width,P=e.height,x=o.fillColor;o.maskId=`mask${y++}`;const k=this.svgFactory.createElement("svg:mask");k.setAttributeNS(null,"id",o.maskId);const E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",r(m)),E.setAttributeNS(null,"height",r(P)),E.setAttributeNS(null,"fill",x),E.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.appendChild(k),this._ensureTransformGroup().appendChild(E),this.paintInlineImageXObject(e,k)}paintFormXObjectBegin(e,o){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),o){const m=o[2]-o[0],P=o[3]-o[1],x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",o[0]),x.setAttributeNS(null,"y",o[1]),x.setAttributeNS(null,"width",r(m)),x.setAttributeNS(null,"height",r(P)),this.current.element=x,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const o=this.svgFactory.create(e.width,e.height),m=this.svgFactory.createElement("svg:defs");o.appendChild(m),this.defs=m;const P=this.svgFactory.createElement("svg:g");return P.setAttributeNS(null,"transform",p(e.transform)),o.appendChild(P),this.svg=P,o}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",p(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFNodeStream=void 0;var c=H(1),Q=H(26);const q=require$$5,G=require$$5,U=require$$5,R=require$$5,_=/^file:\/\/\/[a-zA-Z]:\//;function T(y){const v=R.parse(y);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(y)?R.parse(`file:///${y}`):(v.host||(v.protocol="file:"),v)}class F{constructor(v){this.source=v,this.url=T(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var v,e;return(e=(v=this._fullRequestReader)==null?void 0:v._loaded)!=null?e:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new u(this),this._fullRequestReader}getRangeReader(v,e){if(e<=this._progressiveDataLength)return null;const o=this.isFsUrl?new C(this,v,e):new r(this,v,e);return this._rangeRequestReaders.push(o),o}cancelAllRequests(v){this._fullRequestReader&&this._fullRequestReader.cancel(v);for(const e of this._rangeRequestReaders.slice(0))e.cancel(v)}}g.PDFNodeStream=F;class M{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=v.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,c.createPromiseCapability)(),this._headersCapability=(0,c.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=(0,c.createPromiseCapability)(),this.read()):(this._loaded+=v.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new c.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class b{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,c.createPromiseCapability)();const e=v.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=(0,c.createPromiseCapability)(),this.read()):(this._loaded+=v.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(y,v){return{protocol:y.protocol,auth:y.auth,host:y.hostname,port:y.port,path:y.path,method:"GET",headers:v}}class u extends M{constructor(v){super(v);const e=o=>{if(o.statusCode===404){const k=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=k,this._headersCapability.reject(k);return}this._headersCapability.resolve(),this._setReadableStream(o);const m=k=>this._readableStream.headers[k.toLowerCase()],{allowRangeRequests:P,suggestedLength:x}=(0,Q.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=x||this._contentLength,this._filename=(0,Q.extractFilenameFromHeader)(m)};this._request=null,this._url.protocol==="http:"?this._request=G.request(l(this._url,v.httpHeaders),e):this._request=U.request(l(this._url,v.httpHeaders),e),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class r extends b{constructor(v,e,o){super(v),this._httpHeaders={};for(const P in v.httpHeaders){const x=v.httpHeaders[P];typeof x>"u"||(this._httpHeaders[P]=x)}this._httpHeaders.Range=`bytes=${e}-${o-1}`;const m=P=>{if(P.statusCode===404){const x=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x;return}this._setReadableStream(P)};this._request=null,this._url.protocol==="http:"?this._request=G.request(l(this._url,this._httpHeaders),m):this._request=U.request(l(this._url,this._httpHeaders),m),this._request.on("error",P=>{this._storedError=P}),this._request.end()}}class p extends M{constructor(v){super(v);let e=decodeURIComponent(this._url.path);_.test(this._url.href)&&(e=e.replace(/^\//,"")),q.lstat(e,(o,m)=>{if(o){o.code==="ENOENT"&&(o=new c.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=m.size,this._setReadableStream(q.createReadStream(e)),this._headersCapability.resolve()})}}class C extends b{constructor(v,e,o){super(v);let m=decodeURIComponent(this._url.path);_.test(this._url.href)&&(m=m.replace(/^\//,"")),this._setReadableStream(q.createReadStream(m,{start:e,end:o-1}))}}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.createResponseStatusError=R,g.extractFilenameFromHeader=U,g.validateRangeRequestCapabilities=G,g.validateResponseStatus=_;var c=H(1),Q=H(27),q=H(5);function G({getResponseHeader:T,isHttp:F,rangeChunkSize:M,disableRange:b}){const l={allowRangeRequests:!1,suggestedLength:void 0},u=parseInt(T("Content-Length"),10);return!Number.isInteger(u)||(l.suggestedLength=u,u<=2*M)||b||!F||T("Accept-Ranges")!=="bytes"||(T("Content-Encoding")||"identity")!=="identity"||(l.allowRangeRequests=!0),l}function U(T){const F=T("Content-Disposition");if(F){let M=(0,Q.getFilenameFromContentDispositionHeader)(F);if(M.includes("%"))try{M=decodeURIComponent(M)}catch{}if((0,q.isPdfFile)(M))return M}return null}function R(T,F){return T===404||T===0&&F.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+F+'".'):new c.UnexpectedResponseException(`Unexpected server response (${T}) while retrieving PDF "${F}".`,T)}function _(T){return T===200||T===206}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.getFilenameFromContentDispositionHeader=Q;var c=H(1);function Q(q){let G=!0,U=R("filename\\*","i").exec(q);if(U){U=U[1];let u=M(U);return u=unescape(u),u=b(u),u=l(u),T(u)}if(U=F(q),U){const u=l(U);return T(u)}if(U=R("filename","i").exec(q),U){U=U[1];let u=M(U);return u=l(u),T(u)}function R(u,r){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',r)}function _(u,r){if(u){if(!/^[\x00-\xFF]+$/.test(r))return r;try{const p=new TextDecoder(u,{fatal:!0}),C=(0,c.stringToBytes)(r);r=p.decode(C),G=!1}catch{}}return r}function T(u){return G&&/[\x80-\xff]/.test(u)&&(u=_("utf-8",u),G&&(u=_("iso-8859-1",u))),u}function F(u){const r=[];let p;const C=R("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=C.exec(u))!==null;){let[,v,e,o]=p;if(v=parseInt(v,10),v in r){if(v===0)break;continue}r[v]=[e,o]}const y=[];for(let v=0;v<r.length&&v in r;++v){let[e,o]=r[v];o=M(o),e&&(o=unescape(o),v===0&&(o=b(o))),y.push(o)}return y.join("")}function M(u){if(u.startsWith('"')){const r=u.slice(1).split('\\"');for(let p=0;p<r.length;++p){const C=r[p].indexOf('"');C!==-1&&(r[p]=r[p].slice(0,C),r.length=p+1),r[p]=r[p].replace(/\\(.)/g,"$1")}u=r.join('"')}return u}function b(u){const r=u.indexOf("'");if(r===-1)return u;const p=u.slice(0,r),y=u.slice(r+1).replace(/^[^']*'/,"");return _(p,y)}function l(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(r,p,C,y){if(C==="q"||C==="Q")return y=y.replace(/_/g," "),y=y.replace(/=([0-9a-fA-F]{2})/g,function(v,e){return String.fromCharCode(parseInt(e,16))}),_(p,y);try{y=atob(y)}catch{}return _(p,y)})}return""}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFNetworkStream=void 0;var c=H(1),Q=H(26);const q=200,G=206;function U(M){const b=M.response;return typeof b!="string"?b:(0,c.stringToBytes)(b).buffer}class R{constructor(b,l={}){this.url=b,this.isHttp=/^https?:/i.test(b),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.getXhr=l.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(b,l,u){const r={begin:b,end:l};for(const p in u)r[p]=u[p];return this.request(r)}requestFull(b){return this.request(b)}request(b){const l=this.getXhr(),u=this.currXhrId++,r=this.pendingRequests[u]={xhr:l};l.open("GET",this.url),l.withCredentials=this.withCredentials;for(const p in this.httpHeaders){const C=this.httpHeaders[p];typeof C>"u"||l.setRequestHeader(p,C)}return this.isHttp&&"begin"in b&&"end"in b?(l.setRequestHeader("Range",`bytes=${b.begin}-${b.end-1}`),r.expectedStatus=G):r.expectedStatus=q,l.responseType="arraybuffer",b.onError&&(l.onerror=function(p){b.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,u),l.onprogress=this.onProgress.bind(this,u),r.onHeadersReceived=b.onHeadersReceived,r.onDone=b.onDone,r.onError=b.onError,r.onProgress=b.onProgress,l.send(null),u}onProgress(b,l){var r;const u=this.pendingRequests[b];!u||(r=u.onProgress)==null||r.call(u,l)}onStateChange(b,l){var v,e,o;const u=this.pendingRequests[b];if(!u)return;const r=u.xhr;if(r.readyState>=2&&u.onHeadersReceived&&(u.onHeadersReceived(),delete u.onHeadersReceived),r.readyState!==4||!(b in this.pendingRequests))return;if(delete this.pendingRequests[b],r.status===0&&this.isHttp){(v=u.onError)==null||v.call(u,r.status);return}const p=r.status||q;if(!(p===q&&u.expectedStatus===G)&&p!==u.expectedStatus){(e=u.onError)==null||e.call(u,r.status);return}const y=U(r);if(p===G){const m=r.getResponseHeader("Content-Range"),P=/bytes (\d+)-(\d+)\/(\d+)/.exec(m);u.onDone({begin:parseInt(P[1],10),chunk:y})}else y?u.onDone({begin:0,chunk:y}):(o=u.onError)==null||o.call(u,r.status)}getRequestXhr(b){return this.pendingRequests[b].xhr}isPendingRequest(b){return b in this.pendingRequests}abortRequest(b){const l=this.pendingRequests[b].xhr;delete this.pendingRequests[b],l.abort()}}class _{constructor(b){this._source=b,this._manager=new R(b.url,{httpHeaders:b.httpHeaders,withCredentials:b.withCredentials}),this._rangeChunkSize=b.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(b){const l=this._rangeRequestReaders.indexOf(b);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new T(this._manager,this._source),this._fullRequestReader}getRangeReader(b,l){const u=new F(this._manager,b,l);return u.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(u),u}cancelAllRequests(b){var l;(l=this._fullRequestReader)==null||l.cancel(b);for(const u of this._rangeRequestReaders.slice(0))u.cancel(b)}}g.PDFNetworkStream=_;class T{constructor(b,l){this._manager=b;const u={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=b.requestFull(u),this._headersReceivedCapability=(0,c.createPromiseCapability)(),this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const b=this._fullRequestId,l=this._manager.getRequestXhr(b),u=C=>l.getResponseHeader(C),{allowRangeRequests:r,suggestedLength:p}=(0,Q.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=p||this._contentLength,this._filename=(0,Q.extractFilenameFromHeader)(u),this._isRangeSupported&&this._manager.abortRequest(b),this._headersReceivedCapability.resolve()}_onDone(b){if(b&&(this._requests.length>0?this._requests.shift().resolve({value:b.chunk,done:!1}):this._cachedChunks.push(b.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(b){this._storedError=(0,Q.createResponseStatusError)(b,this._url),this._headersReceivedCapability.reject(this._storedError);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(b){var l;(l=this.onProgress)==null||l.call(this,{loaded:b.loaded,total:b.lengthComputable?b.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const b=(0,c.createPromiseCapability)();return this._requests.push(b),b.promise}cancel(b){this._done=!0,this._headersReceivedCapability.reject(b);for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class F{constructor(b,l,u){this._manager=b;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._requestId=b.requestRange(l,u,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var b;(b=this.onClosed)==null||b.call(this,this)}_onDone(b){const l=b.chunk;this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunk=l,this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(b){this._storedError=(0,Q.createResponseStatusError)(b,this._url);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(b){var l;this.isStreamingSupported||(l=this.onProgress)==null||l.call(this,{loaded:b.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const b=(0,c.createPromiseCapability)();return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(J,g,H)=>{Object.defineProperty(g,"__esModule",{value:!0}),g.PDFFetchStream=void 0;var c=H(1),Q=H(26);function q(T,F,M){return{method:"GET",headers:T,signal:M==null?void 0:M.signal,mode:"cors",credentials:F?"include":"same-origin",redirect:"follow"}}function G(T){const F=new Headers;for(const M in T){const b=T[M];typeof b>"u"||F.append(M,b)}return F}class U{constructor(F){this.source=F,this.isHttp=/^https?:/i.test(F.url),this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F,M;return(M=(F=this._fullRequestReader)==null?void 0:F._loaded)!=null?M:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new R(this),this._fullRequestReader}getRangeReader(F,M){if(M<=this._progressiveDataLength)return null;const b=new _(this,F,M);return this._rangeRequestReaders.push(b),b}cancelAllRequests(F){this._fullRequestReader&&this._fullRequestReader.cancel(F);for(const M of this._rangeRequestReaders.slice(0))M.cancel(F)}}g.PDFFetchStream=U;class R{constructor(F){this._stream=F,this._reader=null,this._loaded=0,this._filename=null;const M=F.source;this._withCredentials=M.withCredentials||!1,this._contentLength=M.length,this._headersCapability=(0,c.createPromiseCapability)(),this._disableRange=M.disableRange||!1,this._rangeChunkSize=M.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!M.disableStream,this._isRangeSupported=!M.disableRange,this._headers=G(this._stream.httpHeaders);const b=M.url;fetch(b,q(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,Q.validateResponseStatus)(l.status))throw(0,Q.createResponseStatusError)(l.status,b);this._reader=l.body.getReader(),this._headersCapability.resolve();const u=C=>l.headers.get(C),{allowRangeRequests:r,suggestedLength:p}=(0,Q.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=p||this._contentLength,this._filename=(0,Q.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:F,done:M}=await this._reader.read();return M?{value:F,done:M}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController&&this._abortController.abort()}}class _{constructor(F,M,b){this._stream=F,this._reader=null,this._loaded=0;const l=F.source;this._withCredentials=l.withCredentials||!1,this._readCapability=(0,c.createPromiseCapability)(),this._isStreamingSupported=!l.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=G(this._stream.httpHeaders),this._headers.append("Range",`bytes=${M}-${b-1}`);const u=l.url;fetch(u,q(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!(0,Q.validateResponseStatus)(r.status))throw(0,Q.createResponseStatusError)(r.status,u);this._readCapability.resolve(),this._reader=r.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:F,done:M}=await this._reader.read();return M?{value:F,done:M}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(J){var g=__webpack_module_cache__[J];if(g!==void 0)return g.exports;var H=__webpack_module_cache__[J]={exports:{}};return __webpack_modules__[J](H,H.exports,__w_pdfjs_require__),H.exports}var __webpack_exports__={};return(()=>{var J=__webpack_exports__;Object.defineProperty(J,"__esModule",{value:!0}),Object.defineProperty(J,"AnnotationLayer",{enumerable:!0,get:function(){return Q.AnnotationLayer}}),Object.defineProperty(J,"AnnotationMode",{enumerable:!0,get:function(){return g.AnnotationMode}}),Object.defineProperty(J,"CMapCompressionType",{enumerable:!0,get:function(){return g.CMapCompressionType}}),Object.defineProperty(J,"GlobalWorkerOptions",{enumerable:!0,get:function(){return q.GlobalWorkerOptions}}),Object.defineProperty(J,"InvalidPDFException",{enumerable:!0,get:function(){return g.InvalidPDFException}}),Object.defineProperty(J,"LoopbackPort",{enumerable:!0,get:function(){return H.LoopbackPort}}),Object.defineProperty(J,"MissingPDFException",{enumerable:!0,get:function(){return g.MissingPDFException}}),Object.defineProperty(J,"OPS",{enumerable:!0,get:function(){return g.OPS}}),Object.defineProperty(J,"PDFDataRangeTransport",{enumerable:!0,get:function(){return H.PDFDataRangeTransport}}),Object.defineProperty(J,"PDFDateString",{enumerable:!0,get:function(){return c.PDFDateString}}),Object.defineProperty(J,"PDFWorker",{enumerable:!0,get:function(){return H.PDFWorker}}),Object.defineProperty(J,"PasswordResponses",{enumerable:!0,get:function(){return g.PasswordResponses}}),Object.defineProperty(J,"PermissionFlag",{enumerable:!0,get:function(){return g.PermissionFlag}}),Object.defineProperty(J,"PixelsPerInch",{enumerable:!0,get:function(){return c.PixelsPerInch}}),Object.defineProperty(J,"RenderingCancelledException",{enumerable:!0,get:function(){return c.RenderingCancelledException}}),Object.defineProperty(J,"SVGGraphics",{enumerable:!0,get:function(){return R.SVGGraphics}}),Object.defineProperty(J,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return g.UNSUPPORTED_FEATURES}}),Object.defineProperty(J,"UnexpectedResponseException",{enumerable:!0,get:function(){return g.UnexpectedResponseException}}),Object.defineProperty(J,"Util",{enumerable:!0,get:function(){return g.Util}}),Object.defineProperty(J,"VerbosityLevel",{enumerable:!0,get:function(){return g.VerbosityLevel}}),Object.defineProperty(J,"XfaLayer",{enumerable:!0,get:function(){return _.XfaLayer}}),Object.defineProperty(J,"build",{enumerable:!0,get:function(){return H.build}}),Object.defineProperty(J,"createPromiseCapability",{enumerable:!0,get:function(){return g.createPromiseCapability}}),Object.defineProperty(J,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return g.createValidAbsoluteUrl}}),Object.defineProperty(J,"getDocument",{enumerable:!0,get:function(){return H.getDocument}}),Object.defineProperty(J,"getFilenameFromUrl",{enumerable:!0,get:function(){return c.getFilenameFromUrl}}),Object.defineProperty(J,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return c.getPdfFilenameFromUrl}}),Object.defineProperty(J,"getXfaPageViewport",{enumerable:!0,get:function(){return c.getXfaPageViewport}}),Object.defineProperty(J,"isPdfFile",{enumerable:!0,get:function(){return c.isPdfFile}}),Object.defineProperty(J,"loadScript",{enumerable:!0,get:function(){return c.loadScript}}),Object.defineProperty(J,"renderTextLayer",{enumerable:!0,get:function(){return U.renderTextLayer}}),Object.defineProperty(J,"shadow",{enumerable:!0,get:function(){return g.shadow}}),Object.defineProperty(J,"version",{enumerable:!0,get:function(){return H.version}});var g=__w_pdfjs_require__(1),H=__w_pdfjs_require__(4),c=__w_pdfjs_require__(5),Q=__w_pdfjs_require__(20),q=__w_pdfjs_require__(13),G=__w_pdfjs_require__(3),U=__w_pdfjs_require__(23),R=__w_pdfjs_require__(24),_=__w_pdfjs_require__(22);if(G.isNodeJS){const{PDFNodeStream:T}=__w_pdfjs_require__(25);(0,H.setPDFNetworkStreamFactory)(F=>new T(F))}else{const{PDFNetworkStream:T}=__w_pdfjs_require__(28),{PDFFetchStream:F}=__w_pdfjs_require__(29);(0,H.setPDFNetworkStreamFactory)(M=>(0,c.isValidFetchUrl)(M.url)?new F(M):new T(M))}})(),__webpack_exports__})())})(pdf);let libPath="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.14.305",pdfjsLibPath=libPath,pdfjsWorkerSrc=pdfjsLibPath+"/build/pdf.worker.min.js",icon=new URL(""+new URL("pdf-05c611d5.png",import.meta.url).href,self.location).href,addFile=new URL(""+new URL("addFile-24d26b63.svg",import.meta.url).href,self.location).href;pdf.exports.GlobalWorkerOptions.workerSrc=pdfjsWorkerSrc;const pdfReader=defineComponent({setup(){let J=ref(),g=H=>{let c=H.target.files[0],Q=new FileReader;Q.onload=function(){pdf.exports.getDocument({url:Q.result,cMapPacked:!0,cMapUrl:pdfjsLibPath+"/cmaps/"}).promise.then(q=>{J.value.innerHTML="",J.value.style.backgroundColor="#d0d0d0";for(let G=0;G<q.numPages;G++){let U=document.createElement("canvas");J.value.appendChild(U),q.getPage(G+1).then(async function(R){let _=R.getViewport({scale:1}),T=U.getContext("2d"),F=2;U.width=Math.floor(_.width*F),U.height=Math.floor(_.height*F),U.style.width="70%",U.style.marginBottom="30px",R.render({canvasContext:T,transform:[F,0,0,F,0,0],viewport:_})})}})},Q.readAsDataURL(c)};return()=>createVNode(AppFrame,{icon,title:"PDF\u9605\u8BFB\u5668"},{default:()=>[createVNode("div",{style:{height:"calc(100% - 30px)"}},[createVNode("div",{ref:J,style:{overflow:"auto",textAlign:"center",height:"100%",paddingTop:"30px"}},[createVNode("div",{style:{paddingTop:"100px",fontSize:"30px",fontStyle:"italic",fontWeight:"200",color:"#8aa0aa"}},[createTextVNode("\u4F60\u53EF\u4EE5\u70B9\u51FB\u201C\u53F3\u4E0B\u65B9\u201D\u6309\u94AE\u9009\u62E9PDF\u6587\u4EF6")])]),createVNode("input",{style:{display:"none"},type:"file",id:"input",onChange:H=>g.call(this,H),accept:"application/pdf"},null),createVNode("label",{style:{position:"absolute",right:"10px",bottom:"10px",lineHeight:"50px",display:"inline-block",border:"1px solid gray",backgroundImage:"url('"+addFile+"')",backgroundRepeat:"no-repeat",backgroundPosition:"5px center",backgroundSize:"auto 70%",paddingLeft:"40px",paddingRight:"10px",borderRadius:"5px",cursor:"pointer",backgroundColor:"#f6f2f4"},htmlFor:"input"},[createTextVNode(" \u6253\u5F00PDF\u6587\u4EF6 ")])])]})}});export{pdfReader as default};
